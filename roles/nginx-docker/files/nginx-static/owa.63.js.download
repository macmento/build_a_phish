self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.63.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[63],{11402:function(e,t,n){(t=e.exports=n(94)(!1)).push([e.i,'.CN8b_H-vp26NxjABwwT7a{white-space:nowrap;color:"[theme:redDark, default:#a80000]";font-weight:400}html[dir=ltr] .rK3aivbMQMOCkH0WcMu-q{margin-right:10px}html[dir=rtl] .rK3aivbMQMOCkH0WcMu-q{margin-left:10px}',""]),t.locals={couponRow:"CN8b_H-vp26NxjABwwT7a",icon:"rK3aivbMQMOCkH0WcMu-q"}},1804:function(e,t,n){"use strict";var r=n(0);function o(e,t){var n,r;switch(t){case 0:n=e.LastDeliveryOrRenewTime,r=e.LastDeliveryTime;break;case 1:n=e.ReceivedOrRenewTime,r=e.DateTimeReceived}return{lastDeliveryOrRenewTimeStamp:n,lastDeliveryTimeStamp:r}}var i=n(2008);function a(e,t){var n=o(e,t.tableQuery.listViewType);return!!(t.lastEmptiedTime&&t.lastEmptiedTime>new Date(n.lastDeliveryTimeStamp))||i.a.getTombstonedReasons(e.InstanceKey,t.serverFolderId).indexOf(3)>-1}var s=n(33),u=n(3175),c=n(6670),d=n(2939),l=n(1717),f=n(7555),v=n(5900),b=n(17);function m(e){var t=e.tableQuery.listViewType,n=Object(l.b)(e);Object(b.a)().UserOptions.ShowInlinePreviews&&u.b.importAndExecute(n,t),Object(s.i)("tri-coupon-peek")&&c.d.import().then((function(e){e(n.mailboxSmtpAddress,t)}));var r=e.id!==Object(d.a)();(Object(s.i)("tri-meetingMessageRSVP")||Object(s.i)("tri-meetingMessageRSVPExp"))&&f.b.importAndExecute(n,t,r),Object(s.i)("tri-txpButtonInLV")&&v.d.importAndExecute(n,t,r)}var w=n(1625),p=n(5452),I=n(2530),y=n(2470),O=n(151),g=Object(O.action)("appendRowResponse")((function(e,t,n,o,i,u,c){var d,l;void 0===o&&(o=""),void 0===c&&(c=!1);var f=t||[],v=0;try{for(var b=Object(r.__values)(f),O=b.next();!O.done;O=b.next()){var g=O.value;if(!a(g,e)){var R=!0,h=g.InstanceKey;if(I.a.containsRowKey(e,Object(w.D)(g,e.tableQuery.listViewType))){var j=Object(y.a)(h,e.id,w.b.getLastDeliveryOrRenewTimeStamp(h,e))?e.rowKeys.indexOf(h):e.rowKeys.length-1;I.a.updateRow(j,g,e,o,c)}else R=I.a.appendRow(g,e,o,c);if(Object(s.i)("tri-handleTableAddFailures")&&!R&&v++,i){var T={referenceKey:g.ReferenceKey,index:e.rowKeys.length-1,traceId:i,logicalId:u};Object(p.a)(h,e,T)}}}}catch(e){d={error:e}}finally{try{O&&!O.done&&(l=b.return)&&l.call(b)}finally{if(d)throw d.error}}e.totalRowsInView=n-v,m(e)})),R=n(1695),h=n(954);function j(e){if(Object(R.e)(e))return!1;if(0==e.type){var t=e.sortBy,n=w.c.getSortBySupportingPin();return t.sortColumn==n.sortColumn&&t.sortDirection==n.sortDirection&&function(e){if(!e)throw new Error("Current folder id should not be null");return Object(h.a)("sentitems")!=e&&Object(h.a)("deleteditems")!=e&&Object(h.a)("drafts")!=e&&Object(h.a)("junkemail")!=e&&Object(h.a)("archive")!=e}(e.folderId)}return 1==e.type}var T=n(23),S=n(2394),x=n(1632);function C(e,t){var n=!1;switch(t.tableQuery.listViewType){case 0:n=K(t.tableQuery,Object(S.a)(e.InstanceKey,t.id),e);break;case 1:n=M(t.tableQuery,e,x.u.items.get(e.ItemId.Id))}return n}var K=Object(O.select)({listViewStore:function(){return w.X}})((function(e,t,n,r){if(0!==e.type&&2!==e.type)return T.d("isConversationSortKeyEqual should not be called on non MailFolderTableQuery type"),!1;var o=e.sortBy;if(!o)throw new Error("SortBy should not be null");var i=t.instanceKey===n.InstanceKey,a=function(e,t,n){var r=new Date(t.lastDeliveryTimeStamp).getTime()===new Date(n.LastDeliveryTime).getTime();if(j(e)){return new Date(t.lastDeliveryOrRenewTimeStamp).getTime()===new Date(n.LastDeliveryOrRenewTime).getTime()&&r}return r}(e,t,n);if(!i||!a)return!1;var s=r.listViewStore.conversationItems.get(t.id);switch(o.sortColumn){case 1:case 3:return!0;case 5:return s.subject===n.ConversationTopic;case 8:return t.importance===n.Importance;case 7:return s.size===n.Size;default:return T.g.warn("isSortKeyEqual: sortColumn not supported "+o.sortColumn),!1}}));function M(e,t,n){if(0!=e.type&&2!==e.type)return T.d("isItemSortKeyEqual should not be called on non MailFolderTableQuery type"),!1;var r=e.sortBy;if(!r)throw new Error("SortBy should not be null");var o=t.InstanceKey===n.InstanceKey,i=function(e,t,n){var r=new Date(t.DateTimeReceived).getTime()===new Date(n.DateTimeReceived).getTime();if(j(e)){return new Date(t.ReceivedOrRenewTime).getTime()===new Date(n.ReceivedOrRenewTime).getTime()&&r}return r}(e,t,n);if(!o||!i)return!1;switch(r.sortColumn){case 1:return!0;case 5:return t.Importance===n.Importance;case 8:return t.Subject===n.Subject;case 3:var a=D(t),s=D(n);return!a||!s||(a.From&&a.From.Mailbox.EmailAddress)===(s.From&&s.From.Mailbox.EmailAddress);case 7:return t.Size===n.Size;default:return T.g.warn("isSortKeyEqual: sortColumn not supported "+r.sortColumn),!1}}function D(e){return-1!==e.ItemClass.indexOf("IPM.Schedule.Meeting")||-1!==e.ItemClass.indexOf("IPM.Note")?e:null}var V=n(114),E=n(2),F=Object(E.action)("ON_MERGE_ROW_COMPLETED",(function(e){return{tableView:e}})),P=Object(O.action)("mergeRowResponseFromTop")((function(e,t,n,o,i,u){var c,d;if(e){if(i){for(var l=!0,f=0;f<Math.min(t.rowKeys.length,2,e.length);f++)if(t.rowKeys[f]!=e[f].InstanceKey||!C(e[f],t)){l=!1;break}Object(V.s)("TnS_MergeFindResponse",[l])}var v=0,b=0,p=t.tableQuery.listViewType;try{for(var O=Object(r.__values)(e),g=O.next();!g.done;g=O.next()){var R=g.value;if(!a(R,t)){var h=Object(w.D)(R,p),j=!0;I.a.containsRowKey(t,h)?Object(s.i)("tri-smartMergeFindResponse")&&w.b.getLastModifiedTimeStamp(h,t)===R.LastModifiedTime?I.a.updateRowPosition(v,h,t,u):I.a.updateRow(v,R,t,u):j=I.a.addRow(v,R,t,u),!Object(s.i)("tri-handleTableAddFailures")||j?v++:b++}}}catch(e){c={error:e}}finally{try{g&&!g.done&&(d=O.return)&&d.call(O)}finally{if(c)throw c.error}}if(o){var S=v;for(f=t.rowKeys.length-1;f>=S;f--){h=t.rowKeys[f];Object(y.a)(h,t.id,w.b.getLastDeliveryOrRenewTimeStamp(h,t))||I.a.removeRow(h,t,u+"_RemoveAfterMerge")}}F(t),t.totalRowsInView=n-b,m(t)}else T.d("We need to have a valid list of rows")}));function A(e,t,n){if(t&&0!=t.length){var r=t[0].InstanceKey,o=Object(S.a)(r,e.id);o&&K(e.tableQuery,o,t[0])&&g(e,t,n,"AppendOnLoadMore")}}function L(e,t,n){if(t&&0!=t.length){var r=t[0].ItemId.Id;x.u.items.has(r)&&(1==e.tableQuery.type||M(e.tableQuery,x.u.items.get(r),t[0]))&&g(e,t,n,"AppendOnLoadMore")}}function Q(e,t){var n;for(n=t;n<e.rowKeys.length&&w.b.getIsPinned(e.rowKeys[n],e);n++);return n}var k=n(6773),_=new Map;function U(e,t){var n,r=Object(w.P)(t);n=r?e.LastDeliveryOrRenewTime:e.ReceivedOrRenewTime;var o=w.b.getLastDeliveryOrRenewTimeStamp(e.InstanceKey,t),i=new Date(n).toString()===new Date(o).toString();return i||(r?e.LastDeliveryOrRenewTime=o:e.ReceivedOrRenewTime=o),i}function q(e,t,n){return(0,_[n])(e,t)}function B(e,t){return!a(e,t)&&(function(e,t){var n,o,a=e.InstanceKey,s=t.serverFolderId,u=i.a.getTombstonedReasons(a,s).slice(0);if(u)try{for(var c=Object(r.__values)(u),d=c.next();!d.done;d=c.next()){var l=d.value;if(3==l)throw new Error("syncTombstonedProperties should not be called for Remove reason");q(e,t,l)&&i.a.remove(a,s,l)}}catch(e){n={error:e}}finally{try{d&&!d.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}}(e,t),!0)}function N(e,t){var n=e.InstanceKey,r=t.serverFolderId,o=i.a.getTombstonedReasons(n,r);return o.indexOf(3)>-1?(i.a.remove(n,r,3),!0):!("Unread"===Object(w.O)(t)&&Object(w.f)(t)&&o.indexOf(2)>-1)||(i.a.remove(n,r,2),!1)}_[1]=U,_[0]=function(e,t){var n=w.b.getCategories(e.InstanceKey,t),r=n?n.slice().sort():[],o=e.Categories?e.Categories.slice().sort():[],i=k(r,o);i||(e.Categories=n);return i},_[2]=function(e,t){var n,r,o,i=w.b.getUnreadCount(e.InstanceKey,t);Object(w.P)(t)?(r=(n=e).UnreadCount,(o=i==r)||(n.UnreadCount=i),Object(w.e)(t)&&(!function(e,t){var n=e,r=n.LastDeliveryTime,o=w.b.getLastDeliveryTimeStamp(e.InstanceKey,t);new Date(r).toString()!==new Date(o).toString()&&(n.LastDeliveryTime=o)}(e,t),U(e,t))):Object(w.V)(e)?(r=(n=e).IsRead?0:1,(o=i==r)||(n.IsRead=0==i)):o=!0;return o},_[4]=function(){},n.d(t,"c",(function(){return g})),n.d(t,"h",(function(){return P})),n.d(t,"a",(function(){return A})),n.d(t,"b",(function(){return L})),n.d(t,"l",(function(){return j})),n.d(t,"f",(function(){return Q})),n.d(t,"d",(function(){return m})),n.d(t,"k",(function(){return B})),n.d(t,"j",(function(){return N})),n.d(t,"g",(function(){return C})),n.d(t,"e",(function(){return o})),n.d(t,"i",(function(){return F}))},2008:function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"add",(function(){return c})),n.d(r,"remove",(function(){return d})),n.d(r,"removeAll",(function(){return l})),n.d(r,"getCount",(function(){return f})),n.d(r,"getTombstonedReasons",(function(){return v})),n.d(r,"clearMapForFolder",(function(){return b})),n.d(r,"removeRowsFromTombstone",(function(){return m}));var o=n(0),i=n(2),a=Object(i.createStore)("tombstone",{folderTombstoneMap:{}}),s=(a(),n(114)),u=n(151),c=Object(u.action)("tombstoneOperations.add")((function(e,t,n){if(1!=t.tableQuery.type&&"spotlight"!==t.tableQuery.scenarioType){var r=t.serverFolderId,o=a().folderTombstoneMap;r in o||(o[r]={});var i=o[r];e.forEach((function(e){var t=i[e];t?3!=n?t.indexOf(3)>-1||-1==t.indexOf(n)&&t.push(n):i[e]=[3]:i[e]=[n]}))}})),d=Object(u.action)("tombstoneOperations.remove")((function(e,t,n){var r=a().folderTombstoneMap;if(t in r){var o=r[t],i=o[e],s=i?i.indexOf(n):-1;if(-1==s)throw new Error("tombstone.remove given reason does not exist when trying to remove entry from it");i.splice(s,1),0==i.length&&delete o[e],0==Object.keys(o).length&&delete r[t]}})),l=Object(u.action)("tombstoneOperations.removeAll")((function(){a().folderTombstoneMap={},Object(s.s)("TnS_RemoveAllFromTombstone")})),f=function(e,t){var n=a().folderTombstoneMap;if(!(e in n))return 0;var r=0,o=n[e];return Object.values(o).forEach((function(e){e==t&&r++})),r},v=function(e,t){var n=a().folderTombstoneMap;if(t in n){var r=n[t][e];if(r)return r}return[]},b=Object(u.action)("tombstoneOperations.clearMapForFolder")((function(e){var t=a().folderTombstoneMap;t[e]&&(Object(s.s)("TnS_ClearFolderMapInTombstone",[Object.keys(t[e]).length]),delete t[e])})),m=Object(u.action)("tombstoneOperations.removeRowsFromTombstone")((function(e,t){var n,r,i=a().folderTombstoneMap;if(t in i){var s=i[t];try{for(var u=Object(o.__values)(e),c=u.next();!c.done;c=u.next()){var d=c.value;d in s&&delete s[d]}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}0==Object.keys(s).length&&delete i[t]}}));t.a=r},2530:function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"addRow",(function(){return G})),n.d(r,"appendRow",(function(){return W})),n.d(r,"removeRow",(function(){return J})),n.d(r,"updateRowPosition",(function(){return X})),n.d(r,"updateRow",(function(){return $})),n.d(r,"updateRowData",(function(){return Y})),n.d(r,"clear",(function(){return Z})),n.d(r,"containsRowKey",(function(){return ee}));var o=n(0),i=n(3175),a=n(6670),s=n(1717),u=n(65),c=n(33),d=n(1695),l=n(727),f=n(422);var v=n(1625),b=n(5900);function m(e,t,n,r){return!!(e>0&&Object(c.i)("tri-txpButtonInLV")&&!Object(d.e)(r.tableQuery)&&function(e){return e>0&&(Object(f.a)(e,l.b)==l.b||Object(f.a)(e,l.a)==l.a)}(e))&&(Object(v.J)().txpActionButtonData.get(n)||b.b.importAndExecute(r,t,n),!0)}function w(e,t){return{Id:e.ConversationId.Id,mailboxInfo:Object(s.b)(t)}}function p(e,t){var n=function(e){var t,n,r=[];try{for(var i=Object(o.__values)(e),a=i.next();!a.done;a=i.next()){var s=a.value,u=Object(o.__assign)({},s);r.push(u.Id)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}(e.GlobalItemIds),r=e.ItemIds[0].Id;return{id:e.ConversationId.Id,subject:e.ConversationTopic,globalItemIds:n,shouldShowAttachmentPreviews:Object(u.h)().UserOptions.ShowInlinePreviews&&Object(i.e)(e,t.tableQuery),validCouponIndexes:Object(a.b)(e,t.tableQuery),globalUnreadCount:e.GlobalUnreadCount,size:e.Size,clientId:w(e,t),globalMessageCount:e.GlobalMessageCount,shouldShowTxpButton:m(e.EntityNamesMap,e.InstanceKey,r,t),hasExternalEmails:e.HasExternalEmails,hasSharepointLink:e.HasProcessedSharepointLink}}var I=n(9366),y=n(1994),O=n(782),g=n(1664),R=n(2008),h=[Object(O.a)({FieldURI:"Start"}),Object(O.a)({FieldURI:"End"}),Object(O.a)({FieldURI:"CalendarItemType"})],j=[Object(O.a)({FieldURI:"ConflictingMeetings"}),Object(O.a)({FieldURI:"IsResponseRequested"}),Object(O.a)({FieldURI:"Organizer"})];function T(e,t,n,r){if(R.a.getTombstonedReasons(e,r.serverFolderId).indexOf(4)>-1)return!1;var o=r.tableQuery.folderId?Object(g.a)(r.tableQuery.folderId):null;return!(!Object(c.i)("tri-meetingMessageRSVP")&&!Object(c.i)("tri-meetingMessageRSVPExp")||!t||Object(d.e)(r.tableQuery)||!n||!(o||"deleteditems"!==o&&"sentitems"!==o)||!Object(y.q)(n)&&!Object(y.l)(n))}function S(e,t,n,r){T(e,t,n,r)&&function(e,t){var n=Object(v.J)().meetingMessageItems.get(e);if(!n)return!0;var r=h;Object(y.q)(t)&&(r=r.concat(j));return r.some((function(e){return void 0===n[e.FieldURI]}))}(t,n)&&I.a(r,e,t)}function x(e,t){if(!e.ItemClasses||0===e.ItemClasses.length)return!1;var n=e.ItemIds[0].Id,r=e.ItemClasses[0];return!!T(e.InstanceKey,n,r,t)&&(S(e.InstanceKey,n,r,t),!0)}function C(e){return e.GlobalMentionedMe||e.GlobalAtAllMention}function K(e){return Object(c.i)("tri-flagStatusV2")&&e.FlagStatusV2?e.FlagStatusV2:e.FlagStatus}var M=n(1757),D=n(3676),V=n(151),E=n(23),F=Object(V.select)({conversationItems:function(){return M.a.conversationItems},tableViewConversationRelations:function(){return M.a.tableViewConversationRelations}})(Object(V.action)("addOrUpdateConversationData")((function(e,t,n,r){void 0===n&&(n=!1);var o=r.conversationItems,i=r.tableViewConversationRelations;e.ConversationId||E.d("addOrUpdateConversationData: ConversationId is undefined");var a=e.ConversationId.Id,s=Object(D.a)(e.InstanceKey,t.id);if(P(n,a,o)){var u=p(e,t);o.set(a,u)}var c=function(e,t){return{categories:e.Categories,draftItemIds:e.DraftItemIds?e.DraftItemIds.map((function(e){return e.Id})):[],effectiveMentioned:C(e),executeSearchSortOrder:e.SortOrderSource,flagStatus:K(e),hasAttachments:e.HasAttachments,hasIrm:e.HasIrm,iconIndex:e.IconIndex,id:e.ConversationId.Id,importance:e.Importance,instanceKey:e.InstanceKey,itemClasses:e.ItemClasses,itemIds:e.ItemIds.map((function(e){return e.Id})),lastDeliveryOrRenewTimeStamp:e.LastDeliveryOrRenewTime,lastDeliveryTimeStamp:e.LastDeliveryTime,lastModifiedTimeStamp:e.LastModifiedTime,lastSender:e.LastSender?e.LastSender:e.From,parentFolderId:e.ParentFolderId?e.ParentFolderId.Id:null,previewText:e.Preview,returnTime:e.ReturnTime?e.ReturnTime:null,uniqueRecipients:e.UniqueRecipients,uniqueSenders:e.UniqueSenders,unreadCount:e.UnreadCount,globalLikeCount:e.GlobalLikeCount?e.GlobalLikeCount:null,shouldShowRSVP:x(e,t)}}(e,t);i.set(s,c)}))),P=function(e,t,n){return!n.get(t)||!e},A=n(5453),L=n(1632);function Q(e,t){var n=e.ItemId.Id,r=e.ItemClass;return!!T(e.InstanceKey,n,r,t)&&(S(e.InstanceKey,n,r,t),!0)}var k=Object(V.select)({items:function(){return L.u.items},tableViewItemRelations:function(){return v.X.tableViewItemRelations}})(Object(V.action)("addOrUpdateItemData")((function(e,t,n){var r=e.ItemId.Id,c=Object(o.__assign)(Object(o.__assign)({},e),{MailboxInfo:Object(s.b)(t),validCouponIndexes:Object(a.c)(e,t.tableQuery),shouldShowAttachmentPreviews:Object(u.h)().UserOptions.ShowInlinePreviews&&Object(i.f)(e,t.tableQuery),shouldShowRSVP:Q(e,t),shouldShowTxpButton:m(e.EntityNamesMap,e.InstanceKey,e.ItemId.Id,t)});n.items.has(r)?function(e,t,n){var r,o="spotlight"==(null===(r=null==n?void 0:n.tableQuery)||void 0===r?void 0:r.scenarioType);if(1===n.tableQuery.type||o||(e.ItemId=t.ItemId,e.ReceivedOrRenewTime=t.ReceivedOrRenewTime,e.validCouponIndexes=t.validCouponIndexes,e.shouldShowRSVP=t.shouldShowRSVP,e.shouldShowTxpButton=t.shouldShowTxpButton),e.Subject=t.Subject,e.Importance=t.Importance,e.Sensitivity=t.Sensitivity,e.HasAttachments=t.HasAttachments,e.ItemClass=t.ItemClass,e.Flag=t.Flag,e.Categories=t.Categories,e.SystemCategories=t.SystemCategories,e.PredictedActionReasons=t.PredictedActionReasons,e.ParentFolderId=t.ParentFolderId,e.ConversationId=t.ConversationId,e.DateTimeReceived=t.DateTimeReceived,e.IsDraft=t.IsDraft,e.Size=t.Size,e.IsClutter=t.IsClutter,e.Preview=t.Preview,e.DisplayTo=t.DisplayTo,e.IconIndex=t.IconIndex,t.ReturnTime&&(e.ReturnTime=t.ReturnTime),-1!==e.ItemClass.indexOf("IPM.Schedule.Meeting")||-1!==e.ItemClass.indexOf("IPM.Note")){var i=e,a=t;i.IsRead=a.IsRead,1!==n.tableQuery.type&&(i.IsReadReceiptRequested=a.IsReadReceiptRequested,i.IsDeliveryReceiptRequested=a.IsDeliveryReceiptRequested)}}(n.items.get(r),c,t):(n.items.set(r,c),c.ConversationId||E.d("addOrUpdateItemData: item.ConversationId is null."));var d=Object(D.a)(e.InstanceKey,t.id),l=Object(A.a)(e,t);n.tableViewItemRelations.set(d,l)}))),_=Object(V.action)("addOrUpdateRowData")((function(e,t,n){switch(void 0===n&&(n=!1),t.tableQuery.listViewType){case 0:F(e,t,n);break;case 1:k(e,t)}})),U=n(1735),q=n(7555),B=Object(V.select)({tableViewConversationRelations:function(){return M.a.tableViewConversationRelations},tableViews:function(){return M.a.tableViews},conversationItems:function(){return M.a.conversationItems},conversationCache:function(){return U.a}})(Object(V.action)("removeConversationData")((function(e,t,n){var r,s,u=Object(D.a)(e,t.id),d=n.tableViewConversationRelations,l=d.get(u).id,f=d.get(u).itemIds;if(!d.has(u))throw new Error("Conversation not found in store");d.delete(u);var v=!1;try{for(var m=Object(o.__values)(n.tableViews.values()),w=m.next();!w.done;w=m.next()){var p=w.value;if(p.id!=t.id&&p.rowIdToRowKeyMap.get(l)){v=!0;break}}}catch(e){r={error:e}}finally{try{w&&!w.done&&(s=m.return)&&s.call(m)}finally{if(r)throw r.error}}v||(n.conversationItems.delete(l),i.d.importAndExecute(l),Object(c.i)("tri-coupon-peek")&&a.e.import().then((function(e){e(l)})),(Object(c.i)("tri-meetingMessageRSVP")||Object(c.i)("tri-meetingMessageRSVPExp"))&&q.a.importAndExecute(f),Object(c.i)("tri-txpButtonInLV")&&b.c.importAndExecute(f),n.conversationCache.remove(l))}))),N=n(2166);var H=n(4299),z=Object(V.action)("removeRowData")((function(e,t){switch(t.selectedRowKeys.has(e)&&Object(H.a)(e,t.id,!1),t.tableQuery.listViewType){case 0:B(e,t);break;case 1:!function(e,t){var n=Object(v.C)([e],t.id)[0],r=Object(v.M)(e,t.id);if(!v.X.tableViewItemRelations.has(r))throw new Error("Item not found in list view store");v.X.tableViewItemRelations.delete(r),(Object(c.i)("tri-meetingMessageRSVP")||Object(c.i)("tri-meetingMessageRSVPExp"))&&q.a.importAndExecute([n]),Object(c.i)("tri-txpButtonInLV")&&b.c.importAndExecute([n]),Object(N.a)(n,0)}(e,t)}}));function G(e,t,n,r,o){return void 0===r&&(r=""),void 0===o&&(o=!1),_(t,n,o),te(n,e,Object(v.D)(t,n.tableQuery.listViewType),r)}function W(e,t,n,r){return void 0===n&&(n=""),void 0===r&&(r=!1),G(t.rowKeys.length,e,t,n,r)}var J=Object(V.action)("tableOperations.removeRow")((function(e,t,n){void 0===n&&(n=""),re(t,e,n),z(e,t)})),X=Object(V.action)("tableOperations.updateRowPosition")((function(e,t,n,r){void 0===r&&(r="");var o=n.rowKeys.indexOf(t);if(o<0){var i=new Error("updateRowPosition: Row not found in table, source: "+r);return i.diagnosticInfo="tableLength: "+n.rowKeys.length+" rowKey: "+t,void E.d(i)}o!=e&&(re(n,t,r),te(n,e,t,r))})),$=Object(V.action)("tableOperations.updateRow")((function(e,t,n,r,o){void 0===r&&(r=""),void 0===o&&(o=!1),X(e,Object(v.D)(t,n.tableQuery.listViewType),n,r),_(t,n,o)})),Y=Object(V.action)("tableOperations.updateRowData")((function(e,t){_(e,t)})),Z=Object(V.action)("tableOperations.clear")((function(e,t,n,r){void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r="");for(var o=e.rowKeys.length-1;o>=0;o--){var i=e.rowKeys[o];if(-1==n.indexOf(i))if(t){var a=v.b.getLastDeliveryTimeStamp(i,e);new Date(a)<t&&J(i,e,r)}else J(i,e,r)}}));function ee(e,t){return e.rowKeys.indexOf(t)>=0}function te(e,t,n,r){if(void 0===r&&(r=""),t<0||t>e.rowKeys.length)return se("addToTableRowKeys: Invalid add index",r,oe(e,t)),!1;if(ee(e,n))return se("addToTableRowKeys: RowKey already exists",r,oe(e,t)),!1;try{var o=v.b.getRowIdString(n,e);return ne(e,o,n,t),!0}catch(n){return se("addToTableRowKeys: exception when adding row at valid index",r,oe(e,t)+" exp: "+(null==n?void 0:n.message)),!1}}var ne=Object(V.action)("tableOperations.addRowKeyToTableRowKeysAndMap")((function(e,t,n,r){var o=e.rowIdToRowKeyMap.get(t);o||(o=[]),-1==o.indexOf(n)&&o.push(n),e.rowIdToRowKeyMap.set(t,o),e.rowKeys.splice(r,0,n)}));function re(e,t,n){void 0===n&&(n="");var r=e.rowKeys.indexOf(t);if(r<0)se("removeFromTableRowKeys: RowKey not found in tableView.rowKeys",n,ie(e));else{var o=v.b.getRowIdString(t,e),i=e.rowIdToRowKeyMap.get(o);if(i){var a=i.indexOf(t);-1!=a?(1==i.length?e.rowIdToRowKeyMap.delete(o):i.splice(a,1),e.rowKeys.splice(r,1)):se("removeFromTableRowKeys: RowKey should be present in rowIdToRowKey map",n,ie(e,o))}else se("removeFromTableRowKeys: invalid rowKeysForRowId",n,ie(e,o))}}function oe(e,t){return"addAtIndex: "+t+ae(e)}function ie(e,t){return(t?"rowId: "+t:"")+ae(e)}function ae(e){return" tableLength: "+e.rowKeys.length+" tableType: "+e.tableQuery.type+" lvType: "+e.tableQuery.listViewType}function se(e,t,n){var r=new Error(e+": source: "+t);r.diagnosticInfo=n,E.d(r)}t.a=r},4299:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("SET_SELECTION_ON_ROW",(function(e,t,n){return{rowKey:e,tableViewId:t,shouldSelect:n}}))},5452:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2394),o=n(4609);function i(e,t,n){switch(t.tableQuery.listViewType){case 0:Object(r.a)(e,t.id).instrumentationContext=n;break;case 1:Object(o.a)(e,t.id).instrumentationContext=n}}},5453:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(1717);function o(e,t){return{Id:e.ItemId.Id,mailboxInfo:Object(r.b)(t)}}function i(e,t){return{executeSearchSortOrder:e.SortOrderSource,clientId:o(e,t),instanceKey:e.InstanceKey}}},5900:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return u}));var r=n(36),o=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(61),n.e(102),n.e(253),n.e(788)]).then(n.bind(null,16747))})),i=new r.a(o,(function(e){return e.tryGetTxpAdditionalData})),a=new r.a(o,(function(e){return e.removeTxpFromStoreAction})),s=new r.a(o,(function(e){return e.addToTxpItemIdMap})),u=Object(r.d)(o,(function(e){return e.TxpListViewButton}))},6670:function(e,t,n){"use strict";var r=n(36),o=n(9362),i=n(9365);function a(e,t){return new Date(e)>new Date(t)}var s=n(33),u=n(1717),c=n(1632),d=n(1664),l=n(1625);function f(e,t){var n=e.ConversationId.Id;if(Object(l.J)().couponPeekPreviews.get(n)){var r=Object(l.Y)(n);if(r)return r.validCouponIndexes}return b(e.ItemIds[0].Id,e.CouponRanks,e.CouponExpiryDates,t)}function v(e,t){if(!Object(l.V)(e))return null;var n=e,r=e.ItemId.Id;if(Object(l.J)().couponPeekPreviews.get(r)){var o=Object(c.g)().items.get(r);if(o)return o.validCouponIndexes}return b(e.ItemId.Id,n.CouponRanks,n.CouponExpiryDates,t)}function b(e,t,n,r){if(1==r.type)return null;if("junkemail"==Object(d.a)(r.folderId))return null;if(!t||!n||t.length!=n.length)return null;for(var o=[],c=0;c<n.length;c++){a(n[c],Date.now())&&o.push({index:c,rank:t[c]})}return o.sort((function(e,t){return t.rank-e.rank})),o.length>0&&Object(s.i)("tri-coupon-peek")&&i.a(Object(u.d)(r).mailboxSmtpAddress,e),o.map((function(e){return e.index}))}n.d(t,"d",(function(){return w})),n.d(t,"e",(function(){return p})),n.d(t,"a",(function(){return I})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return v}));var m=new r.c((function(){return n.e(374).then(n.bind(null,17338))})),w=new r.b(m,(function(e){return e.fetchCouponData})),p=new r.b(m,(function(e){return e.removeCouponFromStore})),I=Object(r.d)(m,(function(e){return e.CouponPreviewWell}),(function(e){return Object(o.a)(e)}))},6773:function(e,t){e.exports=function(e,t){var n=e.length;if(n!==t.length)return!1;for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}},7555:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(36),o=new r.c((function(){return n.e(712).then(n.bind(null,16759))})),i=new r.a(o,(function(e){return e.tryPrefetchMeetingMessage})),a=new r.a(o,(function(e){return e.removeMeetingMessagesFromStore}))},9362:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(9363),o=n(344),i=n(1),a=n(9364);function s(e){var t=Math.min(r.a,e.validCouponIndexes.length);return Array.apply(null,Array(t)).map((function(e){return i.createElement("div",{key:e},i.createElement(o.a,{iconName:"",className:a.icon}))}))}},9363:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=1},9364:function(e,t,n){var r=n(11402),o=n(95);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},9365:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return u}));var r=n(23),o={},i=function(e,t){a(e,t)?r.g.warn("couponPeekOperations: duplicate itemId should not be fetched again"):o[e]?o[e].push(t):o[e]=[t]},a=function(e,t){var n=o[e];return n&&n.indexOf(t)>0},s=function(e){delete o[e]},u=function(e){return o[e]}},9366:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return u}));var r=n(1717),o={},i=function(e,t,n){var i=Object(r.d)(e.tableQuery).mailboxSmtpAddress;a(i,n)||(o[i]?o[i].push({rowKey:t,itemId:n,tableViewId:e.id}):o[i]=[{rowKey:t,itemId:n,tableViewId:e.id}])},a=function(e,t){var n=o[e];return n&&n.some((function(e){return e.itemId===t}))},s=function(e){delete o[e]},u=function(e){return o[e]}}}]);
//# sourceMappingURL=owa.63.js.map
self.scriptsLoaded['owa.63.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.63.js'] = (new Date()).getTime();