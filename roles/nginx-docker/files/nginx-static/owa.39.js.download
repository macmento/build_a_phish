self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.39.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[39],{10179:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1667);t.default=function(e,t){if((null==t?void 0:t.length)>0){var n=e.getSelectionRange(),r=n&&o.Position.getStart(n),a=n&&o.Position.getEnd(n);t.forEach((function(e){return e.commit()})),e.select(r,a)}}},10180:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5545);t.default=function(e,t){if("string"==typeof t){var n=t.trim();o.default(e,(function(e,t){e.style.backgroundColor=t?"":n}))}else{var r=e.isDarkMode(),a=r?t.darkModeColor:t.lightModeColor;o.default(e,(function(e,n){e.style.backgroundColor=n?"":a,r&&(e.dataset.ogsb=t.lightModeColor)}))}}},10181:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5545);t.default=function(e,t){t=t.trim(),o.default(e,(function(e,n){e.style.fontFamily=n?"":t}))}},10182:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5545),r=n(1667);t.default=function(e,t){t=t.trim(),o.default(e,(function(e,n){e.style.fontSize=n?"":t,"normal"!=r.getComputedStyle(e,"line-height")&&(e.style.lineHeight="normal")}))}},10183:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5545);t.default=function(e,t){if("string"==typeof t){var n=t.trim();o.default(e,(function(e,t){e.style.color=t?"":n}))}else{var r=e.isDarkMode(),a=r?t.darkModeColor:t.lightModeColor;o.default(e,(function(e,n){e.style.color=n?"":a,r&&(e.dataset.ogsc=t.lightModeColor)}))}}},10184:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4716);t.default=function(e){o.default(e,"bold")}},10185:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4716);t.default=function(e){o.default(e,"italic")}},10186:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4716);t.default=function(e){o.default(e,"underline")}},10187:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(6944),r=n(1667);t.default=function(e,t,n){o.default(e,(function(e){var n=r.getSelectedBlockElementsInRegion(e,!0),o=r.collapseNodesInRegion(e,n);if(o.length>0){if(1==o.length){var a=r.getTagOfNode(o[0]);"BR"==a?o=[r.wrap(o[0])]:"LI"!=a&&"TD"!=a||(o=r.toArray(o[0].childNodes))}for(;o[0]&&r.isNodeInRegion(e,o[0].parentNode)&&o.some((function(e){return"LI"==r.getTagOfNode(e)}));)o=[r.splitBalancedNodeRange(o)];t(o)}}),n)}},12440:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5545),r=n(1667);t.FONT_SIZES=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72];var a=1,l=1e3;function i(e,t,n){e=1==t?Math.floor(e):Math.ceil(e);var o=n[n.length-1];if(e<=n[0])e=Math.max(e+t,a);else if(e>o||e==o&&1==t)e/=10,e=1==t?Math.floor(e):Math.ceil(e),e=Math.min(Math.max(10*(e+t),o),l);else if(1==t){for(var r=0;r<n.length;r++)if(e<n[r]){e=n[r];break}}else for(r=n.length-1;r>=0;r--)if(e>n[r]){e=n[r];break}return e}t.default=function(e,n,a){void 0===a&&(a=t.FONT_SIZES);var l=0==n?1:-1;o.default(e,(function(e){var t=parseFloat(r.getComputedStyle(e,"font-size"));e.style.fontSize=i(t,l,a)+"pt","normal"!=r.getComputedStyle(e,"line-height")&&(e.style.lineHeight="normal")}))},t.getNewFontSize=i},12441:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(6944),r=n(1667),a="B,I,U,STRONG,EM,SUB,SUP,STRIKE,FONT,CENTER,H1,H2,H3,H4,H5,H6,UL,OL,LI,SPAN,P,BLOCKQUOTE,CODE,S,PRE".split(","),l=["href","src"],i=["TD","TH","TR","TABLE","TBODY","THEAD"];function u(e){var t=r.toArray(e.childNodes).map(u).every((function(e){return e})),n=r.isBlockElement(e),o=r.getTagOfNode(e);return o&&(a.indexOf(o)>=0||t&&!r.isVoidHtmlElement(e)&&i.indexOf(o)<0?(n&&!t&&r.wrap(e),r.unwrap(e)):function(e){for(var t=r.safeInstanceOf(e,"HTMLTableCellElement"),n=0,o=r.toArray(e.attributes);n<o.length;n++){var a=o[n];t&&"style"==a.name?d(e):l.indexOf(a.name.toLowerCase())<0&&0!=a.name.indexOf("data-")&&e.removeAttribute(a.name)}}(e)),n}function d(e){var t=r.getStyles(e),n={};return Object.keys(t).forEach((function(e){e.indexOf("border")<0&&(n[e]=t[e],delete t[e])})),r.setStyles(e,t),n}t.default=function(e){o.default(e,(function(t){var n=r.getSelectedBlockElementsInRegion(t),o=r.collapseNodesInRegion(t,n);if(e.contains(t.rootNode)){var a=d(t.rootNode);if(Object.keys(a).length>0){var l=r.wrap(r.toArray(t.rootNode.childNodes));r.setStyles(l,a)}}for(;o.length>0&&r.isNodeInRegion(t,o[0].parentNode);)o=[r.splitBalancedNodeRange(o)];o.forEach(u)}))}},12442:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4716),r=n(10180),a=n(10181),l=n(10182),i=n(10183),u=n(10184),d=n(10185),c=n(10186),s=["font","text-decoration","color","background"];t.default=function(e){e.focus(),e.addUndoSnapshot((function(){o.default(e,"removeFormat"),e.queryElements("[class]",1,(function(e){return e.removeAttribute("class")}));var t=e.getDefaultFormat(),n=0===Object.keys(t).length;e.queryElements("[style]",2,(function(e){s.forEach((function(t){return e.style.removeProperty(t)})),n&&""===e.getAttribute("style")&&e.removeAttribute("style")})),n||(t.fontFamily&&a.default(e,t.fontFamily),t.fontSize&&l.default(e,t.fontSize),t.textColor&&(t.textColors?i.default(e,t.textColors):i.default(e,t.textColor)),t.backgroundColor&&(t.backgroundColors?r.default(e,t.backgroundColors):r.default(e,t.backgroundColor)),t.bold&&u.default(e),t.italic&&d.default(e),t.underline&&c.default(e))}),"Format")}},12443:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1667),r=/^[a-zA-Z]+:/i,a=/^[\w.%+-]+@/i,l=/^ftp\./i,i="istemptitle";function u(e){return e.queryElements("a[href]",1)[0]}function d(e,t){t&&e.textContent!=t&&(e.textContent=t)}t.default=function(e,t,n,c){e.focus();var s=(function(e){var t=new o.HtmlSanitizer,n=(new DOMParser).parseFromString("<a></a>","text/html"),r=n.body.firstChild;return r.href=e||"",t.sanitize(n.body),r.getAttribute("href")}(t)||"").trim();if(s){var f=o.matchLink(s),g=f?f.normalizedUrl:function(e){if(!e)return e;var t="";return e.search(r)<0&&(t=0==e.search(a)?"mailto:":0==e.search(l)?"ftp://":"http://"),t+e}(s),v=f?f.originalUrl:s;e.addUndoSnapshot((function(){var t=e.getSelectionRange(),o=null;return t&&t.collapsed?(o=u(e))?(o.href=g,d(o,c)):((o=e.getDocument().createElement("A")).textContent=c||v,o.href=g,e.insertNode(o)):(e.getDocument().execCommand("createLink",!1,g),d(o=u(e),c)),n&&o&&(o.removeAttribute(i),o.title=n),o}),"CreateLink")}}},12444:function(e,t,n){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(1667);function a(e,t){var n=r.getTagOfNode(e.getElementAtCursor("OL,UL",null,t)),o=r.getTagOfNode(e.getElementAtCursor("H1,H2,H3,H4,H5,H6",null,t));return{isBullet:"UL"==n,isNumbering:"OL"==n,headerLevel:o&&parseInt(o[1])||0,canUnlink:!!e.queryElements("a[href]",1)[0],canAddImageAltText:!!e.queryElements("img",1)[0],isBlockQuote:!!e.queryElements("blockquote",1)[0]}}t.getElementBasedFormatState=a,t.default=function(e,t){return o(o(o(o({},r.getPendableFormatState(e.getDocument())),a(e,t)),e.getStyleBasedFormatState()),e.getUndoState())}},12445:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1667);t.default=function(e,t,n,r,a,l){var i=o.wrap(n,r?"DIV":"SPAN");if(!r&&a&&(i.style.display="inline-block"),o.commitEntity(i,t,a),!e.contains(i)){var u=void 0,d=void 0;if("number"==typeof l)d=l;else if(l){u=e.getSelectionRange();var c=l.normalize().node,s=c&&e.getElementAtCursor(o.getEntitySelector(),c);s&&(l=new o.Position(s,-3)),e.select(l),d=3}else e.focus(),d=3;e.insertNode(i,{updateCursor:!1,insertOnNewLine:r,replaceSelection:!0,position:d}),3==d&&(u?e.select(u):r||e.select(i,-3))}if(r){var f=e.getDocument().createElement("BR");i.parentNode.insertBefore(f,i.nextSibling)}var g=o.getEntityFromElement(i);return e.triggerContentChangedEvent("InsertEntity",g),g}},12446:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1667);function r(e,t){e.addUndoSnapshot((function(){var n=e.getDocument().createElement("img");n.src=t,n.style.maxWidth="100%",e.insertNode(n)}),"Format")}t.default=function(e,t){"string"==typeof t?r(e,t):o.readFile(t,(function(t){t&&!e.isDisposed()&&r(e,t)}))}},12447:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1667);function r(e){return e<=4?"120px":e<=6?"100px":"70px"}t.default=function(e,t,n,a){var l=e.getDocument(),i=l.createDocumentFragment(),u=l.createElement("table");i.appendChild(u),u.cellSpacing="0",u.cellPadding="1";for(var d=0;d<n;d++){var c=l.createElement("tr");u.appendChild(c);for(var s=0;s<t;s++){var f=l.createElement("td");c.appendChild(f),f.appendChild(l.createElement("br")),f.style.width=r(t)}}e.focus(),e.addUndoSnapshot((function(){var t=new o.VTable(u);t.applyFormat(a||{bgColorEven:"#FFF",bgColorOdd:"#FFF",topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB"}),t.writeBack(),e.insertNode(i),e.runAsync((function(e){return e.select(new o.Position(u,0).normalize())}))}),"Format")}},12448:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1667);t.default=function(e,t){var n=e.getElementAtCursor("TD,TH");n&&e.addUndoSnapshot((function(r,a){var l=new o.VTable(n);l.edit(t),l.writeBack(),e.focus();var i=function(e,t,n){var o=t,r=n;switch(e){case 0:r=0;break;case 1:o+=1,r=0;break;case 2:o=0;break;case 3:o=0,r+=1}return{newRow:o,newCol:r}}(t,l.row,l.col);e.select(l.getCell(i.newRow,i.newCol).td,0)}),"Format")}},12449:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1667);t.default=function(e,t,n){(n=n||e.getElementAtCursor("TABLE"))&&e.addUndoSnapshot((function(r,a){var l=new o.VTable(n);l.applyFormat(t),l.writeBack(),e.focus(),e.select(r,a)}),"Format")}},12450:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1667);t.default=function(e){e.focus(),e.addUndoSnapshot((function(t,n){e.queryElements("a[href]",1,o.unwrap),e.select(t,n)}),"Format")}},12451:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o,r){if(!t||!n)return!1;var a;if(a="string"==typeof t?(r=r||e.getContentSearcherOfCursor())&&r.getRangeFromText(t,o):t){var l=e.getSelectionRange();return l.collapsed&&a.endContainer==l.startContainer&&a.endOffset==l.startOffset&&(o=!0),e.insertNode(n,{position:5,updateCursor:o,replaceSelection:!0,insertOnNewLine:!1,range:a}),!0}return!1}},12452:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){t&&e.addUndoSnapshot((function(){t.style.transform="rotate("+n+"deg)"}),"Format")}},12453:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4716);t.default=function(e,t){var n="justifyLeft",r="left";1==t?(n="justifyCenter",r="center"):2==t&&(n="justifyRight",r="right"),e.addUndoSnapshot((function(){o.default(e,n),e.queryElements("[align]",1,(function(e){return e.style.textAlign=r}))}),"Format")}},12454:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(12455);t.default=function(e,t){e.focus(),e.addUndoSnapshot((function(n,r){o.default(e,(function(e){e.setAttribute("dir",0==t?"ltr":"rtl"),e.style.textAlign=0==t?"left":"right"})),e.select(n,r)}),"Format")}},12455:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1667);function r(e){var t=e.getStartNode();return t==e.getEndNode()&&3==t.nodeType&&["TR","TABLE"].indexOf(o.getTagOfNode(t.parentNode))>=0}t.default=function(e,t){for(var n=e.getSelectionTraverser(),o=n&&n.currentBlockElement,a=[];o;)r(o)||a.push(o),o=n.getNextBlockElement();a.forEach((function(e){var n=e.collapseToSingleElement();t(n)}))}},12456:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.focus(),e.addUndoSnapshot((function(){e.queryElements("img",1,(function(e){return e.setAttribute("alt",t)}))}),"Format")}},12457:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(12458),r=n(8099);t.default=function(e,t){if(e.isFeatureEnabled("NewIndentation"))o.default(e,t);else{var n=0==t?"indent":"outdent";e.addUndoSnapshot((function(){var t;return e.focus(),e.getElementAtCursor("OL,UL")?t=r.default(e,n):(e.getDocument().execCommand(n,!1,null),e.queryElements("BLOCKQUOTE",1,(function(e){t=t||e,e.style.marginTop="0px",e.style.marginBottom="0px"}))),t}),"Format")}}},12458:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(6944),r=n(1667),a='<blockquote style="margin-top:0;margin-bottom:0"></blockquote>';function l(e,t){var n=r.collapseNodesInRegion(e,t);r.wrap(n,a)}function i(e,t){t.forEach((function(t){var n=t.collapseToSingleElement(),o=r.findClosestElementAncestor(n,e.rootNode,"blockquote");if(o){for(n==o&&(n=r.wrap(r.toArray(n.childNodes)));r.isNodeInRegion(e,n)&&"BLOCKQUOTE"!=r.getTagOfNode(n);)n=r.splitBalancedNodeRange(n);r.isNodeInRegion(e,n)&&r.unwrap(n)}}))}t.default=function(e,t){var n=0==t?l:i;o.default(e,(function(e,o,a){for(var l=r.getSelectedBlockElementsInRegion(e,!0),i=[[]],u=0;u<l.length;u++){var d=l[u].getStartNode(),c=r.createVListFromRegion(e,!0,d);if(c){for(i.push([]);l[u+1]&&c.contains(l[u+1].getStartNode());)u++;c.setIndentation(o,a,t),c.writeBack()}else i[i.length-1].push(l[u])}i.forEach((function(t){return n(e,t)}))}))}},12459:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5545),r=n(1667);t.default=function(e,t,n){function a(e,n){switch(t){case"lowercase":return e.toLocaleLowerCase(n);case"uppercase":return e.toLocaleUpperCase(n);case"capitalize":for(var o=e.toLocaleLowerCase(n).split(" "),r=0;r<o.length;r++)o[r]=o[r].charAt(0).toLocaleUpperCase(n)+o[r].slice(1);return o.join(" ");case"sentence":var a=new RegExp("^\\s*\\w|[\\.\\!\\?]\\s+\\w","g");return e.toLocaleLowerCase(n).replace(a,(function(e){return e.toLocaleUpperCase(n)}))}}o.default(e,(function(e){for(var t=r.getFirstLeafNode(e);t;t=r.getNextLeafSibling(e,t))if(3==t.nodeType)try{t.textContent=a(t.textContent,n)}catch(e){t.textContent=a(t.textContent,void 0)}}))}},12460:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(8100),r=n(8099);t.default=function(e){e.isFeatureEnabled("NewBullet")?o.default(e,2):(e.focus(),e.addUndoSnapshot((function(){return r.default(e,"insertUnorderedList")}),"Format"))}},12461:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(8100),r=n(8099);t.default=function(e){e.isFeatureEnabled("NewNumbering")?o.default(e,1):(e.focus(),e.addUndoSnapshot((function(){return r.default(e,"insertOrderedList")}),"Format"))}},12462:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(10187),r=n(1667),a="blockquote",l=function(e){e.style.borderLeft="3px solid",e.style.borderColor="#C8C8C8",e.style.paddingLeft="10px",e.style.color="#666666"};t.default=function(e,t){o.default(e,(function(e){var n=r.wrap(e,a);(t||l)(n)}),(function(){return 0==e.queryElements("blockquote",1,r.unwrap).length}))}},12463:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(10187),r=n(1667),a="pre",l="code",i=a+">"+l;t.default=function(e,t){o.default(e,(function(e){var n=r.wrap(e,l),o=r.wrap(n,a);null==t||t(o)}),(function(){return 0==e.queryElements(i,1,(function(e){if(!e.previousSibling&&!e.nextSibling){var t=e.parentNode;r.unwrap(e),r.unwrap(t)}})).length}))}},12464:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4716);t.default=function(e){o.default(e,"strikeThrough")}},12465:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4716);t.default=function(e){o.default(e,"subscript")}},12466:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4716);t.default=function(e){o.default(e,"superscript")}},12467:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1667);t.default=function(e,t){t=Math.min(Math.max(Math.round(t),0),6),e.addUndoSnapshot((function(){e.focus();var n=!1;if(e.queryElements("H1,H2,H3,H4,H5,H6",1,(function(t){n||(e.getDocument().execCommand("formatBlock",!1,"<DIV>"),n=!0);for(var o=e.getDocument().createElement("div");t.firstChild;)o.appendChild(t.firstChild);e.replaceNode(t,o)})),t>0){for(var r=e.getSelectionTraverser(),a=r?r.currentBlockElement:null,l=new o.HtmlSanitizer({cssStyleCallbacks:{"font-size":function(){return!1}}});a;){var i=a.collapseToSingleElement();l.sanitize(i),a=r.getNextBlockElement()}e.getDocument().execCommand("formatBlock",!1,"<H"+t+">")}}),"Format")}},2377:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(12440);t.changeFontSize=o.default,t.FONT_SIZES=o.FONT_SIZES;var r=n(12441);t.clearBlockFormat=r.default;var a=n(12442);t.clearFormat=a.default;var l=n(12443);t.createLink=l.default;var i=n(12444);t.getFormatState=i.default,t.getElementBasedFormatState=i.getElementBasedFormatState;var u=n(12445);t.insertEntity=u.default;var d=n(12446);t.insertImage=d.default;var c=n(12447);t.insertTable=c.default;var s=n(12448);t.editTable=s.default;var f=n(12449);t.formatTable=f.default;var g=n(12450);t.removeLink=g.default;var v=n(12451);t.replaceWithNode=v.default;var m=n(12452);t.rotateElement=m.default;var p=n(12453);t.setAlignment=p.default;var y=n(10180);t.setBackgroundColor=y.default;var h=n(10183);t.setTextColor=h.default;var b=n(12454);t.setDirection=b.default;var C=n(10181);t.setFontName=C.default;var S=n(10182);t.setFontSize=S.default;var E=n(12456);t.setImageAltText=E.default;var O=n(12457);t.setIndentation=O.default;var _=n(12459);t.changeCapitalization=_.default;var N=n(10184);t.toggleBold=N.default;var M=n(12460);t.toggleBullet=M.default;var P=n(10185);t.toggleItalic=P.default;var L=n(12461);t.toggleNumbering=L.default;var F=n(12462);t.toggleBlockQuote=F.default;var w=n(12463);t.toggleCodeBlock=w.default;var B=n(12464);t.toggleStrikethrough=B.default;var T=n(12465);t.toggleSubscript=T.default;var x=n(12466);t.toggleSuperscript=x.default;var A=n(10186);t.toggleUnderline=A.default;var k=n(12467);t.toggleHeader=k.default;var j=n(10179);t.experimentCommitListChains=j.default},4716:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1667),r=null;t.default=function(e,t){e.focus();var n=function(){return e.getDocument().execCommand(t,!1,null)},a=e.getSelectionRange();a&&a.collapsed?(e.addUndoSnapshot(),n(),function(e){r||(r=Object.keys(o.PendableFormatCommandMap).map((function(e){return o.PendableFormatCommandMap[e]})));return r.indexOf(e)>=0}(t)&&e.triggerPluginEvent(13,{formatState:o.getPendableFormatState(e.getDocument())})):e.addUndoSnapshot(n,"Format")}},5545:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1667),r="â€‹";t.default=function(e,t){e.focus();var n=e.getSelectionRange();if(n&&n.collapsed){var a=n.startContainer;if("SPAN"==o.getTagOfNode(a)&&(!a.firstChild||"BR"==o.getTagOfNode(a.firstChild)&&!a.firstChild.nextSibling))e.addUndoSnapshot(),t(a);else a&&3==a.nodeType&&a.nodeValue==r&&"SPAN"==o.getTagOfNode(a.parentNode)||(e.addUndoSnapshot(),a=e.getDocument().createTextNode(r),n.insertNode(a)),o.applyTextStyle(a,t),e.select(a,-1)}else e.addUndoSnapshot((function(){for(var n,o,r=e.getSelectionTraverser(),a=r&&r.currentInlineElement;a;){var l=r.getNextInlineElement();a.applyStyle((function(e,r){t(e,r),n=n||e,o=e})),a=l}n&&o&&e.select(n,-2,o,-3)}),"Format")}},6944:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(10179),r=n(1667);t.default=function(e,t,n){e.focus(),e.addUndoSnapshot((function(a,l){if(!n||n()){var i=e.getSelectedRegions(),u=e.isFeatureEnabled("ListChain")?r.VListChain.createListChains(i,null==a?void 0:a.node):[];i.forEach((function(e){return t(e,a,l,u)})),o.default(e,u)}e.select(a,l)}),"Format")}},8099:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1667);t.default=function(e,t){var n=e.getElementAtCursor("OL,UL");if(o.Browser.isChrome&&"indent"!==t){var r=e.getElementAtCursor("LI");if(r){var a=e.getSelectionRange(),l=o.getSelectionPath(r,a);if(a&&(a.collapsed||e.getElementAtCursor("LI",a.startContainer)==r&&e.getElementAtCursor("LI",a.endContainer)==r))if("OL"===n.tagName&&"insertUnorderedList"===t||"UL"===n.tagName&&"insertOrderedList"===t)e.getDocument().execCommand(t,!1,null);else{var i=n.parentElement;if("OL"==i.tagName||"UL"==i.tagName)r.nextElementSibling&&o.splitBalancedNodeRange(r),n.insertAdjacentElement("afterend",r),e.select(o.createRange(r,l.start,l.end));else{r.nextElementSibling&&o.splitBalancedNodeRange(r);var u=o.wrap(o.toArray(r.childNodes)),d=o.createRange(u,l.start,l.end),c=o.getSelectionPath(u,d);n.insertAdjacentElement("afterend",u),e.deleteNode(r);var s=o.createRange(u,c.start,c.end);e.select(s)}0==n.childElementCount&&e.deleteNode(n)}else e.getDocument().execCommand(t,!1,null)}else e.getDocument().execCommand(t,!1,null)}else e.getDocument().execCommand(t,!1,null);var f=e.getElementAtCursor("OL,UL");return f==n&&(f=null),f}},8100:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(6944),r=n(1667);t.default=function(e,t,n){o.default(e,(function(e,o,a,l){var i,u=n>0&&l.filter((function(e){return e.canAppendAtCursor(n)}))[0],d=u&&o.equalTo(a)?u.createVListAtBlock(null===(i=r.getBlockElementAtNode(e.rootNode,o.node))||void 0===i?void 0:i.collapseToSingleElement(),n):r.createVListFromRegion(e,!0);d&&(d.changeListType(o,a,t),d.writeBack())}))}}}]);
//# sourceMappingURL=owa.39.js.map
self.scriptsLoaded['owa.39.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.39.js'] = (new Date()).getTime();