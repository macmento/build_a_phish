self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MarkRead.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[654],{13057:function(e){e.exports=JSON.parse('{"a":"Htb","b":"Itb","c":"Jtb","d":"Ktb"}')},13058:function(e){e.exports=JSON.parse('{"a":"Dtb","b":"Etb","c":"Ftb","d":"Gtb"}')},13059:function(e){e.exports=JSON.parse('{"a":"ztb","b":"Atb","c":"Btb","d":"Ctb"}')},1674:function(e,n,t){"use strict";t.d(n,"l",(function(){return u})),t.d(n,"d",(function(){return d})),t.d(n,"b",(function(){return l})),t.d(n,"a",(function(){return b})),t.d(n,"c",(function(){return f})),t.d(n,"e",(function(){return v})),t.d(n,"i",(function(){return m})),t.d(n,"h",(function(){return O})),t.d(n,"f",(function(){return k})),t.d(n,"j",(function(){return j})),t.d(n,"k",(function(){return p})),t.d(n,"g",(function(){return I}));var i,r,a=t(37),o=t(17),c=t(1858),u=["ar-sa","da-dk","de-at","de-ch","de-de","el-gr","en-ar","en-at","en-au","en-br","en-ca","en-ch","en-cl","en-co","en-de","en-dk","en-fi","en-gb","en-gr","en-hk","en-ie","en-in","en-mx","en-my","en-nl","en-no","en-nz","en-pe","en-pt","en-sa","en-se","en-sg","en-th","en-tr","en-us","en-za","es-ar","es-cl","es-co","es-ec","es-es","es-mx","es-pe","es-us","es-ve","fi-fi","fr-be","fr-ca","fr-ch","fr-fr","it-it","ja-jp","ko-kr","ms-my","nb-no","nl-be","nl-nl","pt-br","pt-pt","sv-se","th-th","tr-tr","zh-cn","zh-hk","zh-sg","zh-tw"],d=["ar-ir","es-cu","ko-kp","ar-sy","en-su","uk-ua"],s={ae:"ar-ae",ar:"es-ar",at:"de-at",au:"en-au",be:"fr-be",br:"pt-br",ca:"en-ca",ch:"de-ch",cl:"es-cl",cn:"zh-cn",co:"es-co",cr:"es-cr",cu:"es-cu",de:"de-de",dk:"da-dk",do:"es-do",ec:"es-ec",eg:"ar-eg",es:"es-es",fi:"fi-fi",fr:"fr-fr",gb:"en-gb",uk:"en-gb",gr:"el-gr",gt:"es-gt",hk:"zh-hk",id:"id-id",ie:"en-ie",in:"en-in",ir:"ar-ir",it:"it-it",jp:"ja-jp",kp:"ko-kp",kr:"ko-kr",mx:"es-mx",my:"ms-my",nl:"nl-nl",no:"nb-no",nz:"en-nz",pe:"es-pe",ph:"fil-ph",pl:"pl-pl",pt:"pt-pt",ru:"ru-ru",sa:"ar-sa",se:"sv-se",sg:"en-sg",su:"en-su",th:"th-th",tr:"tr-tr",tw:"zh-tw",ua:"uk-ua",us:"en-us",ve:"es-ve",vn:"vi-vn",za:"en-za"};function l(){return Object(c.a)()}function b(){return Object(o.a)().IsConsumerChild}function f(){return Object(o.a)().SessionSettings.IsShadowMailbox}function v(){return void 0!==r?r:r=function(){var e=Object(o.a)(),n=e.SessionSettings.UserCulture;if(!e.AdMarket||!/^[a-zA-z\-]*$/.test(e.AdMarket))return n?n.toLowerCase():"en-us";var t=e.AdMarket.toLowerCase();return u.indexOf(t)>-1?t:s[t.split("-")[1]]||t}()}function m(e){return null!=e?e.toUpperCase().split("-"):[]}function O(e){return m(e)[1]||"US"}function k(){return Object(a.a)("ANON")}function j(){return Object(a.a)("MUID")}function p(){return!!Object(a.a)("TOptOut")}function I(){return i||(i="https://acdn.adnxs.com/ast/static/0.30.1/ast.js")}},1700:function(e,n,t){"use strict";var i;!function(e){e[e.Auto=0]="Auto",e[e.Init=1]="Init",e[e.LeftNavResizeExpand=2]="LeftNavResizeExpand",e[e.ToggleExpand=3]="ToggleExpand",e[e.ToggleCollapse=4]="ToggleCollapse",e[e.WindowResize=5]="WindowResize",e[e.ToggleFolderPane=6]="ToggleFolderPane",e[e.DateRangeTypeChange=7]="DateRangeTypeChange",e[e.CalendarViewTypeChange=8]="CalendarViewTypeChange",e[e.OwaSuiteHeaderFlexPane=9]="OwaSuiteHeaderFlexPane"}(i||(i={}));var r=i,a=t(2),o=Object(a.createStore)("OwaLayout",{browserWidthBucket:null,areDisplayAdsEnabled:!1}),c=Object(a.mutatorAction)("setBrowserWidthBucket",(function(e){o().browserWidthBucket=e})),u=t(3);function d(e,n,t){var i=Object(u.m)(e);return n&&(i>1900?i-=305:i>990&&(i-=165)),t&&(i-=320),i>=1600?1600:i>=1400?1599:i>=1366?1399:i>=1301?1365:i>=1239?1300:i>=1200?1238:i>=1080?1199:i>=1e3?1079:i>=919?999:i>=900?918:i>=866?899:i>=769?865:i>=692?768:i>=686?691:i>=580?685:i>=555?579:i>=542?554:i>=500?541:i>=419?499:418}var s=Object(a.action)("onAvailableWidthBucketChanged",(function(e,n){return{availableWidthBucket:e,source:n}})),l=Object(a.mutatorAction)("setAreDisplayAdsEnabled",(function(e){o().areDisplayAdsEnabled=e}));function b(){return o().areDisplayAdsEnabled}var f=t(1722);function v(e){window.addEventListener("resize",m),l(e),O(r.Init)}function m(){O(r.WindowResize)}function O(e){var n=d(e!=r.Init,b(),Object(f.a)());o().browserWidthBucket!=n&&(c(n),n<=418?k():j(),s(n,e))}function k(){var e;(null===(e=window.document)||void 0===e?void 0:e.body)&&(document.body.style.overflowX="auto")}function j(){var e;(null===(e=window.document)||void 0===e?void 0:e.body)&&(document.body.style.overflow="hidden")}var p=t(59);function I(){return h()}function h(){return Object(p.l)()||Object(p.d)()}function y(){var e=o().browserWidthBucket;return e||void 0}Object(a.orchestrator)(f.d,(function(e){var n=d(!1,b(),e.isShown);c(n),s(n,r.OwaSuiteHeaderFlexPane)})),t.d(n,"a",(function(){return r})),t.d(n,"f",(function(){return v})),t.d(n,"b",(function(){return k})),t.d(n,"e",(function(){return j})),t.d(n,"d",(function(){return I})),t.d(n,"g",(function(){return h})),t.d(n,"h",(function(){return s})),t.d(n,"c",(function(){return y}))},1774:function(e,n,t){"use strict";t.d(n,"q",(function(){return s})),t.d(n,"t",(function(){return l})),t.d(n,"e",(function(){return b})),t.d(n,"a",(function(){return f})),t.d(n,"i",(function(){return v})),t.d(n,"o",(function(){return m})),t.d(n,"b",(function(){return O})),t.d(n,"m",(function(){return k})),t.d(n,"f",(function(){return j})),t.d(n,"p",(function(){return p})),t.d(n,"s",(function(){return I})),t.d(n,"r",(function(){return h})),t.d(n,"g",(function(){return y})),t.d(n,"j",(function(){return w})),t.d(n,"k",(function(){return R})),t.d(n,"n",(function(){return N})),t.d(n,"d",(function(){return T})),t.d(n,"c",(function(){return g})),t.d(n,"h",(function(){return _})),t.d(n,"l",(function(){return S}));var i=t(0),r=t(44),a=t(1625),o=t(1632),c=t(2),u=t(1699),d=t(17),s=Object(c.action)("SINGLE_SELECT_ROW",(function(e,n,t,i){return Object(r.c)(A(i,e,n),{tableView:e,rowKey:n,isUserNavigation:t,mailListItemSelectionSource:i})})),l=Object(c.action)("TOGGLE_SELECT_ROW",(function(e,n,t,i){return Object(r.c)(A(i,e,n),{tableView:e,rowKey:n,isUserNavigation:t,mailListItemSelectionSource:i})})),b=Object(c.action)("ON_AFTER_SELECTION_CHANGED",(function(e,n,t,i,r){return{rowKey:e,tableView:n,mailListItemSelectionSource:t,listViewType:i,sxsId:r}})),f=Object(c.action)("EXPAND_ROW_FIRST_LEVEL",(function(e,n){return{rowKey:e,latestItemIdsInForks:n}})),v=Object(c.action)("RESET_LIST_VIEW_EXPANSION_VIEW_STATE"),m=Object(c.action)("SET_SECOND_LEVEL_LIST_VIEW_EXPANSION",(function(e){return{rowKey:e}})),O=Object(c.action)("ITEM_PART_SELECTED",(function(e,n,t,i,r){return{nodeId:e,itemId:n,allNodeIds:t,tableView:i,mailListItemSelectionSource:r}})),k=Object(c.action)("SELECT_NEXT_ITEM_PART",(function(e,n){return{rowKey:e,tableView:n}})),j=Object(c.action)("ON_ITEM_PART_CONTEXT_MENU",(function(e,n,t){return{contextMenuAnchor:e,nodeId:n,tableViewId:t}})),p=Object(c.action)("SINGLE_SELECT_ITEM_PART",(function(e,n,t,i,r){return{rowKey:e,nodeIdToSelect:n,allNodeIds:t,tableViewId:i,currentSelectedNodeIds:r}})),I=Object(c.action)("TOGGLE_SELECT_ITEM_PART",(function(e){return{nodeId:e}})),h=Object(c.action)("TOGGLE_SELECT_ALL_ROWS",(function(e){return{tableView:e}})),y=Object(c.action)("RANGE_SELECT_ROW",(function(e,n,t,i){return{tableView:e,targetRowKey:n,mailListItemSelectionSource:t,isCtrlOrCmdKeyDown:i}})),w=Object(c.action)("RESET_SELECTION",(function(e,n){return{tableView:e,mailListItemSelectionSource:n}})),R=Object(c.action)("RESET_SELECTION",(function(e){return{tableView:e}})),N=Object(c.action)("SELECT_ROW_IN_DIRECTION",(function(e,n,t){return Object(r.c)(A(t,e,void 0,n),{tableView:e,selectionDirection:n,mailListItemSelectionSource:t})})),T=Object(c.action)("KEYBOARD_MULTI_SELECT_ROW",(function(e,n,t,i){return{tableView:e,mailListItemSelectionSource:n,selectionDirection:t,isCtrlOrCmdKeyDown:i}})),g=Object(c.action)("KEYBOARD_COLLAPSE_CONVERSATION",(function(e){return{rowKey:e}})),_=Object(c.action)("RESET_BUS_STOP_STATE_MAP"),S=Object(c.action)("SELECT_NEW_ITEM_UPON_ROW_REMOVAL",(function(e,n,t){return{tableView:e,lastSelectedRowIndex:n,lastSelectedRowWasPinned:t}}));function A(e,n,t,r){return{name:function(e,n,t,r){return!(function(e){return e===o.b.MailListItemRichPreview||e===o.b.KeyboardShiftEnter||e===o.b.MailListItemBodyDoubleClick}(e)||Object(u.c)()&&!function(e){var n;return e===o.b.KeyboardEnter||e===o.b.MailListItemBody||e===o.b.RouteHandler||e===o.b.CommandBarArrows||e===o.b.ImmersiveReadingPaneDelete&&"ReturnToView"!==(null===(n=Object(d.a)().UserOptions)||void 0===n?void 0:n.NextSelection)}(e)||function(e,n,t,r){if(Object(u.c)())return!1;if(e===o.b.KeyboardUpDown){var c=n.rowKeys.indexOf(n.selectionAnchorRowKey);if(-1!==c&&1===n.selectedRowKeys.size){var d=n.rowKeys.indexOf(Object(i.__spread)(n.selectedRowKeys.keys())[0]);return r===a.d.Next?d===c+1||d===n.rowKeys.length-1&&c===n.rowKeys.length-1:d===c-1||0===d&&0===c}return!1}return t&&n.selectedRowKeys.has(t)&&1===n.selectedRowKeys.size}(e,n,t,r))}(e,n,t,r)?"SelectMailItem":"SelectMailItemNonCritical",options:{timeout:9e4}}}},1858:function(e,n,t){"use strict";var i=t(65),r=t(33),a="PremiumConsumerSetting";function o(){var e,n,t,o,c,u;if(null===(n=null===(e=Object(i.h)())||void 0===e?void 0:e.SessionSettings)||void 0===n?void 0:n.IsPremiumConsumerMailbox)return!0;if(Object(r.i)("auth-PremiumCheckUpdates")){var d=null===(o=null===(t=Object(i.h)())||void 0===t?void 0:t.PrimeSettings)||void 0===o?void 0:o.Items,s=null==d?void 0:d.filter((function(e){return(null==e?void 0:e.Id)===a}));return null!==(u=null===(c=null==s?void 0:s[0])||void 0===c?void 0:c.Value)&&void 0!==u&&u}return!1}t.d(n,"a",(function(){return o}))},1871:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var i=t(33),r=t(65);function a(){return Object(i.i)("mail-oneView")&&Object(r.r)()}},1872:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var i=t(33),r=t(302);function a(e){return Object(i.i)("tri-officeRail")&&(e===r.a.Mail||e===r.a.Calendar)}},1908:function(e,n,t){"use strict";var i=t(36),r=t(2068),a=t(1625),o=t(1632),c=t(954),u=t(1626);function d(e,n){return e&&!Object(a.w)()&&n&&"UserMailbox"===n.type&&!Object(o.m)(e)&&e!=Object(c.a)("recoverableitemsdeletions")&&!Object(u.D)(e,"SharedMailbox")}t.d(n,"e",(function(){return l})),t.d(n,"a",(function(){return r.a})),t.d(n,"b",(function(){return r.b})),t.d(n,"d",(function(){return r.c})),t.d(n,"c",(function(){return d}));var s=new i.c((function(){return t.e(951).then(t.bind(null,16913))})),l=new i.a(s,(function(e){return e.undo}))},2008:function(e,n,t){"use strict";var i={};t.r(i),t.d(i,"add",(function(){return d})),t.d(i,"remove",(function(){return s})),t.d(i,"removeAll",(function(){return l})),t.d(i,"getCount",(function(){return b})),t.d(i,"getTombstonedReasons",(function(){return f})),t.d(i,"clearMapForFolder",(function(){return v})),t.d(i,"removeRowsFromTombstone",(function(){return m}));var r=t(0),a=t(2),o=Object(a.createStore)("tombstone",{folderTombstoneMap:{}}),c=(o(),t(114)),u=t(151),d=Object(u.action)("tombstoneOperations.add")((function(e,n,t){if(1!=n.tableQuery.type&&"spotlight"!==n.tableQuery.scenarioType){var i=n.serverFolderId,r=o().folderTombstoneMap;i in r||(r[i]={});var a=r[i];e.forEach((function(e){var n=a[e];n?3!=t?n.indexOf(3)>-1||-1==n.indexOf(t)&&n.push(t):a[e]=[3]:a[e]=[t]}))}})),s=Object(u.action)("tombstoneOperations.remove")((function(e,n,t){var i=o().folderTombstoneMap;if(n in i){var r=i[n],a=r[e],c=a?a.indexOf(t):-1;if(-1==c)throw new Error("tombstone.remove given reason does not exist when trying to remove entry from it");a.splice(c,1),0==a.length&&delete r[e],0==Object.keys(r).length&&delete i[n]}})),l=Object(u.action)("tombstoneOperations.removeAll")((function(){o().folderTombstoneMap={},Object(c.s)("TnS_RemoveAllFromTombstone")})),b=function(e,n){var t=o().folderTombstoneMap;if(!(e in t))return 0;var i=0,r=t[e];return Object.values(r).forEach((function(e){e==n&&i++})),i},f=function(e,n){var t=o().folderTombstoneMap;if(n in t){var i=t[n][e];if(i)return i}return[]},v=Object(u.action)("tombstoneOperations.clearMapForFolder")((function(e){var n=o().folderTombstoneMap;n[e]&&(Object(c.s)("TnS_ClearFolderMapInTombstone",[Object.keys(n[e]).length]),delete n[e])})),m=Object(u.action)("tombstoneOperations.removeRowsFromTombstone")((function(e,n){var t,i,a=o().folderTombstoneMap;if(n in a){var c=a[n];try{for(var u=Object(r.__values)(e),d=u.next();!d.done;d=u.next()){var s=d.value;s in c&&delete c[s]}}catch(e){t={error:e}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(t)throw t.error}}0==Object.keys(c).length&&delete a[n]}}));n.a=i},2019:function(e,n,t){"use strict";var i=t(1871),r=t(33),a=t(1674),o=t(895);var c=t(1872);function u(e){return Object(r.i)("auth-cloudCache")&&(Object(a.b)()||Object(a.c)())&&Object(o.a)()||Object(i.a)()||Object(c.a)(e)}t.d(n,"a",(function(){return u}))},2056:function(e,n,t){"use strict";var i=t(2);n.a=Object(i.action)("MARK_ALL_AS_READ_STORE_UPDATE",(function(e,n,t){return{tableView:e,markAsRead:n,rowIdsToExclude:t}}))},2065:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var i=t(2),r=Object(i.action)("USERMAIL_INTERACTION",(function(e,n,t){return{interactionType:e,instrumentationContexts:n,triageContext:t}}))},2068:function(e,n,t){"use strict";var i,r,a=t(0),o=t(2),c=Object(o.createStore)("undo",{hasUndoableAction:!1,undoableActionFolderId:null})(),u=t(2008),d=t(151),s=t(44),l=t(708),b={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DismissUndo"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dismissUndo"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"undoRequestId"},value:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]};t.d(n,"a",(function(){return f})),t.d(n,"b",(function(){return v})),t.d(n,"c",(function(){return O})),t.d(n,"d",(function(){return k}));var f=Object(d.action)("addActionToUndoStack")(Object(d.select)({store:function(){return c}})((function(e,n,t,a){null!==e&&(i=e,a.store.hasUndoableAction=!0,a.store.undoableActionFolderId=n,r=t)}))),v=Object(d.action)("clearLastUndoableAction")(Object(d.select)({store:function(){return c}})((function(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,t,o;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:if(!r)return[3,7];a.label=1;case 1:return a.trys.push([1,5,,6]),[4,r];case 2:return(n=a.sent()).success&&(t=n.undoRequestId)?(o={undoRequestId:t},[4,m.invokeDismissUndoMutation(o)]):[3,4];case 3:a.sent(),a.label=4;case 4:return[3,6];case 5:return a.sent(),[3,6];case 6:r=null,a.label=7;case 7:return i=null,e.store.hasUndoableAction=!1,e.store.undoableActionFolderId=null,[2]}}))}))}))),m={invokeDismissUndoMutation:function(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(l.a)()];case 1:return[4,n.sent().mutate({variables:e,mutation:b})];case 2:return n.sent(),[2]}}))}))}},O=Object(d.select)({store:function(){return c}})((function(e){return e.store.hasUndoableAction})),k=Object(s.d)("undo",{name:"TnS_Undo",customData:function(e){return[e]}})((function(e){c.undoableActionFolderId?u.a.clearMapForFolder(c.undoableActionFolderId):u.a.removeAll();null!==i&&(i(),v())}))},2069:function(e,n,t){"use strict";var i=t(36),r=t(2167),a=t(1632),o=t(151),c=Object(o.action)("setIsPendingDeleteConversationItemParts")(Object(o.select)({conversationItemParts:function(e){return a.u.conversations.get(e)}})((function(e,n,t){var i=t.conversationItemParts;i&&(i.isPendingDelete=n)}))),u=t(2079);t.d(n,"c",(function(){return s})),t.d(n,"e",(function(){return l})),t.d(n,"d",(function(){return b})),t.d(n,"b",(function(){return r.a})),t.d(n,"f",(function(){return c})),t.d(n,"a",(function(){return u.b}));var d=new i.c((function(){return Promise.all([t.e(254),t.e(652)]).then(t.bind(null,17462))})),s=new i.a(d,(function(e){return e.loadAllRecipientsForItem})),l=new i.a(d,(function(e){return e.loadItem})),b=new i.a(d,(function(e){return e.loadConversation}))},2079:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return r}));var i=20,r=10},2166:function(e,n,t){"use strict";var i=t(2);n.a=Object(i.action)("TRY_REMOVE_FROM_MAIL_STORE_ITEMS",(function(e,n){return{itemIdToRemove:e,removeItemSource:n}}))},2167:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var i=t(0),r=t(1632),a=t(2166),o=t(2619),c=t(2);function u(e){var n,t,c,u;if(r.u.conversations.has(e)){var l=r.u.conversations.get(e);try{for(var b=Object(i.__values)(l.conversationNodeIds),f=b.next();!f.done;f=b.next()){var v=f.value,m=r.u.conversationNodes.get(v);if(m)try{for(var O=(c=void 0,Object(i.__values)(m.itemIds)),k=O.next();!k.done;k=O.next()){var j=k.value;Object(a.a)(j,1)}}catch(e){c={error:e}}finally{try{k&&!k.done&&(u=O.return)&&u.call(O)}finally{if(c)throw c.error}}d(v)}}catch(e){n={error:e}}finally{try{f&&!f.done&&(t=b.return)&&t.call(b)}finally{if(n)throw n.error}}s(e)}Object(o.a)()}var d=Object(c.mutatorAction)("deleteConversationNode",(function(e){r.u.conversationNodes.delete(e)})),s=Object(c.mutatorAction)("deleteConversation",(function(e){r.u.conversations.delete(e)}))},2175:function(e){e.exports=JSON.parse('{"a":"pba"}')},2178:function(e,n,t){"use strict";t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return c})),t.d(n,"a",(function(){return u}));var i=t(36),r=t(2065);t.d(n,"d",(function(){return r.a}));var a=new i.c((function(){return t.e(472).then(t.bind(null,4009))})),o=new i.a(a,(function(e){return e.onKeyboardUpDown})),c=new i.a(a,(function(e){return e.onOpenEmail})),u=new i.a(a,(function(e){return e.onKeyboardToggleSelect}))},2198:function(e,n,t){"use strict";var i=t(2);n.a=Object(i.action)("MARK_CONVERSATIONS_AS_READ_STORE_UPDATE",(function(e,n,t,i){return{conversationIds:e,tableViewId:n,isReadValue:t,isExplicit:i}}))},2199:function(e,n,t){"use strict";var i=t(2);n.a=Object(i.action)("MARK_ITEMS_AS_READ_STORE_UPDATE",(function(e,n,t,i){return{itemIds:e,isReadValue:n,isExplicit:t,tableViewId:i}}))},2241:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var i=t(2),r=Object(i.action)("setShowFolderPane",(function(e){return{showFolderPane:e}}))},2292:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var i=t(2998);function r(e,n){return e.map((function(e){return Object(i.getInstrumentationContext)(e,n)})).filter((function(e){return e}))}},2332:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var i=t(2),r=Object(i.action)("setShowListPane",(function(e){return{showListPane:e}}))},2333:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var i=t(2),r=Object(i.action)("setShowReadingPane",(function(e){return{showReadingPane:e}}))},2363:function(e,n,t){"use strict";t.d(n,"b",(function(){return i})),t.d(n,"a",(function(){return r})),t.d(n,"c",(function(){return a}));var i=350,r=270,a=418},2396:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var i=t(1700),r=t(1699);function a(){var e=Object(i.c)();return Object(r.a)()?e<=541:e<=918}},2445:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var i=t(1746);function r(){return Object(i.a)().showFolderPane}},2619:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return a}));var i=t(2),r=Object(i.action)("ON_DELETE_CONVERSATION_ITEM_PARTS_COMPLETE"),a=Object(i.action)("TOGGLE_ROW_READ_STATE_COMPLETE")},2668:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var i=t(2),r=Object(i.action)("onClientReadingPanePositionChange")},2780:function(e){e.exports=JSON.parse('{"a":"Ilb","c":"Jlb","e":"Klb","b":"Llb","d":"Mlb"}')},2788:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var i=t(1626);function r(e){return Object(i.D)(e,"SharedMailbox")}},2984:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var i=t(1629),r=t(3109);function a(e,n){return n?i.a.items.get(e):Object(r.b)(e)}},3017:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var i=t(1746);function r(){return Object(i.a)().showListPane}},302:function(e,n,t){"use strict";var i;!function(e){e.Mail="Mail",e.Calendar="Calendar",e.People="People",e.FilesHub="FilesHub",e.Tasks="Tasks",e.OutlookSpaces="OutlookSpaces",e.Eventify="Eventify",e.PublishedCalendar="PublishedCalendar",e.MailDeepLink="MailDeepLink"}(i||(i={})),t.d(n,"a",(function(){return i}))},3088:function(e,n,t){"use strict";var i=t(2008);function r(e,n,t){t&&i.a.removeRowsFromTombstone(e,n)}var a=t(3684);function o(e){e&&Object(a.a)(e)}var c=t(1686),u=t(114);function d(e,n,t,i,a,d){var s=Object(u.t)();return e.then((function(e){return s&&s.addCheckpoint("PAPCARM"),r(n,t,a),d?void 0:Object(c.a)(e)})).catch((function(e){return r(n,t,a),o(i),Promise.reject(e)}))}var s=t(0);function l(e,n,t,i,a){return e.then((function(e){if(r(n,t,a),e.ResponseMessages){var c=function(e,n){var t,i;try{for(var r=Object(s.__values)(e),a=r.next();!a.done;a=r.next()){var c=a.value;if(c&&"Success"!=c.ResponseClass){o(n);var u=new Error("ResponseCode="+c.ResponseCode+", Stacktrace="+c.StackTrace);return u.fetchErrorType="ServerFailure",u}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}return null}(e.ResponseMessages.Items,i);return c?Promise.reject(c):Promise.resolve()}return Promise.reject(new Error("processUpdateItemActionResponseMessage empty response"))})).catch((function(e){return r(n,t,a),o(i),Promise.reject(e)}))}t.d(n,"c",(function(){return d})),t.d(n,"d",(function(){return l})),t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return o}))},3219:function(e){e.exports=JSON.parse('{"a":"Ltb"}')},3501:function(e){e.exports=JSON.parse('{"a":"utb","c":"vtb","e":"wtb","b":"xtb","d":"ytb"}')},3684:function(e,n,t){"use strict";var i=t(2);n.a=Object(i.action)("RELOAD_TABLE_ON_TRIAGE_ACTION_FAIL",(function(e){return{tableView:e}}))},3985:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var i=t(2394);function r(e,n){var t={};return e.forEach((function(e){var r,a=null===(r=Object(i.a)(e,n))||void 0===r?void 0:r.itemIds;a&&a.forEach((function(e){t[e]||(t[e]=!0)}))})),Object.keys(t)}},4177:function(e,n,t){"use strict";t.r(n);var i=t(0),r=t(1625),a={markConversationAsRead:{name:function(e,n,t,i,r,a,o){var c="TnS_MarkConversation";return c+=t?"Read":"Unread",i||(c+="Background"),c},options:function(e,n,t,i,r,a,o){return i?{isCore:!0}:{sessionSampleRate:10}},customData:function(e,n,t,i,a,o,c){return[a,e.length,Object(r.l)(n),Object(r.O)(n)]},cosmosOnlyData:function(e,n,t,a,o,c,u){var d,s,l=[],b=Object(r.E)(e,n);try{for(var f=Object(i.__values)(b),v=f.next();!v.done;v=f.next()){var m=v.value;l.push(r.b.getItemIds(m,n))}}catch(e){d={error:e}}finally{try{v&&!v.done&&(s=f.return)&&s.call(f)}finally{if(d)throw d.error}}return JSON.stringify({itemIds:l,conversationIds:e})}},markItemReadUnread:{name:function(e,n,t,i,r,a){var o="TnS_MarkItem";return o+=t?"Read":"Unread",i||(o+="Background"),o},options:function(e,n,t,i,r,a){return i?{isCore:!0}:{}},customData:function(e,n,t,i,a,o){var c=e?e.tableQuery.type:null,u=e?Object(r.l)(e):null,d=e?Object(r.O)(e):null;return[c,n.length,u,d]},cosmosOnlyData:function(e,n,t,i,r,a){return JSON.stringify({itemIds:n})},actionSource:function(e,n,t,i,r){return r}}},o=t(151),c=t(2),u=Object(c.createStore)("markread",{markAsReadTimerTask:null,suppressedItemIdsMap:{}})(),d=Object(o.action)("AddMarkReadSuppressedItemIds")(Object(o.select)({store:function(){return u}})((function(e,n){e.forEach((function(e){return n.store.suppressedItemIdsMap[e]=!0}))}))),s=Object(o.action)("RemoveMarkReadSuppressedItemIds")(Object(o.select)({store:function(){return u}})((function(e,n){e.forEach((function(e){return delete n.store.suppressedItemIdsMap[e]}))}))),l=Object(o.action)("ClearMarkReadSuppressedMap")(Object(o.select)({store:function(){return u}})((function(e){e.store.suppressedItemIdsMap={}})));function b(e){for(var n=0;n<e.length;n++)if(!u.suppressedItemIdsMap[e[n]])return!1;return!0}var f=t(6437),v=t(2178),m=t(2198),O=t(5440),k=t(1717),j=t(23),p=t(44),I=t(3088);var h=t(1629);var y=t(2199),w=t(708),R={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MarkItemAsRead"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ids"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isRead"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipts"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isUserInitiated"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markItemAsRead"},arguments:[{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"ids"},value:{kind:"Variable",name:{kind:"Name",value:"ids"}}},{kind:"ObjectField",name:{kind:"Name",value:"isRead"},value:{kind:"Variable",name:{kind:"Name",value:"isRead"}}},{kind:"ObjectField",name:{kind:"Name",value:"suppressReadReceipts"},value:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipts"}}},{kind:"ObjectField",name:{kind:"Name",value:"isUserInitiated"},value:{kind:"Variable",name:{kind:"Name",value:"isUserInitiated"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]},N=t(17),T=Object(p.d)("markItemsAsReadBasedOnItemIds",a.markItemReadUnread)((function(e,n,t,a,o,c){return Object(i.__awaiter)(this,void 0,void 0,(function(){var u,l,b,m,O;return Object(i.__generator)(this,(function(i){return 0==(u=function(e,n){var t=[];return e.forEach((function(e){var i=h.a.items.get(e);Object(r.V)(i)&&i&&i.IsRead!=n&&t.push(e)})),t}(n,t)).length?[2,Promise.resolve()]:(t?s(u):a?d(u):j.g.warn("Invalid scenario to implicitly mark item as unread."),l=e?e.id:null,Object(y.a)(u,t,a,l),f.a.import().then((function(n){n(e?e.tableQuery:null,!1,t,o,u)})),b={itemIds:u},t?a?Object(v.d)("MarkAsRead",c,b):Object(v.d)("MarkAsReadImplicit",c,b):Object(v.d)("MarkAsUnread",c,b),m=Object(k.e)(e.tableQuery).mailboxInfo,O=e?Object(r.E)(u,e):[],[2,g(e,O,u,t,a,m)])}))}))}));function g(e,n,t,r,a,o){return Object(i.__awaiter)(this,void 0,void 0,(function(){var c,u,d,s;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:c=Object(N.a)(),u="AlwaysSend"!=c.UserOptions.ReadReceipt,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,_.invokeMarkItemAsReadMutation(t,r,u,a,o)];case 2:return i.sent(),[2];case 3:return d=i.sent(),s=e?e.serverFolderId:null,Object(I.a)(n,s,!0),[2,Promise.reject(d)];case 4:return[2]}}))}))}var _={invokeMarkItemAsReadMutation:function(e,n,t,r,a){var o;return Object(i.__awaiter)(this,void 0,void 0,(function(){var c;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,Object(w.a)()];case 1:return[4,i.sent().mutate({variables:{ids:e,isRead:n,suppressReadReceipts:t,isUserInitiated:r,mailboxInfo:a},mutation:R})];case 2:return c=i.sent(),[2,null===(o=null==c?void 0:c.data)||void 0===o?void 0:o.markItemAsRead]}}))}))}},S={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MarkConversationAsRead"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isRead"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isUserInitiated"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markConversationAsRead"},arguments:[{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"isRead"},value:{kind:"Variable",name:{kind:"Name",value:"isRead"}}},{kind:"ObjectField",name:{kind:"Name",value:"isUserInitiated"},value:{kind:"Variable",name:{kind:"Name",value:"isUserInitiated"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]},A=t(4793),E=Object(p.d)("markConversationsAsReadBasedOnConversationIds",a.markConversationAsRead)((function(e,n,t,a,o,c,u){var s=function(e,n,t){var i=[];return e.forEach((function(e){var a=Object(r.K)(e,n);if(a){var o=0==a.unreadCount,c=a.itemIds.length,u=a.unreadCount==c;o&&t||u&&!t||i.push(e)}})),i}(u,n.id,t);if(0==s.length)return Promise.resolve();if(1==e.length&&1==n.selectedRowKeys.size){var b=r.b.getRowIdString(s[0],n),p=Object(r.K)(Object(i.__spread)(n.selectedRowKeys.keys())[0],n.id);if(b==p.id){var h=p.itemIds;t?l():a?d(h):j.g.warn("Invalid scenario to implicitly mark conversation as unread.")}}Object(m.a)(e,n.id,t,a),f.a.import().then((function(i){i(n.tableQuery,!1,t,o,e)}));var y={conversationIds:e};t?a?Object(v.d)("MarkAsRead",c,y):Object(v.d)("MarkAsReadImplicit",c,y):Object(v.d)("MarkAsUnread",c,y);var w=Object(k.e)(n.tableQuery).mailboxInfo;return Object(r.e)(n)?function(e,n,t,a,o){var c=[];return n.forEach((function(n){c.push.apply(c,Object(i.__spread)(r.b.getItemIds(n,e)))})),g(e,n,c,t,a,o)}(n,s,t,a,w):function(e,n,t,i,a){var o=Object(O.a)(e),c=n.map((function(n){return Object(r.h)(n,e.id)})),u=M.invokeMarkConversationAsReadMutation(c,t,i,o,a),d=Object(r.ab)(e,t,i);return Object(I.c)(u,n,o,e,d,!0)}(n,s,t,a,w)}));var M={invokeMarkConversationAsReadMutation:function(e,n,t,r,a){var o;return Object(i.__awaiter)(this,void 0,void 0,(function(){var c,u;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return c=e.map((function(e){return{id:e.conversationId,messagesAsOf:Object(A.a)(e.conversationLastSyncTimeStamp)}})),[4,Object(w.a)()];case 1:return[4,i.sent().mutate({variables:{conversations:c,isRead:n,isUserInitiated:t,folderId:r,mailboxInfo:a},mutation:S})];case 2:return u=i.sent(),[2,null===(o=null==u?void 0:u.data)||void 0===o?void 0:o.markConversationAsRead]}}))}))}},C=t(2394),V=Object(o.action)("autoMarkConversationAsRead")(Object(o.select)({items:function(){return h.a.items}})((function(e,n,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var a,o,c,d,s,f,v,m,O;return Object(i.__generator)(this,(function(k){switch(k.label){case 0:return a=Object(r.E)([e],n),(o=Object(C.a)(a[0],n.id))?Object(r.f)(n)?b(c=o.itemIds)?[2]:0!=Object.keys(u.suppressedItemIdsMap).length?[3,2]:[4,E([e],n,!0,!1,null,[],a)]:[2]:[2];case 1:return k.sent(),[3,9];case 2:k.trys.push([2,7,8,9]),d=Object(i.__values)(c),s=d.next(),k.label=3;case 3:return s.done?[3,6]:b([f=s.value])||!t.items.get(f)?[3,5]:[4,T(n,[f],!0,!1,null,[])];case 4:k.sent(),k.label=5;case 5:return s=d.next(),[3,3];case 6:return[3,9];case 7:return v=k.sent(),m={error:v},[3,9];case 8:try{s&&!s.done&&(O=d.return)&&O.call(d)}finally{if(m)throw m.error}return[7];case 9:return l(),[2]}}))}))}))),x=t(9287);var D=t(1716),L=Object(o.action)("autoMarkItemAsRead")((function(e,n,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(a){switch(a.label){case 0:return Object(r.f)(n)?b([e])?[2]:Object(D.a)()?(function(e,n,t){Object(i.__awaiter)(this,void 0,void 0,(function(){var a,o,c;return Object(i.__generator)(this,(function(u){return n?(a=t||Object(i.__spread)(e.selectedRowKeys.keys())[0],o=r.b.getRowClientItemId(a,e),(c=null==o?void 0:o.Id)?(Object(x.a)(e.tableQuery.folderId,c,n).then((function(n){T(e,n,!0,!1,null,[])})),[2]):[2]):[2]}))}))}(n,e,t),[3,3]):[3,1]:[2];case 1:return[4,T(n,[e],!0,!1,null,[])];case 2:a.sent(),a.label=3;case 3:return l(),[2]}}))}))}));function P(e,n){var t;return Object(i.__awaiter)(this,void 0,void 0,(function(){var a,o;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if("OnSelectionChange"!==Object(N.a)().UserOptions.PreviewMarkAsRead)return[2];switch(a=r.b.getRowIdString(e,n),n.tableQuery.listViewType){case 0:return[3,1];case 1:return[3,6]}return[3,8];case 1:return Object(D.a)()?(o=null===(t=r.b.getRowIdToShowInReadingPane(e,n))||void 0===t?void 0:t.Id,[4,L(o,n,e)]):[3,3];case 2:return i.sent(),[3,5];case 3:return[4,V(a,n)];case 4:i.sent(),i.label=5;case 5:return[3,8];case 6:return[4,L(a,n)];case 7:return i.sent(),[3,8];case 8:return[2]}}))}))}var F=t(1811),U=Object(o.action)("onReadingPaneClosed")((function(e,n){Object(F.q)()||j.d("onReadingPaneClosed should only be called in single line view."),P(e,n)})),K=Object(o.action)("onSingleSelectionChanged")((function(e,n,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return Object(F.q)()?[2]:t?[4,P(e,n)]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))}));function B(e,n,t){0==e.length||Object(F.q)()||1!==e.length||"Unread"===Object(r.O)(t)||P(e[0],n)}var z=Object(c.action)("MARK_ITEMS_READ_BASED_ON_NODE_IDS",(function(e,n,t,i,r){return{nodeIds:e,tableViewId:n,isReadValueToSet:t,isExplicit:i,actionSource:r}})),W=Object(o.action)("markItemAsReadFromReadingPane")((function(e,n,t,i,a){var o=[],c=null;if(n){if(Object(r.P)(n)){var u=h.a.items.get(e).ConversationId.Id;o=Object(r.E)([u],n)}else o=Object(r.E)([e],n);c=Object(r.k)(n)}T(n,[e],t,!0,a,i).then((function(){n&&Object(I.a)(o,c)})).catch((function(e){n&&(Object(I.a)(o,c),Object(I.b)(n))}))})),Q=t(2292),G=Object(o.action)("markConversationsAsReadFromTable")((function(e,n,t,i){var a=Object(r.C)(e,n.id),o=Object(Q.a)(e,n);return E(a,n,t,!0,i,o,e)})),J=Object(o.action)("markItemsReadFromTable")((function(e,n,t,i,a){var o=Object(r.C)(e,n.id),c=Object(Q.a)(e,n),u=T(n,o,t,i,a,c),d=Object(r.k)(n),s=Object(r.ab)(n,t,i);u.then((function(n){Object(I.a)(e,d,s)})).catch((function(t){Object(I.a)(e,d,s),Object(I.b)(n)}))})),X=t(2619),q=Object(o.action)("toggleRowReadState")((function(e,n,t){var i=r.X.tableViews.get(n),a=r.b.getUnreadCount(e,i)>0;switch(i.tableQuery.listViewType){case 0:G([e],i,a,t);break;case 1:J([e],i,a,!0,t)}Object(X.b)()})),H=Object(o.action)("onNavigateAwayViaUpDown")((function(e,n){P(e,n)})),Y=Object(c.action)("onKeyboardMarkAsRead",(function(e,n,t,i,r,a){return{tableView:e,selectedNodeIds:n,isInVirtualSelectAllMode:t,rowKeysToActOn:i,exclusionList:r,isReadValueToSet:a}})),$=t(3501),Z=t(2780),ee=t(3219),ne=t(13057),te=t(6),ie=t(6424),re=t(13058),ae=t(13059);var oe=t(114),ce=t(883),ue=t(874),de=t(4),se=t(33),le=t(1626),be=t(2175),fe=t(2056),ve=t(3985),me=t(2788),Oe=t(1908),ke={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MarkAllAsRead"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"markAsRead"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"clientLastSyncTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemIdsToExclude"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipt"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markAllAsRead"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"ObjectField",name:{kind:"Name",value:"markAsRead"},value:{kind:"Variable",name:{kind:"Name",value:"markAsRead"}}},{kind:"ObjectField",name:{kind:"Name",value:"clientLastSyncTime"},value:{kind:"Variable",name:{kind:"Name",value:"clientLastSyncTime"}}},{kind:"ObjectField",name:{kind:"Name",value:"itemIdsToExclude"},value:{kind:"Variable",name:{kind:"Name",value:"itemIdsToExclude"}}},{kind:"ObjectField",name:{kind:"Name",value:"suppressReadReceipt"},value:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipt"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folder"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"FolderId"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"},arguments:[],directives:[]}]}}]}}]}}]}}]},je=Object(o.action)("markAsReadInTable")((function(e,n,t,a,o,c,u){var d=this;if(o.length&&t)throw new Error("If in virtual select all mode, rowKeysToActOn should be empty.");if(n.length&&!t)throw new Error("If not in virtual select all mode, exclusionList should be empty.");var s=c.tableQuery.folderId,l=le.d.folderTable.get(s),b=c.isInVirtualSelectAllMode&&n.length>0,v=Object(r.O)(c),m="ContextFolder"===e||"CommandBar"===e&&t&&!c.isInCheckedMode&&!Object(r.S)(c,v),O=o.length>0&&!t,p=t&&l&&l.UnreadCount>=ie.b,I=function(e,n,t,i,a,o,c,u){if(e){if(Object(se.i)("tri-categoryUnreadCount")){var d=Object(r.N)(o);if(d)return Object(ce.n)(d)}return null==t?void 0:t.UnreadCount}if(Object(r.u)(o)||n||Object(r.S)(o,c)&&u)return o.totalRowsInView-i;return a}(m,b,l,n.length,o.length,c,v,t),h=p||I>=ie.b,y={headerText:"",bodyText:""};if(h){var w=Object(r.o)(c.tableQuery.type,c,l&&Object(le.j)(l));y=function(e,n,t,i,r,a,o,c){var u,d="",s="",l=1===n,b=e||l;return t<0&&(j.g.warn("totalCount in getMarkAsReadUnreadAllConfirmText should not be negative."),d=b?r?Object(te.b)($.e):Object(te.b)(Z.e):r?Object(te.b)($.c):Object(te.b)(Z.c)),1==t&&(d=r?Object(te.b)(ee.a):Object(te.b)(Z.a)),u=t<ie.a?t:"10000+",d=b?r?Object(te.c)(Object(te.b)($.d),u):Object(te.c)(Object(te.b)(Z.d),u):r?Object(te.c)(Object(te.b)($.b),u):Object(te.c)(Object(te.b)(Z.b),u),s=e?r?Object(te.c)(Object(te.b)(re.b),i):Object(te.c)(Object(te.b)(ae.b),i):a||o?l?r?Object(te.c)(Object(te.b)(re.d),i):Object(te.c)(Object(te.b)(ae.d),i):r?Object(te.c)(Object(te.b)(re.c),i):Object(te.c)(Object(te.b)(ae.c),i):l?r?Object(te.c)(Object(te.b)(re.b),i):Object(te.c)(Object(te.b)(ae.b),i):r?Object(te.c)(Object(te.b)(re.a),i):Object(te.c)(Object(te.b)(ae.a),i),c&&(s=l?r?Object(te.b)(ne.b):Object(te.b)(ne.d):r?Object(te.b)(ne.a):Object(te.b)(ne.c)),{headerText:d,bodyText:s}}(m,c.tableQuery.listViewType,I,w,a,b,O,2===c.tableQuery.type)}Object(ue.b)(y.headerText,y.bodyText,!h,{delayCallbackAfterAnimation:!0,okText:Object(te.b)(be.a)}).then((function(u){return Object(i.__awaiter)(d,void 0,void 0,(function(){var d,l,b,v,m,O,j,p,I;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return u!==ue.a.ok?[3,2]:[4,Oe.b()];case 1:if(i.sent(),t){switch(d=Object(N.a)().UserOptions.ReadReceipt,l="DoNotAutomaticallySend"==d||"NeverSend"==d||Object(me.a)(s),b=Object(r.T)(s)?r.X.inboxPausedDateTime:null,function(e,n,t){var i="TnS_MarkAllAs";i+=n?"Read":"Unread",Object(oe.r)(i,[e,Object(r.l)(t),t.isInCheckedMode])}(e,a,c),f.a.import().then((function(n){n(c.tableQuery,!0,a,e)})),v=[],c.tableQuery.listViewType){case 0:v=Object(ve.a)(n,c.id);break;case 1:v=Object(r.C)(n,c.id)}Object(fe.a)(c,a,v),m=Object(r.j)(c),(O=null===(p=m)||void 0===p?void 0:p.Id)||(O=null===(I=m)||void 0===I?void 0:I.Id),j={id:O,markAsRead:a,clientLastSyncTime:b&&Object(de.ub)(b),itemIdsToExclude:v,suppressReadReceipt:l,mailboxInfo:Object(k.b)(c)},pe.invokeMarkAllAsReadMutation(j)}else switch(c.tableQuery.listViewType){case 0:G(o,c,a,e);break;case 1:J(o,c,a,!0,e)}i.label=2;case 2:return[2]}}))}))}))})),pe={invokeMarkAllAsReadMutation:function(e){var n;return Object(i.__awaiter)(this,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,Object(w.a)()];case 1:return[4,i.sent().mutate({variables:e,mutation:ke})];case 2:return t=i.sent(),[2,null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.markAllAsRead]}}))}))}};var Ie=t(2037),he=Object(o.action)("setAutoMarkAsReadTimer")(Object(o.select)({store:function(){return u}})((function(e,n,t){var i=Object(N.a)().UserOptions;if("Delayed"==i.PreviewMarkAsRead){var a=Object(Ie.a)();if(!a||!Object(r.f)(a))return;t.store.markAsReadTimerTask=setTimeout((function(){we(e,a,n)}),1e3*i.MarkAsReadDelaytime)}}))),ye=Object(o.action)("clearAutoMarkAsReadTimer")(Object(o.select)({store:function(){return u}})((function(e){e.store.markAsReadTimerTask&&(clearTimeout(e.store.markAsReadTimerTask),e.store.markAsReadTimerTask=null)}))),we=Object(o.action)("setMarkAsReadTimer:timeout")((function(e,n,t){ye(),t?L(e,n):1===n.tableQuery.listViewType||Object(D.a)()?L(e,n):V(e,n)})),Re=t(2365),Ne=t(36),Te=Object(Ne.e)(Re.b,"CLONE_ON_ITEM_PART_DESELECTED",(function(e){var n=e.itemId,t=e.tableView;t&&"OnSelectionChange"==Object(N.a)().UserOptions.PreviewMarkAsRead&&L(n,t)})),ge=t(5615),_e=t(2714),Se=(Object(c.orchestrator)(z,(function(e){var n=r.X.tableViews.get(e.tableViewId),t=Object(i.__spread)(n.selectedRowKeys.keys()),a=Object(ge.a)(e.nodeIds,Object(_e.a)(t[0]));T(n,a,e.isReadValueToSet,e.isExplicit,e.actionSource,null)})),t(1774)),Ae=t(5435);Object(c.orchestrator)(Se.p,(function(e){var n=e.tableViewId,t=e.currentSelectedNodeIds,i=e.rowKey;if("OnSelectionChange"==Object(N.a)().UserOptions.PreviewMarkAsRead&&Object(D.a)()&&1===(null==t?void 0:t.length)){var a=r.X.tableViews.get(n);L(Object(Ae.a)(t[0],Object(_e.a)(i)),a)}}));Object(c.orchestrator)(Y,(function(e){var n=e.tableView,t=e.selectedNodeIds,i=e.isInVirtualSelectAllMode,r=e.rowKeysToActOn,a=e.exclusionList,o=e.isReadValueToSet;t.length>0?z(t,n.id,o,!0,"Keyboard"):je("Keyboard",a,i,o,r,n)}));t.d(n,"onReadingPaneClosed",(function(){return U})),t.d(n,"onSingleSelectionChanged",(function(){return K})),t.d(n,"markReadOnTableViewChange",(function(){return B})),t.d(n,"markItemsAsReadBasedOnNodeIds",(function(){return z})),t.d(n,"markItemAsReadFromReadingPane",(function(){return W})),t.d(n,"toggleRowReadState",(function(){return q})),t.d(n,"onNavigateAwayViaUpDown",(function(){return H})),t.d(n,"onKeyboardMarkAsRead",(function(){return Y})),t.d(n,"markAsReadInTable",(function(){return je})),t.d(n,"clearAutoMarkAsReadTimer",(function(){return ye})),t.d(n,"setAutoMarkAsReadTimer",(function(){return he})),t.d(n,"onItemPartDeselectedOrchestrator",(function(){return Te}))},4793:function(e,n,t){"use strict";function i(e){return e?new Date(e).toISOString():null}t.d(n,"a",(function(){return i}))},520:function(e,n,t){"use strict";t.d(n,"b",(function(){return a})),t.d(n,"e",(function(){return o})),t.d(n,"d",(function(){return c})),t.d(n,"c",(function(){return u})),t.d(n,"a",(function(){return d}));var i=t(13),r=new i.b((function(){return Promise.all([t.e(37),t.e(50),t.e(104),t.e(151),t.e(486)]).then(t.bind(null,1266))})),a=new i.a(r,(function(e){return e.createApolloClient})),o=new i.a(r,(function(e){return e.wrapInApolloProvider})),c=new i.a(r,(function(e){return e.unblockBootResolvers})),u=new i.a(r,(function(e){return e.getApolloClient})),d=new i.c(r,(function(e){return e.ApolloProvider}))},5615:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var i=t(0),r=t(2984);function a(e,n){var t,a,o=[];try{for(var c=Object(i.__values)(e),u=c.next();!u.done;u=c.next()){var d=u.value,s=Object(r.a)(d,n);s&&o.push(s.ItemId.Id)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(t)throw t.error}}return o}},612:function(e,n,t){"use strict";t.d(n,"a",(function(){return c})),t.d(n,"b",(function(){return u})),t.d(n,"c",(function(){return d}));var i=t(0),r=t(520),a=null,o=null;function c(){return s(a),a}function u(){return s(o),o}function d(e){var n=e.lazyResolvers,t=e.lazyLocalStateResolvers,c=e.lazyCreateManagedQueryLink,u=e.context;return a=Promise.all([r.b.import(),n,t,c]).then((function(e){var n=Object(i.__read)(e,4),t=n[0],r=n[1],a=n[2],c=n[3];return o=t({resolvers:r,localStateResolvers:a,createManagedQueryLink:c,context:u})}))}function s(e){if(!e)throw new Error("Apollo client has not been initialized yet.")}},6424:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return r}));var i=1e4,r=25},6437:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return c}));var i=t(36),r=new i.c((function(){return t.e(438).then(t.bind(null,10849))})),a=new i.b(r,(function(e){return e.addMarkAsReadDiagnostics})),o=new i.b(r,(function(e){return e.addUnreadCountNotificationDiagnostics})),c=new i.b(r,(function(e){return e.addUnreadCountSubscriptionDiagnostics}))},708:function(e,n,t){"use strict";var i=t(612);t.d(n,"a",(function(){return i.a})),t.d(n,"b",(function(){return i.c}));var r=t(520);t.d(n,"c",(function(){return r.a})),t.d(n,"d",(function(){return r.c})),t.d(n,"e",(function(){return r.d})),t.d(n,"f",(function(){return r.e}))},874:function(e,n,t){"use strict";t.d(n,"b",(function(){return c}));var i=t(36),r=t(966);t.d(n,"a",(function(){return r.a}));var a=new i.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(4),t.e(191),t.e(533)]).then(t.bind(null,1563))})),o=new i.b(a,(function(e){return e.confirmAction}));function c(e,n,t,i){return o.import().then((function(r){return r(e,n,t,i)}))}},895:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var i=t(31),r=t(56);function a(){var e,n=null===(e=Object(i.a)())||void 0===e?void 0:e.pathname;if(n){var t=n.split("/"+Object(r.a)()+"/")[1];if(t){var a=t.split("/")[0];if(a&&!isNaN(parseInt(a)))return!0}}return!1}},9287:function(e,n,t){"use strict";var i,r,a=t(0),o=t(2069),c=t(1632),u=t(217);function d(e){var n,t;return Object(a.__awaiter)(this,void 0,void 0,(function(){var i;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:i=null===(n=c.u.conversations)||void 0===n?void 0:n.get(e),r.label=1;case 1:return!i||null!=i&&i.canLoadMoreForRelationMap?(i&&(i.isLoadMoreInProgress=!0,i.maxItemsToReturn=i.maxItemsToReturn+o.a,i.syncState=""),[4,o.d.importAndExecute({Id:e,mailboxInfo:Object(u.d)()},"CreateConversationRelationMap")]):[3,3];case 2:return r.sent(),i||(i=null===(t=c.u.conversations)||void 0===t?void 0:t.get(e))?[3,1]:[3,3];case 3:return[2]}}))}))}function s(e){var n;return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,o,u,s,l,b,f,m;return Object(a.__generator)(this,(function(O){switch(O.label){case 0:return r==e?[3,2]:(r=e,[4,d(e)]);case 1:if(O.sent(),!(t=null===(n=c.u.conversations)||void 0===n?void 0:n.get(e)))return[2,null];if(o=null==t?void 0:t.conversationNodeIds,u=null==o?void 0:o.length,!o||!u||0==u)return[2,null];for((s=Object(a.__spread)(o)).reverse(),l=c.u.conversationNodes.get(s[0]),b=new Map,l&&b.set(l.internetMessageId,{itemIds:l.itemIds,childrenImIds:[]}),f=1;f<u;)m=c.u.conversationNodes.get(s[f]),v(b,m),f+=1;i=b,O.label=2;case 2:return[2,i]}}))}))}function l(e){var n,t=null===(n=c.u.conversations)||void 0===n?void 0:n.get(e);if(!t)return!1;var i=t.conversationNodeIds,r=null==i?void 0:i.length;return!(!i||!r||0==r)}function b(e,n){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,i;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:return[4,s(e)];case 1:return(t=r.sent())?(i=[],t.forEach((function(e,r){if(0===e.childrenImIds.length){var a=m(n,e.itemIds);a&&i.push(a);for(var o=e;!a&&(null==o?void 0:o.parentImId);)o=t.get(null==o?void 0:o.parentImId),(a=m(n,null==o?void 0:o.itemIds))&&i.push(a)}})),[2,i.reverse()]):[2,[]]}}))}))}function f(e,n,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var i,r,o,u,d,l;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return i=[t],[4,s(n)];case 1:if((r=a.sent())&&(null==(o=c.u.items.get(t))?void 0:o.InternetMessageId))for(u=r.get(o.InternetMessageId),d=null==u?void 0:u.parentImId;d;)(l=r.get(d))?(l.itemIds.forEach((function(n){var t,r=c.u.items.get(n);(!e||r&&(null===(t=r.ParentFolderId)||void 0===t?void 0:t.Id)==e)&&i.push(n)})),d=l.parentImId):d=void 0;return[2,i]}}))}))}function v(e,n){if(n&&e){var t=n.internetMessageId,i=n.parentInternetMessageId;if(i){var r=e.get(i);r&&r.childrenImIds.push(t)}e.set(t,{itemIds:n.itemIds,parentImId:i,childrenImIds:[]})}}function m(e,n){if(n)for(var t=0;t<n.length;t++)if(e.includes(n[t]))return n[t];return null}t.d(n,"c",(function(){return l})),t.d(n,"b",(function(){return b})),t.d(n,"a",(function(){return f}))},966:function(e,n,t){"use strict";var i;t.d(n,"a",(function(){return i})),function(e){e[e.ok=0]="ok",e[e.cancel=1]="cancel",e[e.dismiss=2]="dismiss",e[e.continue=3]="continue"}(i||(i={}))},971:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return o}));var i=t(12),r=t(1);function a(e){return{get:e}}function o(e,n){return Object(r.useMemo)((function(){return Object(i.computed)(e)}),n).get()}}}]);
//# sourceMappingURL=owa.MailBoot~MarkRead.js.map
self.scriptsLoaded['owa.MailBoot~MarkRead.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MarkRead.js'] = (new Date()).getTime();