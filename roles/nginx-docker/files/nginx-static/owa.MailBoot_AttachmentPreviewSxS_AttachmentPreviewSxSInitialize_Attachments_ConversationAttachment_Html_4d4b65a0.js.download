self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AttachmentPreviewSxS~AttachmentPreviewSxSInitialize~Attachments~ConversationAttachment~Html~4d4b65a0.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[70],{1926:function(e,t,n){"use strict";var r=n(0),a=n(7016),o=n(3978),c=n(2464),i={},u=function(){function e(e,t,n){var r=this;this.estimatedTimeToCompleteInMS=e,this.updateIntervalInPercent=t,this.updatePropertyHandler=n,this.start=function(){r.currentTimePercent+=r.updateIntervalInPercent;var e=r.getActionCompletePercent();e<=r.maxPercent?(r.updatePropertyHandler(e),r.nextUpdateTimer=setTimeout(r.start,r.estimatedTimeToCompleteInMS*r.updateIntervalInPercent)):r.nextUpdateTimer=null},this.currentTimePercent=0,this.maxPercent=1-this.updateIntervalInPercent}return e.prototype.complete=function(){var e=this;this.clearUpdateTimer(),this.updatePropertyHandler(1),setTimeout((function(){return e.updatePropertyHandler(1.1)}),500)},e.prototype.abort=function(){this.clearUpdateTimer(),this.updatePropertyHandler(0)},e.prototype.clearUpdateTimer=function(){this.nextUpdateTimer&&(clearTimeout(this.nextUpdateTimer),this.nextUpdateTimer=null)},e.prototype.getActionCompletePercent=function(){return Math.sqrt(2*this.currentTimePercent-this.currentTimePercent*this.currentTimePercent)},e}();function s(e,t){var n=i[e.Id];n&&(t?n.complete():n.abort(),delete i[e.Id])}function d(e,t,n,r){var a=new u(e,t,n);i[r.Id]=a,a.start()}var l=n(5757),f=n(2);Object(f.orchestrator)(a.a,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:a=e.attachment,Object(c.a)(a,7,13),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(l.a)(null,null,e.attachment.attachmentId.Id)];case 2:return t=r.sent(),[3,4];case 3:return r.sent(),[3,4];case 4:return n=t&&"Success"===t.ResponseClass?14:15,function(e,t,n,r,a){s(e,!0),Object(o.a)(n,a),Object(c.a)(n,r,t)}(e.attachment.attachmentId,n,e.attachment,0,7),[2]}var a}))}))}));var h=n(2298),m=n(5220);function v(e){return Object(r.__assign)({__type:"ConvertLocalToRefAttachmentRequest:#Exchange"},e)}var p=n(30);function b(e,t,n,r,a){var o,c,i=function(e,t,n,r,a){return v({ewsAttachmentId:{RootItemChangeKey:t.ChangeKey,RootItemId:t.Id,Id:e},itemId:e,subscriptionId:n,channelId:r,cancellationId:a})}(e,t,n,r,a);return void 0===(o={requestObject:i}).requestObject||o.requestObject.__type||(o.requestObject=v(o.requestObject)),Object(p.a)("ConvertLocalToRefAttachment",o,c)}var O=n(114),j=n(1662),I=n(3813),C=n(702),_=n(151),w={},y=Object(_.action)("convertClassicToCloudy")((function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a=new O.b("AttachmentConvertClassicToCloudy"),function(e){Object(c.a)(e,5,8)}(e),o=function(t){if(S(e,t.ResultCode),T(a,e.attachmentId,t.ResultCode,t.Exception),0===t.ResultCode&&t.Response&&t.Response.ResponseMessages&&t.Response.ResponseMessages.Items&&t.Response.ResponseMessages.Items.length>0&&"NoError"===t.Response.ResponseMessages.Items[0].ResponseCode){var r=t.Response.ResponseMessages.Items[0];n(!0,r.Attachments[0])}else n(!1,null);return!0},i=function(t){S(e,1),n(!1,null),T(a,e.attachmentId,1,t)},[4,g(e.attachmentId,t,o,i)];case 1:return r.sent(),[2]}}))}))}));function g(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,c,i,u,s,d;return Object(r.__generator)(this,(function(l){switch(l.label){case 0:return[4,Object(I.a)(n)];case 1:o=r.__read.apply(void 0,[l.sent(),4]),c=o[0],i=o[1],u=o[2],s=o[3],w[e.Id]=c,l.label=2;case 2:return l.trys.push([2,4,,5]),[4,b(e.Id,t,c,s,c)];case 3:return l.sent(),[3,5];case 4:return d=l.sent(),a(d.message),C.g.importAndExecute(i,u),[3,5];case 5:return[2]}}))}))}function S(e,t){switch(t){case 0:break;case 11:Object(c.a)(e,0,0);break;default:Object(c.a)(e,0,9)}delete w[e.attachmentId.Id]}function T(e,t,n,r){var a=Object(j.a)(t);e.addCosmosOnlyData(JSON.stringify({size:a.model.Size})),e.addCustomData([n]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}var P={name:"CancelConvertClassicToCloudy"},A={name:"CancelConvertCloudyToClassic"};function R(e){return Object(r.__assign)({__type:"CancelConvertLocalToRefAttachmentRequest:#Exchange"},e)}function E(e){var t,n,r=function(e){return R({cancellationId:e})}(e);return void 0===(t=r)||t.__type||(t=R(t)),Object(p.a)("CancelConvertLocalToRefAttachment",t,n)}var x=n(44),D=Object(x.d)("cancelConvertClassicToCloudy",P)((function(e){var t,n=(t=e.attachmentId.Id,w[t]);if(!n)throw new Error("Failed to find the cancellationId of ConvertClassicToCloudy");Object(c.a)(e,5,10),E(n)})),L=n(3450),N=Object(_.action)("setActionCompletePercent")((function(e,t){e.actionCompletePercent=t})),k=n(4478),U=n(3981),q=n(2835),M=n(3982),W=n(1767),B=n(4190),z=n(4149),H=n(6407),V=n(1967),F=Object(_.action)("updateAttachment")((function(e,t,n,a,o){Object(z.a)(e.attachmentId);var i=Object(r.__assign)(Object(r.__assign)({},a.AttachmentId),{mailboxInfo:t.mailboxInfo});if(n.AttachmentId=i,a.Name&&(n.Name=a.Name),a.Size&&(n.Size=a.Size),a.ContentType&&(n.ContentType=a.ContentType),a.__type&&(n.__type=a.__type),n.IsInline&&(n.ContentId=a.ContentId),Object(V.b)(a)){var u=n;u.AttachLongPathName=a.AttachLongPathName,u.PermissionType=a.PermissionType,u.ProviderType=a.ProviderType,u.AttachmentThumbnailUrl=a.AttachmentThumbnailUrl,u.AttachmentPreviewUrl=a.AttachmentPreviewUrl}if(Object(B.a)([{attachmentId:i,attachment:n,permissionInfo:o}],!1),e.attachmentId=i,Object(M.a)(e))Object(U.a)(e,1);else{Object(W.h)(e,!1),setTimeout((function(){N(e,1.1)}),500),Object(c.a)(e,0,0);var s=Object(j.a)(i);Object(q.a)(e,s,!1,e.strategy.supportedMenuActions),s.download.url||Object(H.a)(i,e.isReadOnly,!0)}}));function G(e){return Object(r.__assign)({__type:"ConvertRefToLocalAttachmentRequest:#Exchange"},e)}function J(e,t,n,r,a,o,c,i){var u,s,d=function(e,t,n,r,a,o,c,i){return G({ewsAttachmentId:e,emailId:t,subscriptionId:n,channelId:r,cancellationId:a,fullPathLocation:o,attachmentDataProviderId:i,PermissionLevel:c})}(e,t,n,r,a,o,c,i);return void 0===(u={requestObject:d}).requestObject||u.requestObject.__type||(u.requestObject=G(u.requestObject)),Object(p.a)("ConvertRefToLocalAttachment",u,s)}function $(e){return Z(Object(j.a)(e).model.Size)}function K(e){return 2856+.00145*e}function X(e){return 4*Z(e)}function Q(e){return 4*Z(e)}function Y(e){return 2*Z(e)}function Z(e){return Math.round(e/256)}var ee=n(4479),te={},ne=Object(f.action)("convertCloudyToClassic",(function(e,t,n,r,a,o){return{attachment:e,parentItemId:t,fullPathLocation:n,permissionLevel:r,replaceAttachmentHandler:a,source:o}})),re=ne;function ae(e,t,n,a,o,c){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,u,s,d,l,f;return Object(r.__generator)(this,(function(h){switch(h.label){case 0:return[4,Object(I.a)(o)];case 1:i=r.__read.apply(void 0,[h.sent(),4]),u=i[0],s=i[1],d=i[2],l=i[3],te[e.Id]=u,h.label=2;case 2:return h.trys.push([2,4,,5]),[4,J(e.Id,t,u,l,u,n,a)];case 3:return h.sent(),[3,5];case 4:return f=h.sent(),c(f.message),C.g.importAndExecute(s,d),[3,5];case 5:return[2]}}))}))}function oe(e,t){switch(t){case 0:break;case 11:Object(c.a)(e,0,0);break;default:Object(c.a)(e,0,12)}delete te[e.attachmentId.Id]}function ce(e,t,n,r,a){var o,c=Object(j.a)(t);e.addCosmosOnlyData(JSON.stringify({size:c.model.Size,attachmentId:null===(o=c.model.AttachmentId)||void 0===o?void 0:o.Id})),e.addCustomData([n,a]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}function ie(e){return Object(r.__assign)({__type:"CancelConvertRefToLocalAttachmentRequest:#Exchange"},e)}function ue(e){var t,n,r=function(e){return ie({cancellationId:e})}(e);return void 0===(t=r)||t.__type||(t=ie(t)),Object(p.a)("CancelConvertRefToLocalAttachment",t,n)}Object(f.orchestrator)(ne,(function(e){var t=e.attachment;!function(e,t,n,a,o,i){Object(r.__awaiter)(this,void 0,void 0,(function(){var u,s,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return u=new O.b("AttachmentConvertCloudyToClassic"),function(e){Object(c.a)(e,6,11)}(e),s=function(t){if(oe(e,t.ResultCode),ce(u,e.attachmentId,t.ResultCode,t.Exception,i),0===t.ResultCode){var n=Object(ee.a)({Name:t.Item.Name,Size:t.Item.Size,AttachmentId:t.NewAttachmentId});o(!0,n)}else o(!1,null);return!0},d=function(t){oe(e,1),o(!1,null),ce(u,e.attachmentId,1,t,i)},[4,ae(e.attachmentId,t,n,a,s,d)];case 1:return r.sent(),[2]}}))}))}(t,e.parentItemId,e.fullPathLocation,e.permissionLevel,(function(n,r){n?e.replaceAttachmentHandler(t,r,!1,!0):s(t.attachmentId,n)}),e.source),d($(t.attachmentId),.1,(function(e){N(t,e)}),t.attachmentId)}));var se=Object(f.action)("cancel_ConvertCloudyToClassic",(function(e){return Object(x.c)(A,{attachmentViewState:e})})),de=se;Object(f.orchestrator)(se,(function(e){var t,n=(t=e.attachmentViewState.attachmentId.Id,te[t]);if(!n)throw new Error("Failed to find the cancellationId of ConvertCloudyToClassic");Object(c.a)(e.attachmentViewState,6,10),ue(n)}));var le=n(1709),fe=n(2186),he=n(2352),me=n(2004);function ve(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a=this;return Object(r.__generator)(this,(function(o){switch(o.label){case 0:return[4,me.h.import()];case 1:return t=o.sent(),(n=e.model).ProviderType!==le.a.providers.ONE_DRIVE_PRO?[2]:(t(n.AttachLongPathName,he.a.OneDrivePro,!1).then((function(t){return Object(r.__awaiter)(a,void 0,void 0,(function(){var n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t&&0===t.ResultCode?[2]:(n=Object(fe.b)(e.model,!0),[4,le.g.importAndExecute(n,e.attachmentClass,e.model,!0,e.model.ProviderType,t)]);case 1:return a=r.sent(),le.l.importAndExecute(e.id,a),Object(le.o)(e.id),[2]}}))}))})),[2])}}))}))}var pe=n(33),be=n(1654);function Oe(e,t,n){if(e&&t===le.a.providers.ONE_DRIVE_PRO&&(Object(pe.i)("doc-SxS-jsApi-ODB-Base")||Object(pe.i)("doc-SxS-jsApi-ODB-BaseNoEditString")||Object(pe.i)("doc-SxS-jsApi-ODB-Readonly"))){var r=n&&n.substring(n.lastIndexOf("."));switch(Object(be.f)(r)){case be.a.Word:return Object(pe.i)("doc-SxS-jsApi-ODB-Word");case be.a.Excel:return Object(pe.i)("doc-SxS-jsApi-ODB-Excel");case be.a.PowerPoint:return!Object(pe.i)("doc-SxS-jsApi-ODB-Readonly")&&Object(pe.i)("doc-SxS-jsApi-ODB-PowerPoint")}}return!1}var je=n(4477),Ie=n(1703);function Ce(e,t,n,r,a){return void 0===n&&(n=!1),void 0===r&&(r=0),void 0===a&&(a=!1),{attachmentType:1,attachmentId:e,isInline:!0,isHiddenInline:n,placeholderId:t,status:r,fileType:Ie.a.Inline,skipProcessInlineImage:a}}function _e(e){return!!e.strategy.isSaveToCloudSupported&&-1===e.completedActions.indexOf(2)}var we=n(3980);n.d(t,"a",(function(){return h.a})),n.d(t,"h",(function(){return m.a})),n.d(t,"c",(function(){return D})),n.d(t,"e",(function(){return y})),n.d(t,"u",(function(){return L.a})),n.d(t,"w",(function(){return L.c})),n.d(t,"v",(function(){return L.b})),n.d(t,"D",(function(){return L.d})),n.d(t,"x",(function(){return N})),n.d(t,"y",(function(){return k.a})),n.d(t,"z",(function(){return U.a})),n.d(t,"A",(function(){return c.a})),n.d(t,"E",(function(){return F})),n.d(t,"r",(function(){return q.a})),n.d(t,"o",(function(){return q.b})),n.d(t,"d",(function(){return de})),n.d(t,"f",(function(){return re})),n.d(t,"m",(function(){return ve})),n.d(t,"b",(function(){return Oe})),n.d(t,"B",(function(){return d})),n.d(t,"C",(function(){return s})),n.d(t,"k",(function(){return K})),n.d(t,"l",(function(){return Q})),n.d(t,"q",(function(){return X})),n.d(t,"j",(function(){return Y})),n.d(t,"g",(function(){return je.a})),n.d(t,"i",(function(){return Ce})),n.d(t,"p",(function(){return $})),n.d(t,"t",(function(){return _e})),n.d(t,"s",(function(){return M.a})),n.d(t,"n",(function(){return we.a}))},2298:function(e,t,n){"use strict";var r;!function(e){e[e.ChangePermissions=0]="ChangePermissions",e[e.CopyLink=1]="CopyLink",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab",e[e.Preview=4]="Preview",e[e.SaveToCloud=5]="SaveToCloud",e[e.ViewInProvider=6]="ViewInProvider",e[e.ConvertClassicToCloudy=7]="ConvertClassicToCloudy",e[e.ConvertCloudyToClassic=8]="ConvertCloudyToClassic",e[e.ImportCalendarEventAttachment=9]="ImportCalendarEventAttachment",e[e.MoveAttachmentToInline=10]="MoveAttachmentToInline",e[e.RefreshLink=11]="RefreshLink",e[e.IgnoreExpiration=12]="IgnoreExpiration"}(r||(r={})),t.a=r},2352:function(e,t,n){"use strict";n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return i})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return l}));var r=n(36),a=n(2750);n.d(t,"a",(function(){return a.a}));var o=new r.c((function(){return Promise.all([n.e(31),n.e(69),n.e(567)]).then(n.bind(null,5728))})),c=new r.b(o,(function(e){return e.createGetSharingInfoResponse})),i=new r.b(o,(function(e){return e.checkSharingLinkUrlDomain})),u=new r.b(o,(function(e){return e.getLinkProviderType})),s=new r.b(o,(function(e){return e.isOneDriveProRelatedLink})),d=new r.b(o,(function(e){return e.convertToAttachmentDataProviderType})),l=new r.b(o,(function(e){return e.convertToLinkProviderType}))},2750:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.OneDrivePro=0]="OneDrivePro",e[e.OneDriveConsumer=1]="OneDriveConsumer",e[e.Dropbox=2]="Dropbox",e[e.Box=3]="Box",e[e.GDrive=5]="GDrive",e[e.OfficeOneDrivePro=31]="OfficeOneDrivePro"}(r||(r={}))},3118:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(1654);function a(e){var t="";return(null==e?void 0:e.model)&&(t=Object(r.c)(e.model.Name||"")||e.model.ContentType||""),t}function o(e){var t;return(null===(t=a(e))||void 0===t?void 0:t.substring(0,4))||""}},3420:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),a=n(114),o=n(2564),c=n(2961),i=n(23);function u(e,t,n,u,s){return Object(r.__awaiter)(this,void 0,void 0,(function(){var d,l,f,h,m,v,p,b,O,j,I,C,_,w;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:d=new a.b("getWacInfoForOneDriveJsApi",{isCore:!0}),u&&d.addCustomData({redeemSharingLinkIfNecessary:u}),r.label=1;case 1:return r.trys.push([1,3,,4]),l=btoa(t),f="u!"+l.replace(/^\=+|\=+$/g,"").replace("/","_").replace("+","-"),h=new RegExp(/.+?\:\/\/.+?(\/)/g).exec(t)[0],m=h+"_api/v2.0/shares/"+f+"/root?select=openWith/wac,officeBundle,@content.downloadUrl,name,size,currentUserRole&action="+(n?"Open":"View"),v=new Object,u&&(v.prefer="redeemSharingLinkIfNecessary"),p=Object(o.a)({ProviderType:e,Url:m,Headers:JSON.stringify(v)}),b=(new Date).getTime(),[4,Object(c.a)(p)];case 2:if(200===(O=r.sent()).Status&&O.Body)return j=(new Date).getTime(),(I=JSON.parse(O.Body)).fetchStartTime=b,I.responseStartTime=j,!I.openWith.wac&&s||(I.openWith.wac.fileGetUrl=I["@content.downloadUrl"],I.openWith.wac.accessTokenExpiry&&(I.openWith.wac.accessTokenExpiry=new Date(Number(I.openWith.wac.accessTokenExpiry))),!n&&I.currentUserRole&&(I.currentUserRole.readOnly=!0)),d.end(),[2,I];throw d.addCustomData({StatusCode:O.Status}),(C=O.Headers)&&(_=JSON.parse(C))&&d.addCustomData({SharePointError:_.SharePointError,SPClientServiceRequestDuration:_.SPClientServiceRequestDuration,SPRequestGuid:_.SPRequestGuid}),new Error("Result status is: "+O.Status+" or empty response body.");case 3:return w=r.sent(),d.endWithError("ServerError",w),i.g.warn("Something went wrong while calling fetchDataProviderResourceOperation: "+w),[3,4];case 4:return[2,null]}}))}))}},3603:function(e,t,n){"use strict";function r(e,t){t&&e&&(e.addCustomData({httpStatusCode:t.status}),function(e,t){t&&e&&e.addCustomData({frontendServer:t.get("x-feserver"),requestId:t.get("request-id"),backendServer:t.get("x-beserver"),backendHttpStatus:t.get("x-backendhttpstatus"),serverVersion:t.get("x-owa-version")})}(e,t.headers))}function a(e){return e&&void 0!==e.fetchErrorType}function o(e,t){e.addCustomProperty("ErrorInformation",t)}function c(e,t){o(e,t?"Empty response from server":"Null response from server")}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return c}))},3981:function(e,t,n){"use strict";var r=n(151);t.a=Object(r.action)("setInlineAttachmentStatus")((function(e,t){e.status=t}))},3982:function(e,t,n){"use strict";function r(e){return 1===e.attachmentType}n.d(t,"a",(function(){return r}))},4149:function(e,t,n){"use strict";var r=n(1809),a=n(151);t.a=Object(a.action)("deleteAttachment")((function(e){Object(r.a)().attachments.delete(e.Id)}))},4448:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(30);function a(e,t){return Object(r.a)("GetWacAttachmentInfo",e,t)}},4477:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),a=n(1767),o=n(1703);function c(e,t,n,c,i,u,s){void 0===i&&(i=o.a.Unknown),void 0===u&&(u=!1),void 0===s&&(s=null);var d=Object(a.d)(e,t,c,u,i,s),l=d.strategy;return Object(r.__assign)(Object(r.__assign)({},d),{attachmentType:0,strategy:Object(r.__assign)(Object(r.__assign)({},l),{isSaveToCloudSupported:!1,isViewingInProviderSupported:!1,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]}),shouldShowContextMenu:!1,shouldShowImageOverlay:!1,shouldShowActionsContainer:!1,ongoingAction:n?0:1,completedActions:[],actionMessage:0,actionCompletePercent:n?1.1:.01})}},4478:function(e,t,n){"use strict";var r=n(151);t.a=Object(r.action)("setAttachmentShouldShowContextMenu")((function(e,t){e.shouldShowContextMenu=t}))},4479:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"FileAttachment:#Exchange"},e)}},4785:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(0),a=n(114),o=n(3603),c=n(4786),i=n(347),u={},s={},d=[],l=0,f=2;function h(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,i;return Object(r.__generator)(this,(function(u){return c=new a.b("InitializeWacUrl"),n&&c.addCustomProperty("actionSource",n),(i=v(e,t,c))?[2,i]:[2,new Promise((function(a,i){var u={attachmentId:e,isEdit:t,actionSource:n,datapoint:c,resolve:a,reject:i};o?m(u):(d.push(u),function e(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:if(!d.length)return[2];if(l>=f)return[2];t=d.shift(),l++,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,m(t)];case 2:return n.sent(),[3,4];case 3:return l--,e(),[7];case 4:return[2]}}))}))}())}))]}))}))}function m(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,d,l,f,h,m,p,b;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(n=e.attachmentId,a=e.isEdit,d=e.actionSource,l=e.datapoint,f=e.resolve,h=e.reject,m=v(n,a,l))return f(m),[2];l.addCustomProperty("ReturnFromCache",!1),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(c.a)(n.Id,a,null,Object(i.a)(n.mailboxInfo),d)];case 2:return 0===(p=r.sent()).Status&&((a?s:u)[n.Id]={expireTime:(new Date).getTime()+36e5,value:p}),p.WacUrl||l.addCustomProperty("WacUrlIsEmpty",!0),l.addCustomProperty("WacAttachmentResponseStatus",null===(t=p.Status)||void 0===t?void 0:t.toString()),l.end(),f(p),[3,4];case 3:return b=r.sent(),Object(o.a)(b)&&Object(o.c)(l,b.response),Object(o.d)(l,b.toString()),l.endWithError("ServerError"),h(b),[3,4];case 4:return[2]}}))}))}function v(e,t,n){var r=t?s:u,a=r[e.Id];if(a){if(a.expireTime>=(new Date).getTime())return n.addCustomProperty("ReturnFromCache",!0),n.end(),a.value;delete r[e.Id]}return null}},4786:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4448);function a(e,t,n,a,o){if(o){var c="getWacAttachmentInfo"+o;(a=a||{}).headers=a.headers||new Headers,a.headers.set("X-OWA-ActionName",c)}return Object(r.a)({attachmentId:e,isEdit:t,draftId:n,appId:null},a)}},5220:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(2835),a=n(7017),o=n(7018),c=n(4477),i=n(1703),u=n(1926),s=n(4190),d=n(1662);function l(e,t,n,l,f,h,m,v,p){void 0===m&&(m=null),void 0===p&&(p=!1),Object(s.a)([{attachmentId:e,attachment:t}],n,f);var b=Object(d.a)(e),O=Object(c.a)(e,n,l,1===b.type,i.a.Unknown,!1,m);if(Object(r.a)(O,b,!1,v,h),p){var j=b.model.ProviderType;Object(u.b)(O.isCloudy,j,b.model.Name)?Object(o.a)(b,O):Object(a.a)(O)}return O}},5757:function(e,t,n){"use strict";var r=n(0),a=n(554),o=n(30);function c(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"ImportCalendarEventJsonRequest:#Exchange"},n)),Object(o.a)("ImportCalendarEvent",e,t)}var i=n(790),u=n(161),s=n(347);function d(e,t,n,o){var d,l;return o&&(d=Object(s.a)(o)),c({Header:Object(u.b)(),Body:(l={Content:e,ImportedItemFolderId:Object(i.a)({BaseFolderId:Object(a.a)({Id:t})}),AttachmentId:n},Object(r.__assign)({__type:"ImportCalendarEventRequest:#Exchange"},l))},Object(r.__assign)({datapoint:{jsonCustomData:function(e){return{status:e.ResponseClass,numberOfEventsImported:e.NumberOfEventsImported}}}},d)).then((function(e){if(null!=e&&null!=e.Body)return e.Body;throw new Error("[importCalendarOperation failed]")}))}n.d(t,"a",(function(){return d}))},6402:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2038),a=n(2011);function o(e){e.previewMethod===a.a.Wac&&(e.previewMethod=a.a.Unsupported,e.supportedOpenActions=e.supportedOpenActions.filter((function(e){return e!==r.a.Preview})))}},7016:function(e,t,n){"use strict";var r=n(2),a=n(44),o=Object(r.action)("addCalendarEventsAttachment",(function(e,t){return Object(a.c)({name:"AttachmentAddCalendarEvent",customData:{addToCalendarSource:t}},{attachment:e})}));t.a=o},7017:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),a=n(6402),o=n(2011),c=n(4785);function i(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return e.strategy.previewMethod!==o.a.Wac?[3,2]:[4,Object(c.a)(e.attachmentId,!1)];case 1:9!==(t=n.sent()).Status&&6!==t.Status||Object(a.a)(e.strategy),n.label=2;case 2:return[2]}}))}))}},7018:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),a=n(6402),o=n(6403),c=n(3420),i=n(33);function u(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,u,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=e,Object(i.i)("doc-unwrap-safelinks")?[4,Object(o.a)(e.model)]:[3,2];case 1:return s=r.sent(),[3,3];case 2:s=n.openUrl,r.label=3;case 3:return u=s,[4,Object(c.a)(0,u,!1,!1,!0)];case 4:return r.sent()||Object(a.a)(t.strategy),[2]}}))}))}}}]);
//# sourceMappingURL=owa.MailBoot~AttachmentPreviewSxS~AttachmentPreviewSxSInitialize~Attachments~ConversationAttachment~Html~4d4b65a0.js.map
self.scriptsLoaded['owa.MailBoot~AttachmentPreviewSxS~AttachmentPreviewSxSInitialize~Attachments~ConversationAttachment~Html~4d4b65a0.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AttachmentPreviewSxS~AttachmentPreviewSxSInitialize~Attachments~ConversationAttachment~Html~4d4b65a0.js'] = (new Date()).getTime();