self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AttachmentPreviewSxSInitialize.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[493],{11147:function(n,e,t){"use strict";t.r(e);var r=t(0),i=t(2),u=t(3601),o=t(2393),c=t(4782),a=t(8270),s=t(5218),f=t(5219),d=t(5599),l=t(8271),h=t(1654);Object(i.orchestrator)(u.b,(function(n){var e=n.element,t=n.href,i=n.itemId,b=n.isSafeLinkWrapped,p=n.isSafeLinkVerified,v=n.isOfficeSPLink;Object(u.j)(t);var O=function(n){!function(n,e,t,i,u,c,a){var b=this,p=null;if(!(n.altKey||n.ctrlKey||n.metaKey||n.shiftKey)){var v=Object(f.b)(t),O=v.docLinkPreviewInfo,m=v.reason,I=null==O?void 0:O.wacUrlInfo.jsApiInfo.fileName,w=Object(h.b)(I);if((null==O?void 0:O.needRedeem)||"Expired"===m)return Object(o.a)((function(){return Object(r.__awaiter)(b,void 0,void 0,(function(){var n,e;return Object(r.__generator)(this,(function(o){switch(o.label){case 0:return[4,Object(s.a)(t,!0,!0)];case 1:return n=o.sent(),e=(null==O?void 0:O.needRedeem)?"redeem":"retryAfterCacheExpire",Object(d.a)(null,i,u,e,c,null,w),[2,Object(r.__assign)(Object(r.__assign)({},n.wacUrlInfo),{extraInfo:e})]}}))}))}),e,a),void n.preventDefault();if(O)return Object(o.a)((function(){return Promise.resolve(O.wacUrlInfo)}),e,a),n.preventDefault(),void Object(d.a)(null,i,u,null,c,null,w);p=m}Object(l.a)(n,i,u,p)}(n,i,t,b,p,v,e.ownerDocument.defaultView)};e.addEventListener("click",O),e[c.a]=O;var m=function(n){Object(a.a)(n,b,p)};e.addEventListener("mouseup",m),e[c.b]=m}));t(8432);var b=t(2523),p=t(6471);Object(i.orchestrator)(b.i,(function(n){var e=n.itemAttachmentId,t=n.perfDatapoint;p.a.importAndExecute(e,t)}));var v=t(4272);Object(i.orchestrator)(v.a,(function(n){var e=n.context;b.e.importAndExecute(e)}));var O=t(3162),m=t(1713);Object(i.orchestrator)(O.l,(function(n){var e=n.wacUrlGetter,t=n.linkId,r=n.readOnly,i=n.targetWindow;b.h.importAndExecute(e,null,b.a.ComposeDocLink,{method:b.b.CopyMailReadingPaneContainer},null,t,r,i)})),Object(i.orchestrator)(m.L,(function(n){var e=n.selectedLinkId,t=n.isSelectedLinkReadOnly;Object(O.k)(e,t)}));var I=t(3107);Object(i.orchestrator)(I.f,(function(n){var e=n.wacUrlGetter,t=n.itemId,r=n.targetWindow;b.h.importAndExecute(e,t,b.a.ReadingPaneDocLink,{method:b.b.CopyMailReadingPaneContainer},null,null,null,r)}))},157:function(n,e,t){"use strict";function r(){var n=Object.create(null),e=0,t=0,r=0,i=!1;function u(e){r--,delete n[e]}this.put=function(e,t,i,o){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==o&&"function"!=typeof o)throw new Error("Cache timeout callback must be a function");var c=n[e];c?clearTimeout(c.timeout):r++;var a={value:t,expire:i+Date.now()};return isNaN(a.expire)||(a.timeout=setTimeout(function(){u(e),o&&o(e,t)}.bind(this),i)),n[e]=a,t},this.del=function(e){var t=!0,r=n[e];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(t=!1)):t=!1,t&&u(e),t},this.clear=function(){for(var u in n)clearTimeout(n[u].timeout);r=0,n=Object.create(null),i&&(e=0,t=0)},this.get=function(u){var o=n[u];if(void 0!==o){if(isNaN(o.expire)||o.expire>=Date.now())return i&&e++,o.value;i&&t++,r--,delete n[u]}else i&&t++;return null},this.size=function(){return r},this.memsize=function(){var e,t=0;for(e in n)t++;return t},this.debug=function(n){i=n},this.hits=function(){return e},this.misses=function(){return t},this.keys=function(){return Object.keys(n)},this.exportJson=function(){var e={};for(var t in n){var r=n[t];e[t]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(e)},this.importJson=function(e,t){var r=JSON.parse(e),i=Date.now(),u=t&&t.skipDuplicates;for(var o in r)if(r.hasOwnProperty(o)){if(u)if(n[o])continue;var c=r[o],a=c.expire-i;if(a<=0){this.del(o);continue}a=a>0?a:void 0,this.put(o,c.value,a)}return this.size()}}n.exports=new r,n.exports.Cache=r},1635:function(n,e,t){"use strict";function r(n){if(!n)return null;var e=n.lastIndexOf(".");return e>0?n.substr(e).toLowerCase():null}function i(n){var e=r(n);return e?e.replace(".",""):null}function u(n){var e;return(null===(e=i(n))||void 0===e?void 0:e.substring(0,4))||""}t.d(e,"a",(function(){return r})),t.d(e,"b",(function(){return i})),t.d(e,"c",(function(){return u}))},1662:function(n,e,t){"use strict";t.d(e,"a",(function(){return i}));var r=t(1809);function i(n){return Object(r.a)().attachments.get(n.Id)}},1692:function(n,e,t){"use strict";t.d(e,"a",(function(){return i})),t.d(e,"g",(function(){return u})),t.d(e,"d",(function(){return o})),t.d(e,"c",(function(){return c})),t.d(e,"f",(function(){return a})),t.d(e,"b",(function(){return s})),t.d(e,"e",(function(){return f}));var r=t(2),i=Object(r.action)("ADD_SHARING_LINK",(function(n,e,t,r,i,u,o,c){return{linkId:n,url:e,sharingLinkIds:t,response:r,source:i,providerType:u,unwrappedUrl:o,creationDateTime:c}})),u=Object(r.action)("SHARING_LINK_REMOVED",(function(n,e){return{linkId:n,sharingLinkIds:e}})),o=Object(r.action)("DELETE_LINK",(function(n,e){return{linkId:n,targetWindow:e}})),c=Object(r.action)("CREATE_ATTACHMENT_FROM_LINK",(function(n,e,t,r){return{linkId:n,providerId:e,isTryAgain:t,targetWindow:r}})),a=Object(r.action)("ON_LINK_HAS_CHANGED",(function(n,e,t,r){return{linkId:n,recipientInfos:e,composeId:t,isCalendar:r}})),s=Object(r.action)("ADD_SHARING_LINK_TO_CONTAINER",(function(n,e){return{linkId:n,linkIdContainer:e}})),f=Object(r.action)("ON_FLUID_LINK_CREATED",(function(n,e,t,r){return{linkId:n,containerId:e,owaSource:t,url:r}}))},1714:function(n,e,t){"use strict";t.d(e,"e",(function(){return i})),t.d(e,"f",(function(){return u})),t.d(e,"g",(function(){return o})),t.d(e,"c",(function(){return c})),t.d(e,"b",(function(){return a})),t.d(e,"a",(function(){return s})),t.d(e,"d",(function(){return f}));var r=t(2),i=Object(r.action)("UPDATE_SHARING_LINK_FROM_SHARING_DIALOG",(function(n,e){return{linkId:n,sharingDialogResponse:e}})),u=Object(r.action)("UPDATE_SHAREPOINT_LINK_PERMISSION",(function(n,e){return{linkId:n,newPermission:e}})),o=Object(r.action)("UPDATE_SHAREPOINT_LINK_URL",(function(n,e,t,r){return{linkId:n,newLinkUrl:e,oldLinkUrl:t,expirationDate:r}})),c=Object(r.action)("SET_REFRESH_STATUS_FOR_LINK",(function(n,e){return{linkId:n,actionStatus:e}})),a=Object(r.action)("CREATE_OR_UPDATE_SHARING_LINK",(function(n,e,t,r,i,u,o,c,a){return{linkId:n,sharingUrl:e,currentUrl:t,canonicalUrl:r,newPermissionLevel:i,providerType:u,composeId:o,recipientInfos:c,isCalendar:a}})),s=Object(r.action)("ADD_SHARING_LINK_INFO",(function(n,e){return{linkId:n,linkModel:e}})),f=Object(r.action)("TOKEN_UNAVAILABLE",(function(n){return{linkId:n}}))},1721:function(n,e,t){"use strict";t.d(e,"a",(function(){return ReactEditor})),t.d(e,"d",(function(){return u})),t.d(e,"c",(function(){return o})),t.d(e,"b",(function(){return a}));var r=t(36),i=new r.c((function(){return Promise.all([t.e(21),t.e(22),t.e(24),t.e(34),t.e(38),t.e(39),t.e(605)]).then(t.bind(null,2592))})),ReactEditor=Object(r.d)(i,(function(n){return n.ReactEditor})),u=new r.b(i,(function(n){return n.setTableHeaderRow})),o=new r.b(i,(function(n){return n.operateContent})),c=new r.b(i,(function(n){return n.focusToEditor}));function a(n){c.import().then((function(e){return e(n)}))}},1747:function(n,e,t){"use strict";t.d(e,"a",(function(){return i}));var r=t(0);function i(n){return Object(r.__assign)({__type:"IndexedPageView:#Exchange"},n)}},1752:function(n,e,t){"use strict";t.d(e,"a",(function(){return u}));var r=t(2124),i=t(1798);function u(n){var e=Object(r.a)(),t=Object(i.b)(n);return e.sharingLinks.get(t)}},1754:function(n,e,t){"use strict";var r,i=t(36),u=t(1692),o=t(1714),c=t(2156);!function(n){n.PasteHtml="PasteHtml",n.InsertLinkFromToolbar="InsertLinkFromToolbar",n.InsertLinkFromAttachMenu="InsertLinkFromAttachMenu",n.AutoLink="AutoLink",n.ReplyOrForward="ReplyOrForward",n.LinkContextMenu="LinkContextMenu",n.Undo="Undo",n.EditorLoadedOrDraftOrReply="EditorLoadedOrDraftOrReply",n.RestoreCursor="RestoreCursor",n.ShareLinkCompose="ShareLinkCompose",n.NewFluidFile="NewFluidFile",n.Unknown="Unknown"}(r||(r={}));var a=t(2028),s=t(1798),f=t(1752),d=[r.PasteHtml,r.InsertLinkFromToolbar,r.AutoLink,r.ShareLinkCompose,r.InsertLinkFromAttachMenu];function l(n){var e=Object(f.a)(n);return e&&-1!==d.indexOf(e.source)}var h=t(2061);function b(n){var e=Object(f.a)(n);return e?{id:e.linkId,name:e.fileName,supportsDownsell:!1,currentPermissionLevel:e.permissionLevel,sharingInfo:e.sharingInfo,sharingTipsIgnored:e.sharingTipsIgnored,sharingRecipientsInfo:e.sharingRecipientsInfo,typeOfLink:l(n)?"newLink":"oldLink"}:null}var p=t(2124);function v(){return Object(p.a)().sharingLinks.size}var O=t(2157);t.d(e,"q",(function(){return I})),t.d(e,"u",(function(){return w})),t.d(e,"y",(function(){return g})),t.d(e,"w",(function(){return k})),t.d(e,"v",(function(){return S})),t.d(e,"t",(function(){return L})),t.d(e,"x",(function(){return j})),t.d(e,"s",(function(){return T})),t.d(e,"r",(function(){return _})),t.d(e,"B",(function(){return m})),t.d(e,"c",(function(){return u.a})),t.d(e,"d",(function(){return u.b})),t.d(e,"e",(function(){return u.c})),t.d(e,"g",(function(){return u.d})),t.d(e,"E",(function(){return u.g})),t.d(e,"z",(function(){return u.e})),t.d(e,"A",(function(){return u.f})),t.d(e,"F",(function(){return o.e})),t.d(e,"G",(function(){return o.f})),t.d(e,"H",(function(){return o.g})),t.d(e,"D",(function(){return o.c})),t.d(e,"f",(function(){return o.b})),t.d(e,"C",(function(){return c.b})),t.d(e,"a",(function(){return r})),t.d(e,"n",(function(){return a.a})),t.d(e,"h",(function(){return s.a})),t.d(e,"i",(function(){return s.b})),t.d(e,"p",(function(){return s.c})),t.d(e,"o",(function(){return l})),t.d(e,"b",(function(){return h.a})),t.d(e,"l",(function(){return f.a})),t.d(e,"k",(function(){return b})),t.d(e,"j",(function(){return v})),t.d(e,"m",(function(){return O.a}));var m=new i.c((function(){return Promise.all([t.e(3),t.e(31),t.e(69),t.e(631)]).then(t.bind(null,17207))})),I=new i.b(m,(function(n){return n.addRecipientsIntoLink})),w=new i.b(m,(function(n){return n.removeRecipientsFromLink})),g=new i.b(m,(function(n){return n.updateRecipientPermissionInfos})),k=new i.b(m,(function(n){return n.setGetPermissionInfoFailure})),S=new i.b(m,(function(n){return n.resetSharingRecipientsInfo})),L=new i.b(m,(function(n){return n.ignoreSharingTip})),j=new i.b(m,(function(n){return n.setLinkActionStatus})),T=new i.b(m,(function(n){return n.getSharingTipRecipientInfo})),_=new i.b(m,(function(n){return n.createCloudFileFromSharingLink}))},1781:function(n,e,t){"use strict";var r;function i(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}t.d(e,"a",(function(){return r})),t.d(e,"b",(function(){return i})),function(n){n.noPermissionToShare="WarningNoPermissionToShare",n.getSharingInfoFailed="WarningGetSharingInfoFailed",n.linkHasExpired="WarningLinksHasExpired",n.linkWillExpire="WarningLinksWillExpire",n.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",n.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",n.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",n.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},1798:function(n,e,t){"use strict";t.d(e,"b",(function(){return u})),t.d(e,"c",(function(){return o})),t.d(e,"a",(function(){return c}));var r=t(33),i="_ODSPPSL";function u(n){return Object(r.i)("doc-link-savePermission")&&n&&-1!==n.indexOf(i)?n.substring(0,n.length-i.length):n}function o(n){return!!Object(r.i)("doc-link-savePermission")&&n.lastIndexOf(i)===n.length-i.length}function c(n,e){return!Object(r.i)("doc-link-savePermission")||2!==e&&1!==e?n:n+i}},1916:function(n,e,t){"use strict";var r;t.d(e,"a",(function(){return r})),function(n){n[n.InProgress=0]="InProgress",n[n.Failed=1]="Failed",n[n.Succeeded=2]="Succeeded"}(r||(r={}))},1937:function(n,e,t){"use strict";t.d(e,"a",(function(){return i}));var r=t(2),i=Object(r.action)("REFRESH_EXPIRATION_DATE",(function(n){return{id:n}}))},1938:function(n,e,t){"use strict";var r;t.d(e,"a",(function(){return r})),function(n){n[n.ignore=0]="ignore",n[n.refreshExpiration=1]="refreshExpiration",n[n.changePermission=2]="changePermission",n[n.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},1967:function(n,e,t){"use strict";t.d(e,"a",(function(){return i})),t.d(e,"b",(function(){return u}));var r=t(1848);function i(n){return o(n.type)}function u(n){return o(Object(r.a)(n))}function o(n){return 1===n||3===n}},2004:function(n,e,t){"use strict";t.d(e,"h",(function(){return s})),t.d(e,"i",(function(){return f})),t.d(e,"f",(function(){return d})),t.d(e,"k",(function(){return l})),t.d(e,"m",(function(){return h})),t.d(e,"e",(function(){return b})),t.d(e,"g",(function(){return p})),t.d(e,"j",(function(){return v})),t.d(e,"l",(function(){return O}));var r=t(36),i=t(1937);t.d(e,"n",(function(){return i.a}));var u=t(1916);t.d(e,"a",(function(){return u.a}));var o=t(1781);t.d(e,"d",(function(){return o.b})),t.d(e,"c",(function(){return o.a}));var c=t(1938);t.d(e,"b",(function(){return c.a}));var a=new r.c((function(){return Promise.all([t.e(3),t.e(31),t.e(69),t.e(745)]).then(t.bind(null,3081))})),s=new r.b(a,(function(n){return n.getSharingInformation})),f=new r.b(a,(function(n){return n.getSharingIssuesForSharingData})),d=new r.b(a,(function(n){return n.getInfoBarCreator})),l=new r.b(a,(function(n){return n.hasLargeDLRecipient})),h=new r.b(a,(function(n){return n.hasRecipientExpansionFailure})),b=new r.b(a,(function(n){return n.getGroupsAndSmallDLs})),p=new r.b(a,(function(n){return n.getInvididualRecipients})),v=new r.b(a,(function(n){return n.hasGetRecipientPermissionFailed})),O=new r.b(a,(function(n){return n.logSharingTipChangesForLinkRemoval}))},2028:function(n,e,t){"use strict";t.d(e,"a",(function(){return u}));var r=t(1635),i=t(33);function u(n){var e=(Object(r.a)(n)||"").toLowerCase();return!!n&&(Object(i.i)("cmp-prague")&&(".fluid"===e||".note"===e))}},2061:function(n,e,t){"use strict";var r;t.d(e,"a",(function(){return r})),function(n){n[n.none=0]="none",n[n.refreshing=1]="refreshing",n[n.refreshFailed=2]="refreshFailed",n[n.refreshSucceeded=3]="refreshSucceeded",n[n.attachingAsACopy=4]="attachingAsACopy",n[n.pendingAttachAsACopy=5]="pendingAttachAsACopy"}(r||(r={}))},2062:function(n,e,t){"use strict";t.d(e,"a",(function(){return u})),t.d(e,"c",(function(){return o})),t.d(e,"e",(function(){return c})),t.d(e,"f",(function(){return a})),t.d(e,"d",(function(){return s})),t.d(e,"b",(function(){return f}));var r=t(36),i=new r.c((function(){return t.e(921).then(t.bind(null,2908))})),u=new r.b(i,(function(n){return n.extractFileUrlFromOfficeSharePointLink})),o=new r.b(i,(function(n){return n.isLinkPrefixedWithBaseUrl})),c=new r.b(i,(function(n){return n.isSharePointLink})),a=new r.b(i,(function(n){return n.isSharePointServiceGeneratedLink})),s=new r.b(i,(function(n){return n.isOfficeSharePointLink})),f=new r.b(i,(function(n){return n.getParsedQueryStringFromUrl}))},2124:function(n,e,t){"use strict";var r=t(12),i=t(2),u={sharingLinks:new r.ObservableMap({})},o=Object(i.createStore)("sharingLinkStore",u);e.a=o},2156:function(n,e,t){"use strict";function r(n){return void 0!==n.recipients}function i(n){return void 0!==n.length}t.d(e,"b",(function(){return r})),t.d(e,"a",(function(){return i}))},2157:function(n,e,t){"use strict";t.d(e,"a",(function(){return c}));var r=t(0),i=t(2062),u=t(62),o=t(251);function c(n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,i.b.import()];case 1:return e=t.sent(),[2,a(e(n))]}}))}))}function a(n){if(!Object(u.b)(null==n?void 0:n.nav)){var e={nav:n.nav};return Object(o.stringify)(e)}return null}},218:function(n,e,t){"use strict";var r=t(688);t.d(e,"a",(function(){return r.a}))},2308:function(n,e,t){"use strict";var r;t.d(e,"a",(function(){return r})),function(n){n[n.NoOp=0]="NoOp",n[n.AlwaysHidden=1]="AlwaysHidden",n[n.CopyMailReadingPaneContainer=2]="CopyMailReadingPaneContainer",n[n.LoadConversationReadingPane=3]="LoadConversationReadingPane",n[n.LoadItemReadingPane=4]="LoadItemReadingPane"}(r||(r={}))},2354:function(n,e,t){"use strict";var r=null,i={register:function(n){r=n},available:function(){return!!r},run:function(n,e){r&&r(n,e)}};e.a=i},2416:function(n,e,t){"use strict";t.d(e,"a",(function(){return i}));var r=t(2),i=Object(r.action)("loadItemAttachment",(function(n,e){return{itemAttachmentId:n,perfDatapoint:e}}))},2523:function(n,e,t){"use strict";t.d(e,"e",(function(){return s})),t.d(e,"f",(function(){return f})),t.d(e,"g",(function(){return d})),t.d(e,"h",(function(){return l})),t.d(e,"d",(function(){return h}));var r=t(36),i=t(1713);t.d(e,"a",(function(){return i.b}));var u=t(2354);t.d(e,"c",(function(){return u.a}));var o=t(2308);t.d(e,"b",(function(){return o.a}));var c=t(2416);t.d(e,"i",(function(){return c.a}));var a=new r.c((function(){return Promise.all([t.e(3),t.e(31),t.e(64),t.e(65),t.e(70),t.e(152),t.e(211),t.e(492)]).then(t.bind(null,4526))})),s=new r.a(a,(function(n){return n.previewAttachment})),f=new r.a(a,(function(n){return n.previewAttachmentInSxS})),d=new r.a(a,(function(n){return n.previewImageInSxS})),l=new r.a(a,(function(n){return n.previewLinkInSxS})),h=new r.a(a,(function(n){return n.initializeItemReadingPaneInSxS}))},339:function(n,e,t){"use strict";t.d(e,"b",(function(){return u})),t.d(e,"a",(function(){return o}));var r,i=t(0);function u(n){r=n}function o(){var n,e;return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,u;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(u=r)?[4,r()]:[3,2];case 1:u=i.sent(),i.label=2;case 2:if((t=u)&&t.length>0){if("bearer"===(null===(n=null==t?void 0:t.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return[2,t.split(" ")[1]];if("msauth1.0"===(null===(e=null==t?void 0:t.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,t]}return[2,void 0]}}))}))}},347:function(n,e,t){"use strict";var r=t(0);function i(n,e){return n?Object(r.__assign)({mailboxInfo:n},e):null!=e?e:void 0}t.d(e,"a",(function(){return i}))},3601:function(n,e,t){"use strict";t.d(e,"j",(function(){return i})),t.d(e,"i",(function(){return u})),t.d(e,"g",(function(){return o})),t.d(e,"c",(function(){return c})),t.d(e,"f",(function(){return a})),t.d(e,"d",(function(){return s})),t.d(e,"h",(function(){return f})),t.d(e,"e",(function(){return d})),t.d(e,"a",(function(){return l})),t.d(e,"b",(function(){return h}));var r=t(2),i=Object(r.action)("tryQueueGetWacInfo",(function(n){return{url:n}})),u=Object(r.action)("queueGetWacInfo",(function(n){return{url:n}})),o=Object(r.action)("processGetWacInfoQueue"),c=Object(r.action)("getWacInfoQueueShift"),a=Object(r.action)("onStartGetWacInfoOperation",(function(n){return{url:n}})),s=Object(r.action)("onFinishGetWacInfoOperation",(function(n){return{url:n}})),f=Object(r.action)("pushSupressedUrl",(function(n){return{url:n}})),d=Object(r.action)("onGetWacInfoSuccess",(function(n,e,t){return{url:n,wacUrlInfo:e,needRedeem:t}})),l=Object(r.action)("addGenericLinkClickListener",(function(n,e,t){return{element:n,isSafeLinkWrapped:e,isSafeLinkVerified:t}})),h=Object(r.action)("addOpenDocumentPreviewEventListener",(function(n,e,t,r,i,u){return{element:n,href:e,itemId:t,isSafeLinkWrapped:r,isSafeLinkVerified:i,isOfficeSPLink:u}}))},4146:function(n,e,t){"use strict";var r=t(12),i=t(2),u={activeGetWacInfoOperations:[],getWacInfoQueue:[],suppressedUrls:[],docLinkPreviewInfoMap:new r.ObservableMap},o=Object(i.createStore)("sharePointDocLinkPreview",u);e.a=o()},417:function(n,e,t){"use strict";var r=function(){function n(n,e,t){this.maxParallelTasks=n,this.taskCallback=e,this.taskDelay=t,this.taskList=[],this.numberOfTasksRunning=0}return n.prototype.add=function(n){this.taskList.unshift(n),this.scheduleTask()},n.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},n.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},n.prototype.scheduleTask=function(){var n=this;this.canRunMoreTasks()&&setTimeout((function(){n.tryRunTask()}),this.taskDelay)},n.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},n.prototype.tryRunTask=function(){var n=this;if(this.canRunMoreTasks()){var e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then((function(){n.onTaskComplete()})).catch((function(){n.onTaskComplete()})),this.scheduleTask()}},n}();t.d(e,"a",(function(){return r}))},4272:function(n,e,t){"use strict";t.d(e,"a",(function(){return i}));var r=t(2),i=Object(r.action)("previewAttachment",(function(n){return{context:n}}))},4550:function(n,e,t){"use strict";var r=t(30),i=t(0);function u(n,e){var t;return void 0===n.request||n.request.__type||(n.request=(t=n.request,Object(i.__assign)({__type:"GetWacInfoRequest:#Exchange"},t))),Object(r.a)("GetWacInfo",n,e)}function o(n,e,t,r,i){return void 0===t&&(t=!1),void 0===r&&(r=!1),u({request:{Url:n,IsEdit:r,ProviderType:e,ShouldGrantAccess:t}},i)}t.d(e,"a",(function(){return o}))},4782:function(n,e,t){"use strict";t.d(e,"c",(function(){return r})),t.d(e,"d",(function(){return i})),t.d(e,"a",(function(){return u})),t.d(e,"b",(function(){return o}));var r=18e5,i=2,u="SP_LINK_CLICK_EVENT_LISTENER",o="SP_LINK_MOUSEUP_EVENT_LISTENER"},5218:function(n,e,t){"use strict";t.d(e,"a",(function(){return f}));var r=t(0),i=t(4550),u=t(3420),o=t(33),c=t(1654),a=t(3601),s=t(5219);function f(n,e,t,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var f,l,h,b;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,,9,10]),Object(a.f)(n),f=null,Object(o.i)("doc-SxS-jsApi-ODB-Links")?[4,Object(u.a)(0,n,!0,t,!0)]:[3,6];case 1:return(l=r.sent())?[3,2]:(Object(a.h)(n),[2,null]);case 2:return h=Object(c.b)(l.name),b=Object(c.f)(h),i&&(i.fileExt=h),b!==c.a.Word&&b!==c.a.Excel&&b!==c.a.PowerPoint?[3,3]:(l.openWith.wac?f={wacUrl:l.openWith.wac.applicationUrl,jsApiInfo:{bootScriptUrl:l.openWith.wac.bootstrapperUrl,wopiSrcUrl:l.openWith.wac.wopiSrc,accessToken:l.openWith.wac.accessToken,accessTokenExpiry:l.openWith.wac.accessTokenExpiry,fileSize:l.size,fileGetUrl:l.openWith.wac.fileGetUrl,bundleInfo:l.officeBundle,fetchStartTime:l.fetchStartTime,responseStartTime:l.responseStartTime,openUrl:n,fileName:l.name,userId:l.openWith.wac.userId,clientThrottlingProtection:l.openWith.wac.clientThrottlingProtection,requestedCallThrottling:l.openWith.wac.requestedCallThrottling},readOnly:l.currentUserRole.readOnly}:Object(a.e)(n,null,!0),[3,5]);case 3:return[4,d(n)];case 4:f=r.sent(),r.label=5;case 5:return[3,8];case 6:return[4,d(n)];case 7:f=r.sent(),r.label=8;case 8:return f&&Object(a.e)(n,f),e?[2,Object(s.a)(n)]:[2,null];case 9:return Object(a.d)(n),[7];case 10:return[2]}}))}))}function d(n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(i.a)(n,0)];case 1:if(9===(e=t.sent()).Status||6===e.Status||5===e.Status)Object(a.h)(n);else if(0===e.Status)return[2,{wacUrl:e.WacUrl,bootScriptUrl:e.BootScriptUrl,wopiSrcUrl:e.WopiSrcUrl,accessToken:e.AccessToken,deprecatedTokenAndParameters:e.Token}];return[2,null]}}))}))}},5219:function(n,e,t){"use strict";t.d(e,"a",(function(){return u})),t.d(e,"b",(function(){return o}));var r=t(4782),i=t(4146);function u(n){return o(n).docLinkPreviewInfo||null}function o(n){var e=i.a.docLinkPreviewInfoMap.get(n);return e?e.time+r.c>Date.now()?{docLinkPreviewInfo:e}:{reason:"Expired"}:i.a.getWacInfoQueue.some((function(e){return e===n}))||i.a.activeGetWacInfoOperations.some((function(e){return e===n}))?{reason:"InQueue"}:i.a.suppressedUrls.some((function(e){return e===n}))?{reason:"FileTypeNotSupportedOrSuppressedAfterError"}:{reason:"Unknown"}}},5599:function(n,e,t){"use strict";t.d(e,"a",(function(){return i}));var r=t(114);function i(n,e,t,i,u,o,c){Object(r.r)("SharePointLinkClick",{newTabReason:n,isSafeLinkWrapped:e,isSafeLinkVerified:t,extraInfo:i,isOfficeSPLink:u,isServiceGeneratedLink:o,fileExtension:c})}},614:function(n,e,t){"use strict";function r(n){void 0===n&&(n={}),function(n){n.timeBetweenRetryInMS=n.timeBetweenRetryInMS||function(){return 6e4}}(n);var e=n.maximumAttempts,t=n.timeBetweenRetryInMS;return function(n){var r=0,i=!1,u=function(o,c){i?c(new Error("The function retry was cancelled")):(r++,n().then((function(n){return o(n)})).catch((function(n){e&&r>=e?c(n):setTimeout((function(){return u(o,c)}),t(r))})))};return{retriableFunc:function(){return new Promise((function(n,e){return u(n,e)}))},cancel:function(){return i=!0}}}}function i(n){return function(e){return Math.pow(2,e)*n}}t.d(e,"b",(function(){return r})),t.d(e,"a",(function(){return i}))},6471:function(n,e,t){"use strict";t.d(e,"a",(function(){return u})),t.d(e,"b",(function(){return o}));var r=t(36),i=new r.c((function(){return t.e(623).then(t.bind(null,9225))})),u=new r.a(i,(function(n){return n.loadItemAttachment})),o=new r.b(i,(function(n){return n.loadItemAttachmentFromServer}))},688:function(n,e,t){"use strict";function r(n){return n>=200&&n<300}t.d(e,"a",(function(){return r}))},790:function(n,e,t){"use strict";t.d(e,"a",(function(){return i}));var r=t(0);function i(n){return Object(r.__assign)({__type:"TargetFolderId:#Exchange"},n)}},8270:function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));var r=t(5599),i=1,u=2;function o(n,e,t){n.button===i?Object(r.a)("MouseMiddleButton",e,t):n.button===u&&Object(r.a)("MouseRightButton",e,t)}},8271:function(n,e,t){"use strict";t.d(e,"a",(function(){return s}));var r=t(114),i=t(203),u=t(3602),o=t(5599),c=t(2062),a=t(5218);function s(n,e,t,s){var f,d,l=Date.now(),h=new r.b("ServiceGeneratedLinkClickHandler"),b="CT="+l+"&OR=OWA-"+(n?n.ctrlKey||1===n.button?"NTB":n.shiftKey?"NW":"NT":"NT")+"&CID="+Object(i.a)(),p=n.currentTarget,v=(d=new URL(p.href),["CID","OR","CT"].forEach((function(n){var e;(null===(e=d.searchParams)||void 0===e?void 0:e.get(n))&&d.searchParams.delete(n)})),d);if(e){var O=v.href,m=O.indexOf(u.c);if(-1===m)return;var I=encodeURIComponent(btoa(b));f=O.substr(0,m)+"&xdata="+I+u.c}else{var w=v.href.indexOf("?")>=0?"&":"?";f=v.href+w+b}h.end(),window.open(f),n.preventDefault();var g={fileExt:""};Object(a.a)(e?p.getAttribute(u.b):v.toString(),!0,!0,g).then((function(r){c.f.import().then((function(r){Object(o.a)(s||(n.altKey?"AltKey":n.ctrlKey?"CtrlKey":n.metaKey?"MetaKey":n.shiftKey?"ShiftKey":"Default"),e,t,void 0,void 0,r(e?p.getAttribute(u.b):v.toString()),g.fileExt)}))}))}},8432:function(n,e,t){"use strict";t.d(e,"a",(function(){return c}));var r=t(2523),i=t(36),u=new i.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(4),t.e(21),t.e(22),t.e(28),t.e(31),t.e(43),t.e(47),t.e(55),t.e(60),t.e(64),t.e(65),t.e(70),t.e(153),t.e(152),t.e(181),t.e(213),t.e(231),t.e(211),t.e(760)]).then(t.bind(null,11110))})),o=new i.a(u,(function(n){return n.insertSxSV2IntoDomIfNeeded}));r.c.register(o.importAndExecute);var c=Object(i.d)(u,(function(n){return n.ProjectionSxSV2}))}}]);
//# sourceMappingURL=owa.MailBoot~AttachmentPreviewSxSInitialize.js.map
self.scriptsLoaded['owa.MailBoot~AttachmentPreviewSxSInitialize.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AttachmentPreviewSxSInitialize.js'] = (new Date()).getTime();