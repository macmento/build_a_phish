self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.44.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[44],{1750:function(e,t,n){"use strict";var r=n(0),a=n(2315),i=n(5940),u=n(4313),o=n(203),s=n(146),c=n(78),l=n(65),d=n(23),f=n(490);function v(e,t,n,r,v){var h=function(e,t,n,r,a){var u=Object(c.b)().bestEffort;u["client-session-id"]=t,u["x-client-localtime"]=Object(i.a)(),u["X-Search-Griffin-Version"]="GWSv2",u["Accept-Language"]=Object(l.j)(),r&&r.length>0&&(u["x-anchormailbox"]=r[0].mailboxSmtpAddress,u.authorization=r[0].tokenString);n&&(u["X-Client-Flights"]=n);u.scenariotag=function(e){var t=e.EntityRequests.length>1,n=e.EntityRequests[0],r=[];t&&r.push("ErrMER");0==n.From&&r.push("1stPg");var a=g[n.EntityType];return r.push(a||"Unknown"),r.join("_")}(e),a&&Object.keys(a).forEach((function(e){u[e]=a[e]}));return u}(e,t,n,r,v);return Object(s.d)(Object(f.u)(Object(u.a)("query"),Object(a.a)()),e,Object(o.a)(),!0,h,void 0,void 0,!1).then((function(e){return[e,h]})).catch((function(e){return d.g.warn(e),[e]}))}var g={Event:"ev",Conversation:"cv",Email:"em",Message:"mg",MailItems:"mi",CalendarItems:"ci",MailConversations:"mc",MessageItems:"gi"};function h(e){return e?[(t={RefinerQuery:"ShallowRefiner::SearchScope:hasattachment:true"},Object(r.__assign)({__type:"DynamicRefinerQueryType:#Exchange"},t))]:null;var t}var y=n(4314),S=n(2719),p=n(2720),m=n(7635),b=n(5941),I=n(782),O=n(2721),_=n(4),T="DateTimeReceived";function j(e,t,n,r){if(e||t){var a=[];a.push(Object(b.a)({FieldURIOrConstant:Object(p.a)({Item:Object(S.a)({Value:Object(_.tb)(t||_.b)})}),Item:Object(I.a)({FieldURI:n||T})})),a.push(Object(m.a)({FieldURIOrConstant:Object(p.a)({Item:Object(S.a)({Value:Object(_.tb)(e||_.d)})}),Item:Object(I.a)({FieldURI:r||T})}));var i=Object(y.a)({Items:a});return Object(O.a)({Item:i})}return null}var C=n(1807);function R(e,t){return Object(C.a)(128)?"DateTime":e||(t>0?"Hybrid":"DateTime")}var x=n(2992);function E(e){var t,n;return(null===(n=null===(t=null==e?void 0:e.TimeZoneContext)||void 0===t?void 0:t.TimeZoneDefinition)||void 0===n?void 0:n.Id)?e.TimeZoneContext.TimeZoneDefinition.Id:"UTC"}function w(e,t,n,r){var a,i,u,o=[];if(r===n){var s={Range:(a={},a[r]={gte:t,lte:e},a)};o.push(s)}else{var c={Range:(i={},i[r]={gte:t},i)};o.push(c);var l={Range:(u={},u[n]={lte:e},u)};o.push(l)}return o}function D(e){switch(e){case"StartTime":return"StartTime";case"EndTime":return"EndTime";case"DateTimeReceived":default:return"received"}}var F=n(954),M=n(1664),A=n(1637),P="MsgFolderRoot";function q(e){var t=function(e){var t,n,a=[],i=[];if(e&&e.length>0)try{for(var u=Object(r.__values)(e),o=u.next();!o.done;o=u.next()){var s=o.value,c=s.__type;if("PrimaryMailboxSearchScopeType:#Exchange"===c)N(s.FolderScope,a,i);else if("SingleLargeArchiveSearchScopeType:#Exchange"===c)N(s.FolderScope,a,i);else if("LargeArchiveSearchScopeType:#Exchange"===c){1==(1&s.ArchiveTypes)&&i.push("archivemsgfolderroot")}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return{folderIds:a,folderNames:i}}(e.Body.SearchScope);return B(t.folderIds,t.folderNames,e.Body.IncludeDeleted,"CalendarItems"!==e.Body.ItemTypes?P:null)}function B(e,t,n,a){var i,u,o,s;void 0===a&&(a=null);var c=[];0===e.length&&0===t.length&&null!=a&&e.push(Object(F.a)(a));try{for(var l=Object(r.__values)(t),d=l.next();!d.done;d=l.next()){var f=d.value;c.push({Term:{DistinguishedFolderName:f}})}}catch(e){i={error:e}}finally{try{d&&!d.done&&(u=l.return)&&u.call(l)}finally{if(i)throw i.error}}try{for(var v=Object(r.__values)(e),g=v.next();!g.done;g=v.next()){var h=g.value;if(h&&Object(M.a)(h)==A.d)return[];c.push({Term:{FolderId:h}})}}catch(e){o={error:e}}finally{try{g&&!g.done&&(s=v.return)&&s.call(v)}finally{if(o)throw o.error}}n&&c.push({Term:{DistinguishedFolderName:"DeletedItems"}});var y=[],S={Or:c};return y.push(S),c.length>0?y:null}function N(e,t,n){var r=e.BaseFolderId,a=e.BaseFolderId.__type;if("FolderId:#Exchange"===a)t.push(r.Id);else if("DistinguishedFolderId:#Exchange"===a){var i=r.Id;if("msgfolderroot"===i.toLowerCase())n.push(i);else{var u=Object(F.a)(i);t.push(u)}}}function U(e){var t=function(e){var t=function(e){var t=null,n=null,r=null,a=null;if(null==e?void 0:e.Item){var i=e.Item;if("And:#Exchange"===i.__type){var u=i;if(u.Items&&2===u.Items.length){if("IsLessThanOrEqualTo:#Exchange"===u.Items[0].__type){var o=u.Items[0];if("Constant:#Exchange"===o.FieldURIOrConstant.Item.__type&&"PropertyUri:#Exchange"===o.Item.__type){var s=o.FieldURIOrConstant.Item,c=o.Item;t=s.Value,n=c.FieldURI}}if("IsGreaterThanOrEqualTo:#Exchange"===u.Items[1].__type){var l=u.Items[1];if("Constant:#Exchange"===l.FieldURIOrConstant.Item.__type&&"PropertyUri:#Exchange"===l.Item.__type){s=l.FieldURIOrConstant.Item,c=l.Item;r=s.Value,a=c.FieldURI}}}}}return{lteFieldValue:t,lteFieldUri:n,gteFieldValue:r,gteFieldUri:a}}(e.Body.SearchRestrictions),n=t.lteFieldValue,r=t.gteFieldValue,a=t.lteFieldUri,i=t.gteFieldUri;return n&&a&&r&&i?w(n,r,a=D(a),i=D(i)):[]}(e),n=q(e),r=t.concat(n).filter((function(e){return!!e})),a={And:r};return 0===r.length?null:1===r.length?r[0]:a}function k(e){var t=[];return e.Body.SearchScope.forEach((function(n){"PrimaryMailboxSearchScopeType:#Exchange"===n.__type||"CalendarItems"===e.Body.ItemTypes?t.push("Exchange"):"LargeArchiveSearchScopeType:#Exchange"!==n.__type&&"SingleLargeArchiveSearchScopeType:#Exchange"!==n.__type||t.push("ExchangeArchive")})),t}function Q(e){if(!e)return"MailItems";switch(e){case"CalendarItems":return"Event";case"MailConversations":return"Conversation";case"MessageItems":return"Email";case"MailItems":default:return"Message"}}var L=n(33);function H(){var e=["Suggestion","NoResultModification","NoResultFolderRefinerModification"];return Object(L.i)("sea-noRequeryModification")&&e.push("NoRequeryModification"),Object(L.i)("sea-modificationQueryAlteration")&&e.push("Modification"),Object(L.i)("sea-extensionQueryAlteration")&&e.push("Extension"),e}function J(e,t,n,r){var a,i,u,o,s,c=0===n&&"QueryAlterationRecourseLink"!==r;return[{EntityType:Q(e.Body.ItemTypes),Filter:U(e),From:e.Body.ResultRowOffset,PropertySet:"ProvenanceOptimized",Provenances:k(e),Query:G(e,t),QueryAlterationOptions:{EnableSuggestion:c,EnableAlteration:c,SupportedRecourseDisplayTypes:H()},RefiningQueries:(s=e.Body.SearchRefiners,0===(s?s.length:0)?null:s.map((function(e){return{RefinerString:e.RefinerQuery}}))),Size:e.Body.ResultRowCount,Sort:(a=e.Body.SortOrder,i={Field:"Score",SortDirection:"Desc",Count:3},u={Field:"Time",SortDirection:"Desc"},o={Relevance:[i],Hybrid:[i,u],DateTime:[u]},a&&o[a]?o[a]:[u])}]}function G(e,t){return t?{QueryString:e.Body.Query,DisplayQueryString:"",ClientQueryAlterationReasons:"PeopleSearch Scenario"}:{QueryString:e.Body.Query}}var K=n(2490);function V(e,t,n){var a,i,u,o,s,c,l,d,f,v,g;return Object(r.__awaiter)(this,void 0,void 0,(function(){var h;return Object(r.__generator)(this,(function(y){return e&&200===e.status&&(h=null===(i=null===(a=t.EntitySets)||void 0===a?void 0:a[0])||void 0===i?void 0:i.QueryAlterationResponse)?z(h.QueryAlterationType)?[2,Object(r.__assign)(Object(r.__assign)({},n),{querySuggestionData:{alteredQuery:null===(o=null===(u=h.AlteredQuery)||void 0===u?void 0:u.AlteredQuery)||void 0===o?void 0:o.RawString,flaggedTokens:null===(s=h.AlteredQuery)||void 0===s?void 0:s.FlaggedTokens,recourseQuery:null===(c=h.RecourseQuery)||void 0===c?void 0:c.RawString,suggestedSearchTerm:null===(f=null===(d=null===(l=h.AlteredQuery)||void 0===l?void 0:l.FlaggedTokens)||void 0===d?void 0:d[0])||void 0===f?void 0:f.Suggestion,suggestedSearchTermReferenceId:null===(g=null===(v=h.AlteredQuery)||void 0===v?void 0:v.AlteredQuery)||void 0===g?void 0:g.ReferenceId,queryAlterationType:h.QueryAlterationType}})]:[2,Object(r.__assign)(Object(r.__assign)({},n),{querySuggestionData:{alteredQuery:"",flaggedTokens:null,recourseQuery:"",suggestedSearchTerm:null,suggestedSearchTermReferenceId:null,queryAlterationType:null}})]:[2,Object(r.__assign)({},n)]}))}))}var z=function(e){return H().includes(e)};function W(e){return e?{Id:e.Id,ChangeKey:null}:null}function Z(e,t){var n=null;(null==t?void 0:t.TimeZone)&&(n=new Date(e).toISOString());return n}function X(e){return(null==e?void 0:e.EmailAddress)?{Mailbox:{EmailAddress:e.EmailAddress.Address,Name:e.EmailAddress.Name,RoutingType:"SMTP"}}:null}function $(e){return e?{__typename:"FolderId",Id:e.Id}:null}function Y(e){switch(e){case"DateTime":return"DateTime";case"Hybrid":return"Hybrid";case"Relevance":return"Relevance";default:return null}}function ee(e){if(null===e||0===e.length)return null;for(var t=[],n=0;n<e.length;n++)t[n]=W(e[n]);return t}function te(e){var t;return(null===(t=null==e?void 0:e.QueryId)||void 0===t?void 0:t.Id)?{Id:e.QueryId.Id}:null}function ne(e,t){return{__typename:"ConversationType",Categories:e.Categories,ConversationId:W(e.ConversationId),ConversationTopic:e.ConversationTopic,FlagStatus:e.FlagStatus,From:X(e.From),GlobalItemIds:ee(e.GlobalItemIds),GlobalMessageCount:e.GlobalMessageCount,GlobalUnreadCount:e.GlobalUnreadCount,HasAttachments:e.HasAttachments,HasIrm:e.HasIrm,Importance:e.Importance,ItemClasses:e.ItemClasses,ItemIds:ee(e.ItemIds),LastDeliveryOrRenewTime:Z(e.LastDeliveryOrRenewTime,t),LastDeliveryTime:Z(e.LastDeliveryTime,t),LastModifiedTime:Z(e.LastModifiedTime,t),MessageCount:e.MessageCount,ParentFolderId:$(e.ParentFolderId),Preview:e.Preview,SortOrderSource:Y(e.SortOrderSource),UniqueRecipients:e.UniqueRecipients,UniqueSenders:e.UniqueSenders,UnreadCount:e.UnreadCount}}var re=n(17),ae="IPM.Appointment";function ie(e){var t,n=X(e.Organizer);return{CalendarItemType:e.CalendarItemType.toString(),Categories:e.Categories,CharmId:e.Charm,DisplayTo:e.DisplayTo,End:e.End,Start:e.Start,HasAttachments:e.HasAttachments,IsAllDayEvent:e.IsAllDayEvent,IsMeeting:e.IsMeeting,IsMeetingPollEvent:e.IsMeetingPollEvent,ItemClass:e.ItemClass?e.ItemClass:ae,FreeBusyType:e.LegacyFreeBusyStatus?e.LegacyFreeBusyStatus.toString():null,Location:{DisplayName:e.Location},Sensitivity:e.Sensitivity,SeriesId:e.SeriesMasterItemId?e.SeriesMasterItemId.Id:null,Subject:e.Subject,Organizer:n,UID:e.UID,ItemId:W(e.ItemId),ParentFolderId:$(e.ParentFolderId),SerializedImmutableId:e.ImmutableId,SortOrderSource:Y(e.SortOrderSource),Preview:e.Preview,IsOrganizer:e.IsOrganizer&&Object(re.a)().SessionSettings.UserEmailAddress===(null===(t=null==n?void 0:n.Mailbox)||void 0===t?void 0:t.EmailAddress),IsCancelled:e.IsCancelled,ResponseType:e.MyResponseType}}function ue(e,t){var n,r,a=function(e){if(!e)return e;var t=e.indexOf(":");return t>0&&t<6&&t+1<e.length?e.substring(t+1).trim():e}(e.Subject);return{Categories:e.Categories,ConversationId:W(e.ConversationId),ConversationIndex:e.ConversationIndex,ConversationThreadId:{Id:e.ConversationThreadId,ChangeKey:null},ConversationTopic:a,DateTimeReceived:Z(e.DateTimeReceived,t),DateTimeSent:e.DateTimeSent&&Z(e.DateTimeSent,t),LastModifiedTime:Z(e.DateTimeLastModified,t),DisplayBcc:e.DisplayBcc,DisplayCc:e.DisplayCc,DisplayTo:e.DisplayTo,Flag:(r=e.Flag,r?{FlagStatus:r.FlagStatus,CompleteDate:r.CompleteDate,DueDate:r.DueDate,StartDate:r.StartDate}:null),From:X(e.From),HasAttachments:e.HasAttachments,Hashtags:e.Hashtags,IconIndex:e.IconIndex,Importance:e.Importance,IsDraft:e.IsDraft,IsRead:e.IsRead,ItemClass:e.ItemClass||"IPM.Note",ItemId:{Id:e.ItemId.Id,ChangeKey:e.ItemId.ChangeKey},MailboxGuids:e.MailboxGuids,ParentFolderId:$(e.ParentFolderId),Preview:e.Preview,Sender:X(e.Sender),SenderSMTPAddress:e.SenderSMTPAddress,Sensitivity:e.Sensitivity,SerializedImmutableId:e.ImmutableId,SortOrderSource:Y(e.SortOrderSource),Subject:e.Subject,MentionedMe:null===(n=e.MentionsPreview)||void 0===n?void 0:n.IsMentioned,ExtendedProperty:[{ExtendedFieldURI:{DistinguishedPropertySetId:"Common",PropertyId:3613,PropertyType:"String"},Value:a}]}}function oe(e){var t,n,r;return(null===(r=null===(n=null===(t=null==e?void 0:e.EntitySets)||void 0===t?void 0:t[0])||void 0===n?void 0:n.ResultSets)||void 0===r?void 0:r[0])?e.EntitySets[0].ResultSets[0]:null}function se(e,t){var n,a,i,u,o,s,c=oe(e);if(!c||!c.Results||0===c.Results.length)return{SearchResults:{MoreResultsAvailable:!1,TotalResultsCount:0,SearchResultsCount:0,TDQueryId:te(null)}};var l=c.Results,d=l.length,f=[],v=[],g=[];switch(e.EntitySets[0].Type){case"Message":case"Messages":try{for(var h=Object(r.__values)(l),y=h.next();!y.done;y=h.next()){var S=ue((_=y.value).Source,t);S.InstanceKey=_.ReferenceId,f.push(S)}}catch(e){n={error:e}}finally{try{y&&!y.done&&(a=h.return)&&a.call(h)}finally{if(n)throw n.error}}break;case"Conversation":case"Conversations":try{for(var p=Object(r.__values)(l),m=p.next();!m.done;m=p.next()){var b=ne((_=m.value).Source,t);b.InstanceKey=_.ReferenceId,v.push(b)}}catch(e){i={error:e}}finally{try{m&&!m.done&&(u=p.return)&&u.call(p)}finally{if(i)throw i.error}}break;case"Event":case"Events":try{for(var I=Object(r.__values)(l),O=I.next();!O.done;O=I.next()){var _,T=ie((_=O.value).Source);T.InstanceKey=_.ReferenceId,g.push(T)}}catch(e){o={error:e}}finally{try{O&&!O.done&&(s=I.return)&&s.call(I)}finally{if(o)throw o.error}}}return{SearchResults:{Items:f.length>0?f:null,Conversations:v.length>0?v:null,CalendarItems:g.length>0?g:null,MoreResultsAvailable:c.MoreResultsAvailable,SearchRefiners:null,TotalResultsCount:c.Total,SearchTerms:e.SearchTerms,SearchResultsCount:d,TDQueryId:te(c)}}}function ce(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a;return Object(r.__generator)(this,(function(i){return e?200!==e.status?[2,{Body:{MessageText:le(e,t)}}]:(a=se(t,n),[2,{Body:Object(r.__assign)({},a)}]):[2,{Body:{MessageText:"No response received"}}]}))}))}var le=function(e,t){return(null==t?void 0:t.error)?JSON.stringify(t.error):e.statusText};var de=n(161),fe=n(8),ve=n(142),ge=n(107),he=n(3),ye="ows/beta/substratesearch/query",Se=2048;function pe(e,t,n,r,a,i){return be(e,t,n,r,Oe,a,i)}function me(e,t,n,r,a,i){return be(e,t,n,r,Ie,a,i)}function be(e,t,n,r,a,i,u){return Object(ve.a)().then((function(o){var s=o.headers;i&&s.append("X-OWA-ActionSource",i);var c=a("ExecuteSearch",t,e,n,o,u),l=0,d=0;return r&&(l=r.addCheckmark("ClientJSPreRequestTime"),Promise.resolve().then((function(){d=r.addCheckmark("ClientJSRequestThread")}))),c?c.then((function(e){var t=e[0],n=e[1],r=[t,n,e[2]];return n.ClientJSPreRequestTime=l,n.ClientJSRequestThreadTime=d,r})):Promise.reject("Client-side issue prevented request from being sent")}))}function Ie(e,t,n,a,i,u){var s=this,c=JSON.stringify(n),l=encodeURIComponent(c),d=!1,f=i.headers;f.append("Content-Type","application/json; charset=utf-8"),i.returnFullResponseOnSuccess=!0,l.length>Se?i.body=c:(d=!0,f.append("X-OWA-UrlPostData",l),i.body=null);var v=function(e,t){var n=Object(fe.a)(),r=(n.baseUrl?n.baseUrl+"/service.svc?action=":"/owa/service.svc?action=")+e;n.appName&&(r+="&app="+n.appName);t&&(r+="&EP=1");return r+="&id="+Object(o.a)()}(e,d),g=new Date;return Object(ge.a)("ExecuteSearch",v,1,i).then((function(e){return Object(r.__awaiter)(s,void 0,void 0,(function(){var o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,e.json()];case 1:return o=r.sent(),[2,[o,_e(e,n.Body.Query,200==e.status?null:o?JSON.stringify(o.Body):null,"ExecuteSearch",g,new Date,a,i.headers,t,u),e.url]]}}))}))}))}function Oe(e,t,n,a,i,u){var c=this;if(!a)return d.d("SearchQueryId must be specified when calling makeExecuteSearchRequest!"),null;var l={};i.headers.forEach((function(e,t){l[t]=e})),l["X-Search-Griffin-Version"]="GWSv2";var f=new Date;return n.Body.SearchSessionId=a,n.Body.Scenario=u,Object(s.d)(ye,n,Object(o.a)(),!0,l).then((function(e){return Object(r.__awaiter)(c,void 0,void 0,(function(){var o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,e.json()];case 1:return[2,[o=r.sent(),_e(e,n.Body.Query,200==e.status?null:o?JSON.stringify(o.Body):null,"SubstrateSearch",f,new Date,a,i.headers,t,u),e.url]]}}))}))})).catch((function(e){return d.g.warn(e),null}))}var _e=function(e,t,n,r,a,i,u,o,s,c){var l=e.headers||new Headers;return{ClientSearchProvider:r,PageNumber:s,ClientNetworkTime:i.getTime()-a.getTime(),ClientJSEndToEndTime:0,ClientJSPreRequestTime:0,ClientJSRequestThreadTime:0,ClientResponseProcessTime:0,ClientJSRenderingTime:0,SearchDateTime:l.get("date"),SearchBETarget:l.get("x-calculatedbetarget"),SearchFETarget:l.get("x-calculatedfetarget"),SearchBEHttpStatus:l.get("x-backendhttpstatus"),SearchMsEdgeRef:l.get("x-msedge-ref"),SearchErrorContent:n,SearchTraceID:l.get("request-id"),SearchQueryId:u,ClientBuildNumber:Object(he.p)(),ClientTimeSentUTC:a,ClientTimeFinishedUTC:i,ClientHttpStatus:e.status||-1,SearchClientRequestID:o.get("client-request-id"),SearchClientSessionID:Object(he.o)(),ClientName:c,DiagnosticsCheckpoints:l.get("x-ms-diagnostics-checkpoints"),ResourceTimingEntry:null,PIIData:{queryText:t}}};var Te=250;function je(e,t,n,a,i,u,o,s,c,l,f,g,y,S,p,m,b,I,O,_,T){return void 0===g&&(g=0),void 0===y&&(y=!1),void 0===S&&(S=null),void 0===p&&(p=null),void 0===m&&(m=null),void 0===b&&(b=null),void 0===I&&(I=null),void 0===O&&(O=!1),void 0===_&&(_=null),void 0===T&&(T=null),Object(r.__awaiter)(this,void 0,void 0,(function(){var w,D,F,M,A,P,q,B,N,U,k,Q,L,H,G,z,W,Z;return Object(r.__generator)(this,(function(X){switch(X.label){case 0:if((w=Object(de.b)()).RequestServerVersion="V2016_06_15",D={Header:w,Body:($={ApplicationId:"Owa",IdFormat:"EwsId",IncludeDeleted:!Object(C.a)(256),ItemTypes:o,MaxPreviewLength:60,MaxRefinersCountPerRefinerType:5,MaxResultsCountHint:Te,PropertySetName:"Owa16",Query:t,ResultRowCount:e.resultRowCount,ResultRowOffset:e.resultRowOffset,RetrieveRefiners:!1,Scenario:"Calendar"==c?"CalendarSearch":"MailSearch",SearchRefiners:h(y),SearchScope:Object(x.c)(i),SearchRestrictions:j(S,p,m,b),SearchSessionId:n,SortOrder:R(I,g),MaxHybridCountHint:g},Object(r.__assign)({__type:"ExecuteSearchRequest:#Exchange"},$))},F=function(e){return Object(r.__assign)({__type:"ExecuteSearchJsonRequest:#Exchange"},e)}(D),M=-1===u?-1:e.pageNumber,"SubstrateSearch"!==l)return[3,9];X.label=1;case 1:return X.trys.push([1,7,,8]),A=function(e){var t=e.request,n=e.cvid,r=e.queryIncludesPeopleSuggestion,a=e.pageNumber,i=e.substrateSearchScenario,u=e.actionSource,o={Cvid:n,Scenario:{Name:i},TimeZone:E(t.Header),TextDecorations:"Off",EntityRequests:J(t,r,a,u)};return i==K.b.Mail&&(o.LogicalId=n),o}({request:F,cvid:a,queryIncludesPeopleSuggestion:O,pageNumber:M,substrateSearchScenario:f,actionSource:c}),P=0,q=0,s&&(P=s.addCheckmark("ClientJSPreRequestTime"),Promise.resolve().then((function(){q=s.addCheckmark("ClientJSRequestThread")}))),B=new Date,[4,v(A,n,_,[],T)];case 2:return N=X.sent(),U=new Date,N&&2==N.length?(k=Object(r.__read)(N,2),Q=k[0],L=k[1],H=null,(null==Q?void 0:Q.json)?[4,Q.json().catch((function(e){return[e]}))]:[3,4]):[2,null];case 3:H=X.sent(),X.label=4;case 4:return[4,ce(Q,H,A)];case 5:return G=X.sent(),[4,V(Q,H,G.Body)];case 6:return z=X.sent(),(W=_e(Q,F.Body.Query,200==Q.status?null:G?JSON.stringify(G.Body):null,"SubstrateSearch",B,U,a,new Headers(L),e.pageNumber,f)).ClientJSPreRequestTime=P,W.ClientJSRequestThreadTime=q,[2,[z,W,Q.url]];case 7:return Z=X.sent(),d.d("An unexpected error occurred while processing a Substrate Search request: "+Z),[2,null];case 8:return[3,10];case 9:return[2,("ExecuteSearch"===l?me:pe)(F,e.pageNumber,a,s,c,f).then((function(e){return[e[0].Body,e[1],e[2]]})).catch((function(e){return null}))];case 10:return[2]}var $}))}))}function Ce(e,t,n,r,i,o,c){var l={cvid:n,query:e,textdecorations:"1",scenario:i,entityTypes:r};return c&&(l.logicalId=c),Object(L.i)("sea-modernFileSuggestions")&&(null==e?void 0:e.length)>0&&(l.setFlight="odspFilesForOwa"),t?Object(s.b)(Object(f.u)(Object(u.a)("suggestions"),Object(a.a)(l)),void 0,!0,o,void 0,!1).then((function(e){return e})).catch((function(e){return d.g.warn(e),null})):Promise.resolve(null)}var Re=n(30);function xe(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"StartSearchSessionJsonRequest:#Exchange"},n)),Object(Re.a)("StartSearchSession",e,t)}function Ee(e,t){return xe({Header:Object(de.b)(),Body:(n={SearchSessionId:e,WarmupOptions:16777215,SuggestionTypes:1,SearchScope:Object(x.c)(t),IdFormat:"EwsId",ApplicationId:"Owa"},Object(r.__assign)({__type:"StartSearchSessionRequest:#Exchange"},n))}).then((function(e){return e.Body}));var n}function we(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"EndSearchSessionJsonRequest:#Exchange"},n)),Object(Re.a)("EndSearchSession",e,t)}function De(e){return we({Header:Object(de.b)(),Body:(t={SearchSessionId:e},Object(r.__assign)({__type:"EndSearchSessionRequest:#Exchange"},t))}).then((function(e){return e.Body}));var t}var Fe,Me,Ae=n(3110),Pe=n(2932),qe=n(2362),Be=n(5942);function Ne(e,t){return{content:e.Preview,id:e.InternetMessageId,composeTime:Z(e.DateTimeSent,t),originalArrivalTime:Z(e.DateTimeReceived,t),containerId:e.ClientConversationId,imDisplayName:e.Sender.EmailAddress.Name,senderProfile:{displayName:e.Sender.EmailAddress.Name,email:e.Sender.EmailAddress.Address},displayTo:e.DisplayTo}}!function(e){e[e.Single=0]="Single",e[e.Occurrence=1]="Occurrence",e[e.Exception=2]="Exception",e[e.RecurringMaster=3]="RecurringMaster"}(Fe||(Fe={})),function(e){e[e.Free=0]="Free",e[e.Tentative=1]="Tentative",e[e.Busy=2]="Busy",e[e.Oof=3]="Oof",e[e.WorkingElsewhere=4]="WorkingElsewhere",e[e.NoData=5]="NoData"}(Me||(Me={}));var Ue=n(2033);n.d(t,"m",(function(){return je})),n.d(t,"G",(function(){return v})),n.d(t,"H",(function(){return Ce})),n.d(t,"n",(function(){return Ee})),n.d(t,"l",(function(){return De})),n.d(t,"e",(function(){return Ae.a})),n.d(t,"o",(function(){return x.a})),n.d(t,"v",(function(){return x.b})),n.d(t,"A",(function(){return Pe.e})),n.d(t,"B",(function(){return Pe.g})),n.d(t,"y",(function(){return Pe.b})),n.d(t,"z",(function(){return Pe.c})),n.d(t,"w",(function(){return u.a})),n.d(t,"t",(function(){return j})),n.d(t,"C",(function(){return qe.b})),n.d(t,"c",(function(){return qe.a})),n.d(t,"E",(function(){return qe.d})),n.d(t,"F",(function(){return qe.e})),n.d(t,"D",(function(){return qe.c})),n.d(t,"p",(function(){return i.a})),n.d(t,"r",(function(){return Be.b})),n.d(t,"q",(function(){return Be.a})),n.d(t,"s",(function(){return Be.c})),n.d(t,"g",(function(){return ie})),n.d(t,"f",(function(){return ne})),n.d(t,"h",(function(){return ue})),n.d(t,"i",(function(){return Ne})),n.d(t,"j",(function(){return w})),n.d(t,"k",(function(){return B})),n.d(t,"u",(function(){return oe})),n.d(t,"x",(function(){return E})),n.d(t,"d",(function(){return _e})),n.d(t,"a",(function(){return K.b})),n.d(t,"b",(function(){return Ue.b}))},2268:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"UnifiedGroupIdentity:#Exchange"},e)}},2315:function(e,t,n){"use strict";var r=n(0),a=n(376);var i=n(33),u=n(5);n.d(t,"a",(function(){return c}));var o=null,s="searchtesthook";function c(e){void 0===e&&(e={});var t,n=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e),function(){if(!o){o={};var e=Object(u.a)(s),t=decodeURIComponent(e||"").trim();if(Object(i.i)("sea-debugHook")&&t.length>0){var n=t.split("&");o=n.reduce((function(e,t){var n=Object(r.__read)(t.split("="),2),a=n[0],i=n[1];return e[a]=i,e}),{})}}return o}()),Object(a.a)("includePartnerIn3SRequest")?((t={}).partner="exchangeshared",t):null);return Object.keys(n).filter((function(e){return null!==n[e]})).reduce((function(e,t){var a;return Object(r.__assign)(Object(r.__assign)({},e),((a={})[t]=n[t],a))}),{})}},2362:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return s}));var r=n(0);function a(e){return Object(r.__assign)({},e)}function i(e){return Object(r.__assign)({},e)}function u(e){return Object(r.__assign)({},e)}function o(e){return Object(r.__assign)({},e)}function s(e){return Object(r.__assign)({},e)}},2719:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"Constant:#Exchange"},e)}},2720:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"FieldURIOrConstantType:#Exchange"},e)}},2721:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"RestrictionType:#Exchange"},e)}},2992:function(e,t,n){"use strict";var r=n(706),a=n(554),i=n(0);function u(e){return Object(i.__assign)({__type:"SingleLargeArchiveSearchScopeType:#Exchange"},e)}function o(e){return Object(i.__assign)({__type:"SearchFolderScopeType:#Exchange"},e)}var s=n(2268),c=n(1664);var l=n(17),d=n(954),f=n(2362),v=n(1637),g=n(2614);n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return _})),n.d(t,"c",(function(){return T}));var h={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){var e,t,n=[];n.push(Object(f.b)({folderId:Object(d.a)(v.j),kind:"PrimaryMailbox"}));var r=Object(g.b)("UserMailbox");try{for(var a=Object(i.__values)(r),u=a.next();!u.done;u=a.next()){var o=u.value;n.push(Object(f.b)({folderId:o,kind:"PrimaryMailbox"}))}}catch(t){e={error:t}}finally{try{u&&!u.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return n},getSearchScopeType:function(e){var t,n,u=Object(c.a)(e.folderId);return t="none"!=u?Object(r.a)({Id:u}):Object(a.a)({Id:e.folderId}),[(n={FolderScope:o({BaseFolderId:t}),IsDeepTraversal:!0},Object(i.__assign)({__type:"PrimaryMailboxSearchScopeType:#Exchange"},n))]}},y={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){var e,t=[],n=Object(l.a)();return(null===(e=null==n?void 0:n.SessionSettings)||void 0===e?void 0:e.IsExplicitLogon)||t.push(Object(f.a)({folderId:Object(d.a)(v.d),kind:"ArchiveMailbox"})),t.push(Object(f.a)({folderId:Object(d.a)(v.a),kind:"ArchiveMailbox"})),t},getSearchScopeType:function(e){var t,n,s=Object(c.a)(e.folderId);return t="none"!=s?Object(r.a)({Id:s}):Object(a.a)({Id:e.folderId}),"archivemsgfolderroot"==s?[(n={ArchiveTypes:16777215},Object(i.__assign)({__type:"LargeArchiveSearchScopeType:#Exchange"},n))]:[u({FolderScope:o({BaseFolderId:t})})]}},S={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},p={getKey:function(e){return e.kind+"-"+e.groupId.toLowerCase()},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return[(t={GroupIdentity:Object(s.a)({Type:0,Value:e.groupId})},Object(i.__assign)({__type:"SingleGroupSearchScopeType:#Exchange"},t))];var t}},m={getKey:function(e){return e.kind+"-"+e.calendarFolderId?e.calendarFolderId.toLowerCase():""},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},b={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},I=function(e){switch(e.kind){case"PrimaryMailbox":return h;case"ArchiveMailbox":return y;case"SharedFolders":return S;case"Group":return p;case"Calendar":return m;case"PublicFolder":return b;default:throw new Error("Unregistered search scope")}},O=function(e){return I(e).getKey(e)},_=function(e){return I(e).getSearchScopeList()},T=function(e){return I(e).getSearchScopeType(e)}},3110:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2992);function a(e,t){return!(!e||!t)&&Object(r.a)(e)===Object(r.a)(t)}},4313:function(e,t,n){"use strict";function r(e,t){return"search/api/"+(2===t?"v2":"v1")+"/"+e}n.d(t,"a",(function(){return r}))},4314:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"And:#Exchange"},e)}},5940:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4);function a(){return Object(r.mc)().toString()}},5941:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"IsLessThanOrEqualTo:#Exchange"},e)}},5942:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return o}));var r=n(151),a=[{resultRowOffset:0,resultRowCount:25,pageNumber:0},{resultRowOffset:25,resultRowCount:50,pageNumber:1},{resultRowOffset:75,resultRowCount:75,pageNumber:2},{resultRowOffset:150,resultRowCount:100,pageNumber:3},{resultRowOffset:250,resultRowCount:200,pageNumber:4},{resultRowOffset:450,resultRowCount:200,pageNumber:5},{resultRowOffset:650,resultRowCount:200,pageNumber:6},{resultRowOffset:850,resultRowCount:200,pageNumber:7}],i=Object(r.select)({pageContexts:function(){return a}})((function(e,t){if(e<0||e>=t.pageContexts.length)throw new Error("The pageNumber for execute search is invalid:"+e);return t.pageContexts[e]})),u=Object(r.select)({pageContexts:function(){return a}})((function(e,t,n,r){var a=e.pageNumber+1,u="PrimaryMailbox"===n?2:4;return t.MoreResultsAvailable&&a<u?i(a,r):null})),o=function(e){switch(e){case 74:return a[2];case 149:return a[3];case 249:return a[4];case 449:return a[5];case 649:return a[6];case 849:return a[7];default:return null}}},7635:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"IsGreaterThanOrEqualTo:#Exchange"},e)}}}]);
//# sourceMappingURL=owa.44.js.map
self.scriptsLoaded['owa.44.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.44.js'] = (new Date()).getTime();